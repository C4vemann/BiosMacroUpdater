<!DOCTYPE html>
<html>
	<head>
		<style>
			.warning{
				color: red;
			}
			.order{
				border: 2px solid black;
				width: fit-content;
			}
		</style>
	<body>
		<!-- onchange="func1(this.value)" -->
		<input type="text" id="input">
		<div id="temp">
			<h1>Order #: <span id="order_number"></span></h1>
			<h1>Serial #: <span id="serial_number"></span></h1>
			<h1>Asset #: <span id="asset_number"></span></h1>
			<h1>Peripheral: <span id="peripherals"></span></h1>
		</div>
		<div id="warning" class="warning"><div></div></div>
		<div id="output"></div>

		<script>
			class OrderForm{
				constructor(){
					this.orderId = null;
					this.orderName = null;
					this.orderTag = null;
					this.orderPeripherals = [];
				}
			}

			function createOrderView(x){
				let el = document.createElement("div");
				el.className = "order";
				
				let br = document.createElement("br");
				let text = document.createTextNode("Order #: " + x.orderId);
				el.appendChild(text);
				el.appendChild(br);
				
				br = document.createElement("br");
				text = document.createTextNode("Serial #: " + x.orderName);
				el.appendChild(text);
				el.appendChild(br);
				
				br = document.createElement("br");
				text = document.createTextNode("Asset #: " + x.orderTag);
				el.appendChild(text);
				el.appendChild(br);
				
				text = document.createTextNode("Peripherals: " + x.orderPeripherals);
				el.appendChild(text);
				return el;

			}

			function createWarning(x){
				return document.createTextNode(x); 
			}

			function firstMatch(str){
				if(str.length > 7 || str.length < 7){
					return false;
				} else {
					let pattern = /[0-9]{7}$/;
					return pattern.test(str);
				}
			}
			function secondMatch(str){
				return true;
			}
			function thirdMatch(str){
				if(str.length > 10 || str.length < 10){
					return false;
				} else {
					let pattern = /ITE000[0-9]{4}$/;
					return pattern.test(str);
				}
			}
			function fourthMatch(str){
				return true;
			}

			let input = document.getElementById("input");
			let output = document.getElementById("output");
			let warning = document.getElementById("warning");
			let orderList = new Array();
			let orderTemp = null;
			let orderNumber = document.getElementById("order_number");
			let serialNumber = document.getElementById("serial_number");
			let assetNumber = document.getElementById("asset_number");
			let peripherals = document.getElementById("peripherals");

			input.addEventListener("change", func1, false);

			function func1(){
				if(firstMatch(this.value)){
					if(orderTemp != null && orderTemp.orderId != null && orderTemp.orderName != null){
						orderList.push(orderTemp);
						output.appendChild(createOrderView(orderTemp));
					}
					orderTemp = new OrderForm();
					orderNumber.innerText = "";
					serialNumber.innerText = "";
					assetNumber.innerText = "";
					peripherals.innerText = "";
					orderTemp.orderId = this.value;
					orderNumber.innerText = this.value;
				} else if(secondMatch(this.value) && orderTemp.orderName == null){
					if(orderTemp != null && orderTemp.orderId != null){
						orderTemp.orderName = this.value;
						serialNumber.innerText = this.value;
					} else {
						console.error("Order Format Wrong");
					}
				} else if(thirdMatch(this.value) && orderTemp.orderTag == null){
					if(orderTemp != null && orderTemp.orderId != null && orderTemp.orderName != null){
						orderTemp.orderTag = this.value;
						assetNumber.innerText = this.value;
					} else{
						console.error("Order Format Wrong");
					}
				} else if(fourthMatch(this.value)){
					if(orderTemp != null && orderTemp.orderId != null && orderTemp.orderName != null && orderTemp.orderTag != null){
						orderTemp.orderPeripherals.push(this.value);
						if(orderTemp.orderPeripherals.length == 1){
							peripherals.innerText = this.value; 
						} else {
							peripherals.innerText = peripherals.innerText + ", " + this.value; 
						}
					} else{
						console.error("Order Format Wrong");
					}
				}

				else {
					warning.replaceChild(createWarning("Input did not match first regex matcher"),warning.firstChild);
				}

				this.value = "";
			}



		</script>
	</body>
</html>