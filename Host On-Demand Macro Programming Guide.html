<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0070)https://scc.its.state.nc.us/hod/en/doc/macro/macro.html#mt_sc_too_soon -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-us">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">

		<meta name="DC.Language" scheme="rfc1766" content="en-us">
		<meta name="IBM.Country" content="ZZ">
		<!-- Licensed Materials Property of IBM                      -->
		<!-- US Government Users Restricted Rights                   -->
		<!-- Use, duplication or disclosure restricted by            -->
		<!-- GSA ADP Schedule Contract with IBM Corp.                -->
		<meta name="DC.Date" scheme="iso8601" content="2019-01-11">
		<meta name="copyright" content="© Copyright IBM Corporation 2004, 2016">
		<meta name="security" content="public">
		<meta name="Robots" content="index,follow">
		<title>Host On-Demand Macro Programming Guide</title>
		<link rel="stylesheet" type="text/css" href="./ibmidwb.css">
		<style>
			.accordian {
			  background-color: #eee;
			  color: #444;
			  cursor: pointer;
			  padding: 18px;
			  width: 100%;
			  border: none;
			  text-align: left;
			  outline: none;
			  font-size: 15px;
			  transition: 0.4s;
			}
			
			.active, .accordian:hover {
			  background-color: #ccc; 
			}
			
			.panel {
			  padding: 0 18px;
			  background-color: white;
			  overflow: hidden;
			}
		</style>

	</head>

	<body role="main">
		<button id="Top_Of_Page"></button><h1>IBM Host On-Demand Version 14.0</h1>
		<h1>Host On-Demand Macro Programming Guide</h1>
		<br>
		<span class="ibmdocnum">SC31-6378-07</span><br>
		<div>
			<div class="pblklblbox">
				<span class="pblktitle">Note</span>
				<p>Before using this information and the product it supports, the information in <button onclick="scrollHere('hdrnotice')">Appendix B. Notices</button>.</p>
			</div>
		</div>
		<div>
			<span class="ednoticestitle">Seventh Edition (March 2019)</span>
			<p>This edition applies to Version 14.0 of IBM® Host On-Demand (IBM Access Client Package for Multiplatforms V7.0, program number <samp class="xph">5724-I20</samp>) 	and to all subsequent releases and modifications until otherwise in new editions.</p>
			<p>Copyright International Business Machines Corporation 2004, 2019.</p>
		</div>
		<div>
			<strong>Copyright International Business Machines Corporation 2004, 2016.</strong><br>US Government Users Restricted Rights -- Use, duplication or disclosure restricted by GSA ADP Schedule Contract with IBM Corp.
		</div>

		<div id="wq2">
			<h1>Contents</h1>
			<div class="head1"><button id="ToC_1" onclick="scrollHere('hodpreface')" class="toclink">About this book</button>
			</div>
			<div class="head2"><button id="ToC_2" onclick="scrollHere('wq3')" class="toclink">About the other Host On-Demand documentation</button>
			</div>
			<div class="head2"><button id="ToC_3" onclick="scrollHere('wq4')" class="toclink">Conventions used in this book</button>
			</div>
			<div class="head0"><button id="ToC_4" onclick="scrollHere('part_macro_basics')" class="toclink"> Macro basics</button>
			</div>
			<div class="head1"><button id="ToC_5" onclick="scrollHere('intro')" class="toclink">Introduction</button>
			</div>
			<div class="head2"><button id="ToC_6" onclick="scrollHere('wq10')" class="toclink">Host On-Demand macros</button>
			</div>
			<div class="head3"><button id="ToC_7" onclick="scrollHere('wq11')" class="toclink">Definition of a macro</button>
			</div>
			<div class="head3"><button id="ToC_8" onclick="scrollHere('wq12')" class="toclink">Advantages of macros</button>
			</div>
			<div class="head3"><button id="ToC_9" onclick="scrollHere('wq13')" class="toclink">Unsophisticated users</button>
			</div>
			<div class="head3"><button id="ToC_10" onclick="scrollHere('wq14')" class="toclink">Sophisticated users</button>
			</div>
			<div class="head3"><button id="ToC_11" onclick="scrollHere('wq15')" class="toclink">Programming features</button>
			</div>
			<div class="head3"><button id="ToC_12" onclick="scrollHere('wq16')" class="toclink">Samples</button>
			</div>
			<div class="head2"><button id="ToC_13" onclick="scrollHere('wq17')" class="toclink">Deploying macros</button>
			</div>
			<div class="head2"><button id="ToC_14" onclick="scrollHere('wq18')" class="toclink">Using macros to integrate your enterprise applications</button>
			</div>
			<div class="head2"><button id="ToC_15" onclick="scrollHere('wq19')" class="toclink">Host Access Toolkit</button>
			</div>
			<div class="head2"><button id="ToC_16" onclick="scrollHere('introsecurity')" class="toclink">Macros and security</button>
			</div>
			<div class="head2"><button id="ToC_17" onclick="scrollHere('abouthisdocument')" class="toclink">This book focuses on 3270 applications</button>
			</div>
			<div class="head1"><button id="ToC_18" onclick="scrollHere('mc_concepts')" class="toclink">Macro components</button>
			</div>
			<div class="head2"><button id="ToC_19" onclick="scrollHere('wq20')" class="toclink">Overview</button>
			</div>
			<div class="head2"><button id="ToC_20" onclick="scrollHere('wq21')" class="toclink">Macro Manager</button>
			</div>
			<div class="head3"><button id="ToC_21" onclick="scrollHere('mc1_mm_toolbar')" class="toclink">Macro Manager toolbar</button>
			</div>
			<div class="head3"><button id="ToC_22" onclick="scrollHere('mc1_macro_editor')" class="toclink">Macro Editor</button>
			</div>
			<div class="head3"><button id="ToC_23" onclick="scrollHere('mc1_code_editor')" class="toclink">Code Editor</button>
			</div>
			<div class="head2"><button id="ToC_24" onclick="scrollHere('mc1_macro_runtime')" class="toclink">Macro runtime</button>
			</div>
			<div class="head2"><button id="ToC_25" onclick="scrollHere('mc1_macro_object')" class="toclink">Macro object</button>
			</div>
			<div class="head2"><button id="ToC_26" onclick="scrollHere('mc1_other_terms')" class="toclink">Definitions of other terms</button>
			</div>
			<div class="head1"><button id="ToC_27" onclick="scrollHere('mx_record_and_playback')" class="toclink">Recording and playing back a simple macro</button>
			</div>
			<div class="head2"><button id="ToC_28" onclick="scrollHere('mx_recording')" class="toclink">Recording a simple macro</button>
			</div>
			<div class="head2"><button id="ToC_29" onclick="scrollHere('g1_playback')" class="toclink">Playing back a simple macro</button>
			</div>
			<div class="head2"><button id="ToC_30" onclick="scrollHere('wq29')" class="toclink">Assigning the macro to a key combination</button>
			</div>
			<div class="head1"><button id="ToC_31" onclick="scrollHere('mc2_concepts')" class="toclink">Macro structure</button>
			</div>
			<div class="head2"><button id="ToC_32" onclick="scrollHere('mc2_macro_script')" class="toclink">Macro script</button>
			</div>
			<div class="head3"><button id="ToC_33" onclick="scrollHere('wq32')" class="toclink">XML elements</button>
			</div>
			<div class="head3"><button id="ToC_34" onclick="scrollHere('mc2_conceptual_view_macro_script')" class="toclink">Conceptual view of a macro script</button>
			</div>
			<div class="head3"><button id="ToC_35" onclick="scrollHere('wq33')" class="toclink">Introduction to the Macro tab</button>
			</div>
			<div class="head2"><button id="ToC_36" onclick="scrollHere('mc2_macro_screen_group')" class="toclink">The macro screen and its subcomponents</button>
			</div>
			<div class="head3"><button id="ToC_37" onclick="scrollHere('mc_application_screen')" class="toclink">Application screen</button>
			</div>
			<div class="head3"><button id="ToC_38" onclick="scrollHere('mc2_macro_screen')" class="toclink">Macro screen</button>
			</div>
			<div class="head3"><button id="ToC_39" onclick="scrollHere('mc2_macro_screen_conceptual')" class="toclink">Conceptual view of a macro screen</button>
			</div>
			<div class="head3"><button id="ToC_40" onclick="scrollHere('wq34')" class="toclink">Introduction to the Screens tab</button>
			</div>
			<div class="head0"><button id="ToC_41" onclick="scrollHere('part_developing_macros')" class="toclink">Developing macros</button>
			</div>
			<div class="head1"><button id="ToC_42" onclick="scrollHere('me_expressions')" class="toclink">Data types, operators, and expressions</button>
			</div>
			<div class="head2"><button id="ToC_43" onclick="scrollHere('me_choosing_a_format')" class="toclink">Choosing a macro format</button>
			</div>
			<div class="head3"><button id="ToC_44" onclick="scrollHere('me_basic_vs_advanced')" class="toclink">The basic macro format versus the advanced macro format</button>
			</div>
			<div class="head3"><button id="ToC_45" onclick="scrollHere('me_representing_strings')" class="toclink">Representation of strings and special characters, treatment of operator characters</button>
			</div>
			<div class="head3"><button id="ToC_48" onclick="scrollHere('me_convert_macro_format')" class="toclink">Converting your macro to a different format</button>
			</div>
			<div class="head2"><button id="ToC_51" onclick="scrollHere('mc_standard_data_types')" class="toclink">Standard data types</button>
			</div>
			<div class="head3"><button id="ToC_52" onclick="scrollHere('me_boolean')" class="toclink">Boolean data</button>
			</div>
			<div class="head3"><button id="ToC_54" onclick="scrollHere('wq39')" class="toclink">Integers</button>
			</div>
			<div class="head3"><button id="ToC_56" onclick="scrollHere('wq41')" class="toclink">Doubles</button>
			</div>
			<div class="head3"><button id="ToC_57" onclick="scrollHere('wq42')" class="toclink">Strings</button>
			</div>
			<div class="head2"><button id="ToC_58" onclick="scrollHere('wq43')" class="toclink">Fields</button>
			</div>
			<div class="head2"><button id="ToC_59" onclick="scrollHere('wq44')" class="toclink">The value null</button>
			</div>
			<div class="head2"><button id="ToC_60" onclick="scrollHere('me_arithmetic')" class="toclink">Arithmetic operators and expressions</button>
			</div>
			<div class="head3"><button id="ToC_61" onclick="scrollHere('me_operators_and_expressions')" class="toclink">Operators and expressions</button>
			</div>
			<div class="head3"><button id="ToC_62" onclick="scrollHere('wq48')" class="toclink">Where arithmetic expressions can be used</button>
			</div>
			<div class="head2"><button id="ToC_63" onclick="scrollHere('me_string_concat_operator')" class="toclink">String concatenation operator (+)</button>
			</div>
			<div class="head3"><button id="ToC_64" onclick="scrollHere('wq49')" class="toclink">Operators and expressions</button>
			</div>
			<div class="head2"><button id="ToC_65" onclick="scrollHere('me_conditional_expressions')" class="toclink">Conditional and logical operators and expressions</button>
			</div>
			<div class="head3"><button id="ToC_66" onclick="scrollHere('wq59')" class="toclink">Conditional expression can include complex terms</button>
			</div>
			<div class="head3"><button id="ToC_67" onclick="scrollHere('wq60')" class="toclink">Where conditional expressions can be used</button>
			</div>
			<div class="head2"><button id="ToC_68" onclick="scrollHere('me_data_type_conversion')" class="toclink">Automatic data type conversion</button>
			</div>
			<div class="head3"><button id="ToC_69" onclick="scrollHere('wq61')" class="toclink">Effect of context</button>
			</div>
			<div class="head3"><button id="ToC_70" onclick="scrollHere('me_cast_to_boolean')" class="toclink">Conversion to boolean</button>
			</div>
			<div class="head3"><button id="ToC_71" onclick="scrollHere('wq62')" class="toclink">Conversion to integer</button>
			</div>
			<div class="head3"><button id="ToC_72" onclick="scrollHere('wq63')" class="toclink">Conversion to double</button>
			</div>
			<div class="head3"><button id="ToC_73" onclick="scrollHere('wq64')" class="toclink">Conversion to string</button>
			</div>
			<div class="head3"><button id="ToC_74" onclick="scrollHere('wq65')" class="toclink">Conversion errors</button>
			</div>
			<div class="head2"><button id="ToC_75" onclick="scrollHere('me_equivalents')" class="toclink">Equivalents</button>
			</div>
			<div class="head2"><button id="ToC_76" onclick="scrollHere('me1_negative_row_or_col')" class="toclink">Significance of a negative value for a row or column</button>
			</div>
			<div class="head1"><button id="ToC_77" onclick="scrollHere('mc3_processing_macro_screen')" class="toclink">How the macro runtime processes a macro screen</button>
			</div>
			<div class="head2"><button id="ToC_78" onclick="scrollHere('wq71')" class="toclink">Overview</button>
			</div>
			<div class="head3"><button id="ToC_79" onclick="scrollHere('wq72')" class="toclink">Scenario used as an example</button>
			</div>
			<div class="head3"><button id="ToC_80" onclick="scrollHere('wq79')" class="toclink">Stages in processing a macro screen</button>
			</div>
			<div class="head3"><button id="ToC_81" onclick="scrollHere('wq81')" class="toclink">Closer look at stage 1</button>
			</div>
			<div class="head3"><button id="ToC_82" onclick="scrollHere('mc3_overview_of_entire_process')" class="toclink">Overview of the entire process (all 3 stages)</button>
			</div>
			<div class="head3"><button id="ToC_83" onclick="scrollHere('wq82')" class="toclink">Conclusion of the overview</button>
			</div>
			<div class="head2"><button id="ToC_84" onclick="scrollHere('wq83')" class="toclink">Stage 1: Determining the next macro screen to be processed</button>
			</div>
			<div class="head3"><button id="ToC_85" onclick="scrollHere('wq84')" class="toclink">Adding macro screen names to the list of valid next screens (step 1(a))</button>
			</div>
			<div class="head3"><button id="ToC_91" onclick="scrollHere('wq89')" class="toclink">Screen recognition (step 1(b))</button>
			</div>
			<div class="head3"><button id="ToC_98" onclick="scrollHere('wq95')" class="toclink">Removing the names of candidate macro screens from the list of valid next screens (step 1(c))</button>
			</div>
			<div class="head2"><button id="ToC_99" onclick="scrollHere('wq96')" class="toclink">Stage 2: Making the successful candidate the new current macro screen</button>
			</div>
			<div class="head2"><button id="ToC_100" onclick="scrollHere('wq97')" class="toclink">Stage 3: Performing the actions in the new current macro screen</button>
			</div>
			<div class="head3"><button id="ToC_101" onclick="scrollHere('wq98')" class="toclink">Inserting a delay after an action</button>
			</div>
			<div class="head2"><button id="ToC_102" onclick="scrollHere('wq99')" class="toclink">Repeating the processing cycle</button>
			</div>
			<div class="head2"><button id="ToC_103" onclick="scrollHere('wq100')" class="toclink">Terminating the macro</button>
			</div>
			<div class="head1"><button id="ToC_104" onclick="scrollHere('md1_screen_description')" class="toclink">Screen description and recognition</button>
			</div>
			<div class="head2"><button id="ToC_105" onclick="scrollHere('md1_screen_desc_and_recog')" class="toclink">Terms defined</button>
			</div>
			<div class="head2"><button id="ToC_106" onclick="scrollHere('md1_description_tab')" class="toclink">Introduction to the Description tab</button>
			</div>
			<div class="head3"><button id="ToC_107" onclick="scrollHere('wq101')" class="toclink">Sample Description tab</button>
			</div>
			<div class="head2"><button id="ToC_109" onclick="scrollHere('mc3_recorded_descriptions')" class="toclink">Recorded descriptions</button>
			</div>
			<div class="head3"><button id="ToC_110" onclick="scrollHere('wq102')" class="toclink">What information is recorded</button>
			</div>
			<div class="head3"><button id="ToC_111" onclick="scrollHere('wq103')" class="toclink">Why the recorded descriptions work</button>
			</div>
			<div class="head3"><button id="ToC_112" onclick="scrollHere('wq104')" class="toclink">Recorded descriptors provide a framework</button>
			</div>
			<div class="head2"><button id="ToC_113" onclick="scrollHere('md1_evaluation_of_descriptors')" class="toclink">Evaluation of descriptors</button>
			</div>
			<div class="head3"><button id="ToC_114" onclick="scrollHere('wq105')" class="toclink">Practical information</button>
			</div>
			<div class="head3"><button id="ToC_115" onclick="scrollHere('wq106')" class="toclink">Overview of the process</button>
			</div>
			<div class="head3"><button id="ToC_116" onclick="scrollHere('md1_eval_indiv_descriptors')" class="toclink">Evaluation of individual descriptors</button>
			</div>
			<div class="head3"><button id="ToC_117" onclick="scrollHere('md1_default_method')" class="toclink">Default combining method</button>
			</div>
			<div class="head3"><button id="ToC_122" onclick="scrollHere('md1_uselogic_attribute')" class="toclink">The uselogic attribute</button>
			</div>
			<div class="head2"><button id="ToC_123" onclick="scrollHere('wq115')" class="toclink">The descriptors</button>
			</div>
			<div class="head3"><button id="ToC_124" onclick="scrollHere('wq116')" class="toclink">Overview</button>
			</div>
			<div class="head3"><button id="ToC_125" onclick="scrollHere('md1_fieldcounts_and_oia')" class="toclink">Field Counts and OIA descriptor</button>
			</div>
			<div class="head3"><button id="ToC_136" onclick="scrollHere('md1_string')" class="toclink">String descriptor (&lt;string&gt; element)</button>
			</div>
			<div class="head3"><button id="ToC_144" onclick="scrollHere('md1_cursor')" class="toclink">Cursor descriptor (&lt;cursor&gt; element)</button>
			</div>
			<div class="head3"><button id="ToC_146" onclick="scrollHere('md1_attribute')" class="toclink">Attribute descriptor (&lt;attrib&gt; element)</button>
			</div>
			<div class="head3"><button id="ToC_149" onclick="scrollHere('md_condition')" class="toclink">Condition descriptor (&lt;condition&gt;) element</button>
			</div>
			<div class="head3"><button id="ToC_150" onclick="scrollHere('md_customreco')" class="toclink">Custom descriptor (&lt;customreco&gt; element)</button>
			</div>
			<div class="head2"><button id="ToC_151" onclick="scrollHere('md1_var_update')" class="toclink">Variable update action (&lt;varupdate&gt; element)</button>
			</div>
			<div class="head3"><button id="ToC_152" onclick="scrollHere('md1_vu_process')" class="toclink">Processing a Variable update action in a description</button>
			</div>
			<div class="head3"><button id="ToC_153" onclick="scrollHere('md1_vu_diff_sequence')" class="toclink">Variable update with the <strong>uselogic</strong> attribute</button>
			</div>
			<div class="head1"><button id="ToC_154" onclick="scrollHere('ma_actions_part1')" class="toclink">Macro actions</button>
			</div>
			<div class="head2"><button id="ToC_155" onclick="scrollHere('wq145')" class="toclink">In general</button>
			</div>
			<div class="head3"><button id="ToC_156" onclick="scrollHere('wq146')" class="toclink">The actions by function</button>
			</div>
			<div class="head3"><button id="ToC_157" onclick="scrollHere('wq147')" class="toclink">How actions are performed</button>
			</div>
			<div class="head3"><button id="ToC_160" onclick="scrollHere('wq150')" class="toclink">Specifying parameters for actions</button>
			</div>
			<div class="head2"><button id="ToC_161" onclick="scrollHere('ma_actions_tab')" class="toclink">Introduction to the Actions tab</button>
			</div>
			<div class="head3"><button id="ToC_162" onclick="scrollHere('ma_sample_actions_tab')" class="toclink">Sample Actions tab</button>
			</div>
			<div class="head3"><button id="ToC_163" onclick="scrollHere('md1_creating_new_action')" class="toclink">Creating a new action</button>
			</div>
			<div class="head2"><button id="ToC_164" onclick="scrollHere('wq151')" class="toclink">The actions</button>
			</div>
			<div class="head3"><button id="ToC_165" onclick="scrollHere('ma_boxselection')" class="toclink">Box selection action (&lt;boxselection&gt; element)</button>
			</div>
			<div class="head3"><button id="ToC_170" onclick="scrollHere('ma_commwait')" class="toclink">Comm wait action (&lt;commwait&gt; element)</button>
			</div>
			<div class="head3"><button id="ToC_176" onclick="scrollHere('ma_condition')" class="toclink">Conditional action (&lt;if&gt; element and &lt;else&gt; element)</button>
			</div>
			<div class="head3"><button id="ToC_182" onclick="scrollHere('ma_extract')" class="toclink">Extract action (&lt;extract&gt; element)</button>
			</div>
			<div class="head3"><button id="ToC_197" onclick="scrollHere('ma_fileupload')" class="toclink">FileUpload action (&lt;fileupload&gt; element)</button>
			</div>
			<div class="head3"><button id="ToC_210" onclick="scrollHere('ma_input')" class="toclink">Input action (&lt;input&gt; element)</button>
			</div>
			<div class="head3"><button id="ToC_223" onclick="scrollHere('ma_message')" class="toclink">Message action (&lt;message&gt; element)</button>
			</div>
			<div class="head3"><button id="ToC_225" onclick="scrollHere('ma_mouseclick')" class="toclink">Mouse click action (&lt;mouseclick&gt; element)</button>
			</div>
			<div class="head3"><button id="ToC_229" onclick="scrollHere('ma_pause')" class="toclink">Pause action (&lt;pause&gt; element)</button>
			</div>
			<div class="head3"><button id="ToC_230" onclick="scrollHere('ma_perform')" class="toclink">Perform action (&lt;perform&gt; element)</button>
			</div>
			<div class="head3"><button id="ToC_233" onclick="scrollHere('ma_playmacro')" class="toclink">PlayMacro action (&lt;playmacro&gt; element)</button>
			</div>
			<div class="head3"><button id="ToC_242" onclick="scrollHere('ma_print')" class="toclink">Print actions (&lt;print&gt; element)</button>
			</div>
			<div class="head3"><button id="ToC_252" onclick="scrollHere('ma_prompt')" class="toclink">Prompt action (&lt;prompt&gt; element)</button>
			</div>
			<div class="head3"><button id="ToC_265" onclick="scrollHere('ma_runprogram')" class="toclink">Run program action (&lt;runprogram&gt; element)</button>
			</div>
			<div class="head3"><button id="ToC_270" onclick="scrollHere('ma_sqlquery')" class="toclink">SQLQuery action (&lt;sqlquery&gt; element)</button>
			</div>
			<div class="head3"><button id="ToC_284" onclick="scrollHere('ma_trace')" class="toclink">Trace action (&lt;trace&gt; element)</button>
			</div>
			<div class="head3"><button id="ToC_287" onclick="scrollHere('ma_varupdate')" class="toclink">Variable update action (&lt;varupdate&gt; element)</button>
			</div>
			<div class="head3"><button id="ToC_290" onclick="scrollHere('ma_xfer')" class="toclink">Xfer action (&lt;filexfer&gt; element)</button>
			</div>
			<div class="head1"><button id="ToC_296" onclick="scrollHere('mn_links')" class="toclink">Screen Recognition, Part 2</button>
			</div>
			<div class="head2"><button id="ToC_297" onclick="scrollHere('ms1_valid_next_screens')" class="toclink">Valid next screens</button>
			</div>
			<div class="head2"><button id="ToC_298" onclick="scrollHere('mn_entry_exit_transient')" class="toclink">Entry screens, exit screens, and transient screens</button>
			</div>
			<div class="head3"><button id="ToC_299" onclick="scrollHere('mn_entry_screen')" class="toclink">Entry screens</button>
			</div>
			<div class="head3"><button id="ToC_302" onclick="scrollHere('mn_exit_screen')" class="toclink">Exit screens</button>
			</div>
			<div class="head3"><button id="ToC_303" onclick="scrollHere('mn_transient_screen')" class="toclink">Transient screens</button>
			</div>
			<div class="head2"><button id="ToC_305" onclick="scrollHere('mt_screen_recog_timeout')" class="toclink">Timeout settings for screen recognition</button>
			</div>
			<div class="head3"><button id="ToC_306" onclick="scrollHere('wq244')" class="toclink">Screen recognition</button>
			</div>
			<div class="head3"><button id="ToC_307" onclick="scrollHere('mt_timeout_between_screens')" class="toclink">Timeout Between Screens (Macro tab)</button>
			</div>
			<div class="head3"><button id="ToC_308" onclick="scrollHere('wq245')" class="toclink">Timeout (Links tab)</button>
			</div>
			<div class="head2"><button id="ToC_309" onclick="scrollHere('mn_recolimit')" class="toclink">Recognition limit (General tab of the Screens tab)</button>
			</div>
			<div class="head3"><button id="ToC_310" onclick="scrollHere('wq246')" class="toclink">Determining when the recognition limit is reached</button>
			</div>
			<div class="head3"><button id="ToC_311" onclick="scrollHere('wq248')" class="toclink">Action when the Recognition limit is reached</button>
			</div>
			<div class="head1"><button id="ToC_312" onclick="scrollHere('mt_timing')" class="toclink">Actions, Part 2: Timing issues</button>
			</div>
			<div class="head2"><button id="ToC_313" onclick="scrollHere('mt_delay_after_action')" class="toclink">Pause after an action</button>
			</div>
			<div class="head3"><button id="ToC_314" onclick="scrollHere('wq249')" class="toclink">Speed of processing actions</button>
			</div>
			<div class="head3"><button id="ToC_315" onclick="scrollHere('mt_pause_between_actions')" class="toclink">Pause Between Actions (Macro tab)</button>
			</div>
			<div class="head3"><button id="ToC_316" onclick="scrollHere('mt_set_pause_time')" class="toclink">Set Pause Time (General tab of the Screens tab)</button>
			</div>
			<div class="head3"><button id="ToC_317" onclick="scrollHere('wq250')" class="toclink">Adding a pause after a particular action</button>
			</div>
			<div class="head2"><button id="ToC_318" onclick="scrollHere('mt_screen_completion')" class="toclink">Screen completion</button>
			</div>
			<div class="head3"><button id="ToC_319" onclick="scrollHere('mt_sc_too_soon')" class="toclink">Recognizing the next macro screen too soon</button>
			</div>
			<div class="head3"><button id="ToC_320" onclick="scrollHere('wq252')" class="toclink">The ordinary TN3270 protocol</button>
			</div>
			<div class="head3"><button id="ToC_321" onclick="scrollHere('wq254')" class="toclink">Solutions</button>
			</div>
			<div class="head3"><button id="ToC_325" onclick="scrollHere('mt_attributes_screen_completion')" class="toclink">Attributes that deal with screen completion</button>
			</div>
			<div class="head1"><button id="ToC_329" onclick="scrollHere('mv_variables')" class="toclink">Variables and imported Java classes</button>
			</div>
			<div class="head2"><button id="ToC_330" onclick="scrollHere('wq257')" class="toclink">Introduction to variables and imported types</button>
			</div>
			<div class="head3"><button id="ToC_331" onclick="scrollHere('wq258')" class="toclink">Advanced macro format required</button>
			</div>
			<div class="head3"><button id="ToC_332" onclick="scrollHere('wq259')" class="toclink">Scope of variables</button>
			</div>
			<div class="head3"><button id="ToC_333" onclick="scrollHere('mv1_intro_to_vars_tab')" class="toclink">Introduction to the Variables tab</button>
			</div>
			<div class="head2"><button id="ToC_336" onclick="scrollHere('wq267')" class="toclink">Issues you should be aware of</button>
			</div>
			<div class="head3"><button id="ToC_337" onclick="scrollHere('wq268')" class="toclink">Deploying Java libraries or classes</button>
			</div>
			<div class="head3"><button id="ToC_338" onclick="scrollHere('mv_var_and_type_names')" class="toclink">Variable names and type names</button>
			</div>
			<div class="head3"><button id="ToC_339" onclick="scrollHere('wq269')" class="toclink">Transferring variables from one macro to another</button>
			</div>
			<div class="head3"><button id="ToC_340" onclick="scrollHere('mv_field_vars')" class="toclink">Field variables</button>
			</div>
			<div class="head2"><button id="ToC_341" onclick="scrollHere('wq272')" class="toclink">Using variables</button>
			</div>
			<div class="head3"><button id="ToC_342" onclick="scrollHere('wq273')" class="toclink">When variables are initialized</button>
			</div>
			<div class="head3"><button id="ToC_343" onclick="scrollHere('me_using_vars_in_general')" class="toclink">Using variables belonging to a standard type</button>
			</div>
			<div class="head3"><button id="ToC_348" onclick="scrollHere('wq277')" class="toclink">Using variables belonging to an imported type</button>
			</div>
			<div class="head3"><button id="ToC_352" onclick="scrollHere('wq281')" class="toclink">Comparing variables of the same imported type</button>
			</div>
			<div class="head2"><button id="ToC_353" onclick="scrollHere('mv1_passing_a_parameter_list')" class="toclink">Passing a parameter list to a macro</button>
			</div>
			<div class="head3"><button id="ToC_354" onclick="scrollHere('wq283')" class="toclink">How the Host On-Demand processes a parameter list</button>
			</div>
			<div class="head3"><button id="ToC_355" onclick="scrollHere('mv1_specifying_parm_list')" class="toclink">Specifying the parameter list</button>
			</div>
			<div class="head3"><button id="ToC_360" onclick="scrollHere('mv1_macro_writer_considerations')" class="toclink">Considerations for the macro writer</button>
			</div>
			<div class="head3"><button id="ToC_361" onclick="scrollHere('wq289')" class="toclink">A parameter list does not initialize variables in a chained-to macro</button>
			</div>
			<div class="head2"><button id="ToC_362" onclick="scrollHere('mv_calling_a_method')" class="toclink">Calling Java methods</button>
			</div>
			<div class="head3"><button id="ToC_363" onclick="scrollHere('wq290')" class="toclink">Where method calls can be used</button>
			</div>
			<div class="head3"><button id="ToC_364" onclick="scrollHere('mv_syntax_of_method_calls')" class="toclink">Syntax of a method call</button>
			</div>
			<div class="head3"><button id="ToC_365" onclick="scrollHere('mv_how_search_for_method')" class="toclink">How the macro runtime searches for a called method</button>
			</div>
			<div class="head2"><button id="ToC_366" onclick="scrollHere('mv1_hml_libraries')" class="toclink">The Macro Utility Libraries (HML libraries)</button>
			</div>
			<div class="head3"><button id="ToC_367" onclick="scrollHere('wq298')" class="toclink">Invoking an method belonging to an HML library</button>
			</div>
			<div class="head3"><button id="ToC_368" onclick="scrollHere('wq299')" class="toclink">Variables names beginning with HML are reserved</button>
			</div>
			<div class="head3"><button id="ToC_369" onclick="scrollHere('wq300')" class="toclink">$HMLFormatUtil$</button>
			</div>
			<div class="head3"><button id="ToC_374" onclick="scrollHere('wq304')" class="toclink">$HMLPSUtil$</button>
			</div>
			<div class="head3"><button id="ToC_388" onclick="scrollHere('wq321')" class="toclink">$HMLSessionUtil$</button>
			</div>
			<div class="head3"><button id="ToC_393" onclick="scrollHere('mv1_hmlsqlutil')" class="toclink">$HMLSQLUtil$</button>
			</div>
			<div class="head3"><button id="ToC_400" onclick="scrollHere('wq334')" class="toclink">$HMLSystemUtil$</button>
			</div>
			<div class="head3"><button id="ToC_407" onclick="scrollHere('wq340')" class="toclink">FormatNumberToString() and FormatStringToNumber()</button>
			</div>
			<div class="head1"><button id="ToC_408" onclick="scrollHere('msec_more_about_security')" class="toclink">Other security options</button>
			</div>
			<div class="head2"><button id="ToC_409" onclick="scrollHere('msec_recordpassword')" class="toclink">Record password</button>
			</div>
			<div class="head3"><button id="ToC_410" onclick="scrollHere('msec_recordpassword_enabled')" class="toclink">When Record Password is enabled</button>
			</div>
			<div class="head3"><button id="ToC_411" onclick="scrollHere('msec_recordpassword_disabled')" class="toclink">When Record Password is disabled</button>
			</div>
			<div class="head1"><button id="ToC_412" onclick="scrollHere('ms_features')" class="toclink">Other advanced features</button>
			</div>
			<div class="head2"><button id="ToC_413" onclick="scrollHere('wq341')" class="toclink">Interacting with more than one session</button>
			</div>
			<div class="head3"><button id="ToC_414" onclick="scrollHere('wq342')" class="toclink">Basics</button>
			</div>
			<div class="head3"><button id="ToC_415" onclick="scrollHere('ms_implementation')" class="toclink">Implementation</button>
			</div>
			<div class="head3"><button id="ToC_416" onclick="scrollHere('ms_two_techniques')" class="toclink">Two techniques for building macro screens</button>
			</div>
			<div class="head3"><button id="ToC_417" onclick="scrollHere('wq344')" class="toclink">Runtime processing</button>
			</div>
			<div class="head3"><button id="ToC_422" onclick="scrollHere('ms_runtime_requirements')" class="toclink">Run-time requirements</button>
			</div>
			<div class="head3"><button id="ToC_423" onclick="scrollHere('ms_hostid')" class="toclink">Specifying a Host ID</button>
			</div>
			<div class="head3"><button id="ToC_425" onclick="scrollHere('ms_recording')" class="toclink">Recording a macro that interacts with more than one session</button>
			</div>
			<div class="head3"><button id="ToC_432" onclick="scrollHere('ms_diff_sn_same_macro_screen')" class="toclink">Referring to different sessions in the same macro screen</button>
			</div>
			<div class="head3"><button id="ToC_433" onclick="scrollHere('wq364')" class="toclink">Disabling macro recording</button>
			</div>
			<div class="head1"><button id="ToC_434" onclick="scrollHere('mg_the_gui')" class="toclink">The graphical user interface</button>
			</div>
			<div class="head2"><button id="ToC_435" onclick="scrollHere('wq365')" class="toclink">Updating fields in the Macro Editor</button>
			</div>
			<div class="head3"><button id="ToC_436" onclick="scrollHere('mg_using_session_window')" class="toclink">Using the session window</button>
			</div>
			<div class="head3"><button id="ToC_437" onclick="scrollHere('mg_bounding_rectangle')" class="toclink">Using the marking rectangle</button>
			</div>
			<div class="head3"><button id="ToC_438" onclick="scrollHere('mg_using_text_cursor')" class="toclink">Using the session window's text cursor</button>
			</div>
			<div class="head3"><button id="ToC_439" onclick="scrollHere('mg_string_error')" class="toclink">Error in specifying a string</button>
			</div>
			<div class="head2"><button id="ToC_440" onclick="scrollHere('mg_code_editor')" class="toclink">Using the Code Editor</button>
			</div>
			<div class="head3"><button id="ToC_441" onclick="scrollHere('mg_ce_copypaste')" class="toclink">Copy and paste a script from this guide into the Code Editor</button>
			</div>
			<div class="head0"><button id="ToC_442" onclick="scrollHere('part_langref')" class="toclink">The macro language</button>
			</div>
			<div class="head1"><button id="ToC_443" onclick="scrollHere('wq374')" class="toclink">Features of the macro language</button>
			</div>
			<div class="head2"><button id="ToC_444" onclick="scrollHere('wq375')" class="toclink">Use of XML</button>
			</div>
			<div class="head3"><button id="ToC_445" onclick="scrollHere('ml1_macro_syntax')" class="toclink">XML syntax in the Host On-Demand macro language</button>
			</div>
			<div class="head3"><button id="ToC_446" onclick="scrollHere('wq376')" class="toclink">Code Editor</button>
			</div>
			<div class="head2"><button id="ToC_447" onclick="scrollHere('wq377')" class="toclink">Hierarchy of the elements</button>
			</div>
			<div class="head2"><button id="ToC_448" onclick="scrollHere('cr_xml_comments')" class="toclink">Inserting comments into a macro script</button>
			</div>
			<div class="head3"><button id="ToC_449" onclick="scrollHere('wq378')" class="toclink">Format of comments</button>
			</div>
			<div class="head3"><button id="ToC_450" onclick="scrollHere('wq379')" class="toclink">Comment errors</button>
			</div>
			<div class="head3"><button id="ToC_451" onclick="scrollHere('ml_examples_of_comments')" class="toclink">Examples of comments</button>
			</div>
			<div class="head2"><button id="ToC_452" onclick="scrollHere('ml_debug_trace')" class="toclink">Debugging macro scripts with the &lt;trace&gt; element</button>
			</div>
			<div class="head2"><button id="ToC_453" onclick="scrollHere('wq380')" class="toclink">Using the Host Access Toolkit product with macros</button>
			</div>
			<div class="head1"><button id="ToC_454" onclick="scrollHere('mr_reference_to_elements')" class="toclink">Macro language elements</button>
			</div>
			<div class="head2"><button id="ToC_455" onclick="scrollHere('wq381')" class="toclink">Specifying the attributes</button>
			</div>
			<div class="head3"><button id="ToC_456" onclick="scrollHere('wq382')" class="toclink">XML requirements</button>
			</div>
			<div class="head3"><button id="ToC_457" onclick="scrollHere('wq383')" class="toclink">Advanced format in attribute values</button>
			</div>
			<div class="head3"><button id="ToC_458" onclick="scrollHere('wq384')" class="toclink">Typed data</button>
			</div>
			<div class="head2"><button id="ToC_459" onclick="scrollHere('mr_actions')" class="toclink">&lt;actions&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_460" onclick="scrollHere('wq385')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_461" onclick="scrollHere('mr_actions_attributes')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_462" onclick="scrollHere('wq387')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_463" onclick="scrollHere('mr_attribute')" class="toclink">&lt;attrib&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_464" onclick="scrollHere('wq388')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_465" onclick="scrollHere('wq389')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_466" onclick="scrollHere('wq390')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_467" onclick="scrollHere('mr_boxselection')" class="toclink">&lt;boxselection&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_468" onclick="scrollHere('wq391')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_469" onclick="scrollHere('wq392')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_470" onclick="scrollHere('wq393')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_471" onclick="scrollHere('cr_comment')" class="toclink">&lt;comment&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_472" onclick="scrollHere('wq394')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_474" onclick="scrollHere('wq396')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_475" onclick="scrollHere('wq397')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_476" onclick="scrollHere('mr_commwait')" class="toclink">&lt;commwait&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_477" onclick="scrollHere('wq398')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_478" onclick="scrollHere('wq399')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_479" onclick="scrollHere('wq400')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_480" onclick="scrollHere('cr_condition')" class="toclink">&lt;condition&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_481" onclick="scrollHere('wq401')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_482" onclick="scrollHere('wq402')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_483" onclick="scrollHere('wq403')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_484" onclick="scrollHere('mr_create')" class="toclink">&lt;create&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_485" onclick="scrollHere('wq404')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_486" onclick="scrollHere('wq405')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_487" onclick="scrollHere('wq406')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_488" onclick="scrollHere('mr_cursor')" class="toclink">&lt;cursor&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_489" onclick="scrollHere('wq407')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_490" onclick="scrollHere('wq408')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_491" onclick="scrollHere('wq409')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_492" onclick="scrollHere('mr_custom')" class="toclink">&lt;custom&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_493" onclick="scrollHere('wq410')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_494" onclick="scrollHere('wq412')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_495" onclick="scrollHere('wq413')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_496" onclick="scrollHere('mr_customreco')" class="toclink">&lt;customreco&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_497" onclick="scrollHere('wq414')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_498" onclick="scrollHere('wq417')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_499" onclick="scrollHere('wq418')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_500" onclick="scrollHere('mr_description')" class="toclink">&lt;description&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_501" onclick="scrollHere('wq419')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_502" onclick="scrollHere('wq420')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_503" onclick="scrollHere('wq421')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_504" onclick="scrollHere('mr_else')" class="toclink">&lt;else&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_505" onclick="scrollHere('wq422')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_506" onclick="scrollHere('wq423')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_507" onclick="scrollHere('wq424')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_508" onclick="scrollHere('mr_extract')" class="toclink">&lt;extract&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_509" onclick="scrollHere('wq425')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_510" onclick="scrollHere('wq426')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_511" onclick="scrollHere('wq427')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_512" onclick="scrollHere('mr_fileupload')" class="toclink">&lt;fileupload&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_513" onclick="scrollHere('wq428')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_514" onclick="scrollHere('wq429')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_515" onclick="scrollHere('wq430')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_516" onclick="scrollHere('mr_filexfer')" class="toclink">&lt;filexfer&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_517" onclick="scrollHere('wq431')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_518" onclick="scrollHere('mr_filexfer_attributes')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_519" onclick="scrollHere('wq432')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_520" onclick="scrollHere('mr_hascript')" class="toclink">&lt;HAScript&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_521" onclick="scrollHere('wq433')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_522" onclick="scrollHere('wq434')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_523" onclick="scrollHere('wq435')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_524" onclick="scrollHere('mr_if')" class="toclink">&lt;if&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_525" onclick="scrollHere('wq436')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_526" onclick="scrollHere('wq437')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_527" onclick="scrollHere('wq438')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_528" onclick="scrollHere('mr_import')" class="toclink">&lt;import&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_529" onclick="scrollHere('wq439')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_530" onclick="scrollHere('wq440')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_531" onclick="scrollHere('wq441')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_532" onclick="scrollHere('mr_input')" class="toclink">&lt;input&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_533" onclick="scrollHere('wq442')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_534" onclick="scrollHere('wq443')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_535" onclick="scrollHere('wq444')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_536" onclick="scrollHere('mr_message')" class="toclink">&lt;message&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_537" onclick="scrollHere('wq445')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_538" onclick="scrollHere('wq446')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_539" onclick="scrollHere('wq447')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_540" onclick="scrollHere('mr_mouseclick')" class="toclink">&lt;mouseclick&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_541" onclick="scrollHere('wq448')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_542" onclick="scrollHere('wq449')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_543" onclick="scrollHere('wq450')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_544" onclick="scrollHere('cr_nextscreen')" class="toclink">&lt;nextscreen&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_545" onclick="scrollHere('wq451')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_546" onclick="scrollHere('wq452')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_547" onclick="scrollHere('wq453')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_548" onclick="scrollHere('cr_nextscreens')" class="toclink">&lt;nextscreens&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_549" onclick="scrollHere('wq454')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_550" onclick="scrollHere('wq455')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_551" onclick="scrollHere('wq456')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_552" onclick="scrollHere('mr_numfields')" class="toclink">&lt;numfields&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_553" onclick="scrollHere('wq457')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_554" onclick="scrollHere('wq458')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_555" onclick="scrollHere('wq459')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_556" onclick="scrollHere('mr_numinputfields')" class="toclink">&lt;numinputfields&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_557" onclick="scrollHere('wq460')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_558" onclick="scrollHere('wq461')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_559" onclick="scrollHere('wq462')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_560" onclick="scrollHere('mr_oia')" class="toclink">&lt;oia&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_561" onclick="scrollHere('wq463')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_562" onclick="scrollHere('wq464')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_563" onclick="scrollHere('wq465')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_564" onclick="scrollHere('cr_pause')" class="toclink">&lt;pause&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_565" onclick="scrollHere('wq466')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_566" onclick="scrollHere('wq467')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_567" onclick="scrollHere('wq468')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_568" onclick="scrollHere('mr_perform')" class="toclink">&lt;perform&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_569" onclick="scrollHere('wq469')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_570" onclick="scrollHere('wq470')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_571" onclick="scrollHere('wq471')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_572" onclick="scrollHere('mr_playmacro')" class="toclink">&lt;playmacro&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_573" onclick="scrollHere('wq472')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_574" onclick="scrollHere('wq473')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_575" onclick="scrollHere('wq474')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_576" onclick="scrollHere('cr_print')" class="toclink">&lt;print&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_577" onclick="scrollHere('wq475')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_578" onclick="scrollHere('wq476')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_579" onclick="scrollHere('wq477')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_580" onclick="scrollHere('mr_prompt')" class="toclink">&lt;prompt&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_581" onclick="scrollHere('wq478')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_582" onclick="scrollHere('wq479')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_583" onclick="scrollHere('wq480')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_584" onclick="scrollHere('mr_recolimit')" class="toclink">&lt;recolimit&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_585" onclick="scrollHere('wq481')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_586" onclick="scrollHere('wq482')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_587" onclick="scrollHere('wq483')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_588" onclick="scrollHere('mr_runprogram')" class="toclink">&lt;runprogram&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_589" onclick="scrollHere('wq484')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_590" onclick="scrollHere('wq485')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_591" onclick="scrollHere('wq486')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_592" onclick="scrollHere('mr_screen')" class="toclink">&lt;screen&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_593" onclick="scrollHere('wq487')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_594" onclick="scrollHere('wq488')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_595" onclick="scrollHere('wq489')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_596" onclick="scrollHere('mr_sqlquery')" class="toclink">&lt;sqlquery&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_597" onclick="scrollHere('wq490')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_598" onclick="scrollHere('wq491')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_599" onclick="scrollHere('wq492')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_600" onclick="scrollHere('mr_string')" class="toclink">&lt;string&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_601" onclick="scrollHere('wq493')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_602" onclick="scrollHere('wq494')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_603" onclick="scrollHere('wq495')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_604" onclick="scrollHere('mr_trace')" class="toclink">&lt;trace&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_605" onclick="scrollHere('wq496')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_606" onclick="scrollHere('wq497')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_607" onclick="scrollHere('wq498')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_608" onclick="scrollHere('cr_type_cmd')" class="toclink">&lt;type&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_609" onclick="scrollHere('wq499')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_610" onclick="scrollHere('wq500')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_611" onclick="scrollHere('wq501')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_612" onclick="scrollHere('mr_vars')" class="toclink">&lt;vars&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_613" onclick="scrollHere('wq502')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_614" onclick="scrollHere('wq503')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_615" onclick="scrollHere('wq504')" class="toclink">XML samples</button>
			</div>
			<div class="head2"><button id="ToC_616" onclick="scrollHere('mr_varupdate')" class="toclink">&lt;varupdate&gt; element</button>
			</div>
			<div class="head3"><button id="ToC_617" onclick="scrollHere('wq505')" class="toclink">General</button>
			</div>
			<div class="head3"><button id="ToC_618" onclick="scrollHere('wq506')" class="toclink">Attributes</button>
			</div>
			<div class="head3"><button id="ToC_619" onclick="scrollHere('wq507')" class="toclink">XML samples</button>
			</div>
			<div class="head1"><button id="ToC_620" onclick="scrollHere('ms1_sample')" class="toclink">Sample macro code</button>
			</div>
			<div class="head2"><button id="ToC_621" onclick="scrollHere('ms1_spreadsheet')" class="toclink">Copy CICS transaction records into Excel spreadsheet or DB2 database</button>
			</div>
			<div class="head3"><button id="ToC_622" onclick="scrollHere('ms1_amnu_excel')" class="toclink">Introduction</button>
			</div>
			<div class="head3"><button id="ToC_623" onclick="scrollHere('wq508')" class="toclink">Steps for running Excel sample (Windows only)</button>
			</div>
			<div class="head3"><button id="ToC_624" onclick="scrollHere('wq516')" class="toclink">Steps for running DB2 sample</button>
			</div>
			<div class="head0"><button id="ToC_625" onclick="scrollHere('wq519')" class="toclink">Appendixes</button>
			</div>
			<div class="head1"><button id="ToC_626" onclick="scrollHere('mo_eval_descriptors')" class="toclink">Appendix A. Additional information</button>
			</div>
			<div class="head2"><button id="ToC_627" onclick="scrollHere('mo_default_combining_rule')" class="toclink">The default combining rule for multiple descriptors in one macro screen</button>
			</div>
			<div class="head3"><button id="ToC_628" onclick="scrollHere('wq520')" class="toclink">Statement of the rule</button>
			</div>
			<div class="head2"><button id="ToC_629" onclick="scrollHere('mo_mnemonic_keywords')" class="toclink">Mnemonic keywords for the Input action</button>
			</div>
			<div class="head1"><button id="ToC_630" onclick="scrollHere('hdrnotice')" class="toclink">Appendix B. Notices</button>
			</div>
			<div class="head1"><button id="ToC_631" onclick="scrollHere('wq539')" class="toclink">Appendix C. Trademarks</button>
			</div>
		
		</div>
		<h1 id="hodpreface">About this book</h1>
		<p>The <em>Macro Programming Guide</em> guide you write better Host On-Demand macros. This book is written for On-Demand macro developers and ordinary users.  There are three parts.</p>
		<p><button onclick="scrollHere('part_macro_basics')"> Macro basics</button> describes basic concepts, the tools, and gives a step-by-step description of how to record play back a simple macro.</p>
		<p><button onclick="scrollHere('part_developing_macros')">Developing macros</button> describes in detail the of the Host On-Demand macro system.</p>
		<p><button onclick="scrollHere('part_langref')">The macro language</button> describes the XML macro language.</p>
		<p>The <em>Macro Programming Guide</em> at the Host On-Demand online Knowledge Center at <button href="http://www-01.ibm.com/support/knowledgecenter/SSS9FA_14.0.0/com.ibm.hod.doc/WebSphereHOD.htm">http://www-01.ibm.com/support/knowledgecenter/SSS9FA_14.0.0/com.ibm.hod.doc/doc/macro/macro.html</button>.</p>
		<p>The MySupport feature enables you to personalize support view and register to receive weekly e-mail notifications you to new patches, downloads, and other timely technical information for IBM products. To register for MySupport, follow instructions in the Technote found at the following URL:<button href="http://www.ibm.com/support/docview.wss?rs=132&amp;context=SS5RCF&amp;uid=swg21168680&amp;loc=en_US&amp;cs=utf-8&amp;lang=en+en">http://www.ibm.com/support/docview.wss?uid=swg21168680</button>.</p>
		<h2 id="wq3">About the other Host On-Demand documentation</h2>
		<p>In addition to the <em>Macro Proramming Guide</em>, Host On-Demand also provides other sources of information to you use the product.  To access the documentation described here, go to the Host On-Demand library page at <button href="http://www.ibm.com/software/webservers/hostondemand/library.html">http://www.ibm.com/software/webservers/hostondemand/library.html</button>. Most of the documentation is also included on the Host On-product or Toolkit CD-ROMs.</p>
		<ul>
			<li><em>Online Help</em>. The Online Help is the source of information for administrators and users after Host On-installation is complete. It provides detailed steps on how to Host On-Demand tasks. A table of contents and an index help you task-oriented help panels and conceptual help panels.  While you the Host On-Demand graphical user interface (GUI), help buttons up panel-level help panels for the GUI.</li>
			<li><em>Programming, Installing, and Configuring On-Demand</em>. Written for system administrators, this book you to plan for, install, and configure the Host On-Demand program.</li>
			<li><em>Program Directory</em>. The program instructs you on how to install Host On-Demand on the z/OS and OS/platforms.</li>
			<li><em>Readme file</em>. This file, readme.html, product information that was discovered too late to include in product documentation.</li>
			<li><em>Web Express Logon Reference</em>. This provides a step-by-step approach for understanding, implementing, and troubleshooting Web Express Logon.  It offers an overview of Express Logon, two scenario-based examples to help you plan for deploy Web Express Logon in your own environment, as well as APIs for writing customized macros and plug-ins.</li>
			<li><em>Host Printing Reference</em>. After you host sessions, use the Host Printing Reference to enable your to print their host session information to a local or LAN-printer or file.</li>
			<li><em>Session Manager API Reference</em>. This provides JavaScript APIs for managing host sessions and text-interactions with host sessions.</li>
			<li><em>Programmable Host On-Demand</em>. This provides a set of Java APIs that allows developers to integrate pieces of the Host On-Demand client code, such as terminals, menus, and toolbars, into their own custom Java applications and applets.</li>
			<li><em>Toolkit Getting Started</em>. This book how to install and configure the Host On-Demand Toolkit, which shipped with the Host Access Client Package, but is installed a different CD-ROM than the Host On-Demand base product. The On-Demand Toolkit complements the Host On-Demand base product by Java beans and other components to help you maximize the use of On-Demand in your environment.</li>
			<li><em>Host Access Beans for Java Reference</em>.This book is part of the Host On-Demand Toolkit.  It serves as a for programmers who want to customize the Host On-Demand using Java beans and create macros to automate steps in emulator sessions.</li>
			<li><em>Host Access Class Library Reference</em>. book is part of the Host On-Demand Toolkit.  It serves as a for programmers who want to write Java applets and applications can access host information at the data stream level.</li>
			<li><em>J2EE Connector Reference</em>. This book part of the Host On-Demand Toolkit.  It serves as a reference programmers who want to write applets and servlets that access 2 Enterprise Edition (J2EE) compatible applications.</li>
			<li><em>Host On-Demand Redbooks</em>. The Host On-Redbooks complement the Host On-Demand product documentation by a practical, hands-on approach to using Host On-Demand. Redbooks offered "as is" and do not always contain the very latest information. For the most up-to-date list of all Host On-Demand Redbooks, visit the Host On-Demand library page at <button href="http://www.ibm.com/software/webservers/hostondemand/library.html">http://www.ibm.com/software/webservers/hostondemand/library.html</button>.</li>
		
		</ul>
		<h2 id="wq4">Conventions used in this book</h2>
		<p>The following typographic conventions are used in the <em>Macro Programming Guide</em>:</p>
		<table id="wq5" width="100%" summary="" border="0" frame="void" rules="rows">
			<caption>Table 1. Conventions used in this book</caption>
			<thead valign="bottom">
			<tr>
				<th id="wq6" width="25%" align="left" valign="top">Convention</th>
				<th id="wq7" width="75%" align="left" valign="top">Meaning</th>
			</tr>
			</thead>
			<tbody valign="top">
				<tr>
					<td align="left" valign="top" headers="wq6"><samp class="xph">Monospace</samp></td>
					<td align="left" valign="top" headers="wq7">Indicates text you must enter a command prompt and values you must use literally, such as commands, functions, and resource definition attributes and their 	values. also indicates screen text and code examples.</td>
				</tr>
				<tr>
					<td align="left" valign="top" headers="wq6"><var class="pv">Italics</var></td>
					<td align="left" valign="top" headers="wq7">Indicates variable values you provide (for example, you supply the name of a file for <em>file_name</em>).  Italics also indicates emphasis the titles of books.</td>
				</tr>
				<tr>
					<td align="left" valign="top" headers="wq6">Return</td>
					<td align="left" valign="top" headers="wq7">Refers to the key labeled with word Return, the word Enter, or the left arrow.</td>
				</tr>
				<tr>
					<td rowspan="2" align="left" valign="top" headers="wq6"><strong>&gt;</strong></td>
					<td align="left" valign="top" headers="wq7">When used to describe a menu, a series of menu selections. For example, "Click File &gt; New" means "From the File menu, click the New command."</td>
				</tr>
				<tr>
					<td align="left" valign="top" headers="wq7">When used to describe a tree view, shows a series of folder or object expansions. For example, "HODConfig Servlet &gt; Sysplexes &gt; Plex1 &gt; J2EE Servers &gt; BBOARS2" means: 					<ol type="1">
							<li>Expand the HODConfig Servlet folder</li>
							<li>Expand the Sysplexes folder</li>
							<li>Expand the Plex1 folder</li>
							<li>Expand the J2EE Servers folder</li>
							<li>Expand the BBOARS2 folder</li>
						
						</ol>
					</td>
				</tr>
				<tr>
					<td align="left" valign="top" headers="wq6">Java</td>
					<td align="left" valign="top" headers="wq7">
						<p>In this book, Java implemented in a 1.6 and later JVM.</p></td>
				</tr>
			</tbody>
		</table>
		<p></p>
		<table id="wq9" width="100%" summary="" border="0" frame="void" rules="none">
			<tbody valign="top">
				<tr>
					<td width="33%" valign="top">
						<div class="mmobj">
							<img src="./note.gif" alt="Graphic Image">
						
						</div>
					</td>
					<td width="66%" valign="middle">This graphic is used to highlight notes the reader.</td>
				</tr>
				<tr>
					<td valign="top">
						<div class="mmobj">
							<img src="./tip.gif" alt="Graphic Image">
						</div></td>
					<td valign="middle">This graphic is used to highlight tips the reader.</td>
				</tr>
			</tbody>
		</table>


		<h1 id="part_macro_basics"> Macro basics</h1>
		<button id="intro" class="accordian">Introduction</button>
		<div class="panel" style="display:none">

			<button id="wq10" class="accordian">Host On-Demand macros</button>
			<div class="panel" style="display:none">
				<h3 id="wq11">Definition of a macro</h3>
				<p>A Host On-Demand macro is a XML script that allows a Host On-client to interact automatically with a host application running a terminal emulator session (a 3270 Display session, a 5250 session, a VT Display session, or a CICS Gateway session). A On-Demand macro is usually written to perform a specific task or of tasks involving a single host application.</p>
				<h3 id="wq12">Advantages of macros</h3>
				<p>Compared to a human operator, a macro interacts with a host more quickly and with a smaller risk of error. A macro does not that the person who runs it be trained in operating the host application.A macro can in many instances run unattended. A macro can be again and again. A macro can be copied and distributed to users. And most importantly, a macro can serve as a part of a solution to a customer requirement that involves both host and workstation applications.</p>
				<h3 id="wq13">Unsophisticated users</h3>
				<p>An unsophisticated user can create a basic macro for a tedious or time-consuming interaction with a host application. user navigates the host application to the screen at which he or wishes to start, selects the Record Macro icon, and performs a using the host application. For each application screen that the visits, Host On-Demand records an impression of the application and the user's input to the application screen. When the user back the recorded macro starting at the same application screen before, Host On-Demand recognizes each host application screen on the previously recorded impression and repeats the actions the human operator previously performed.</p>
				<h3 id="wq14">Sophisticated users</h3>
				<p>A more sophisticated user can add to or improve a recorded using the Host Access Macro Editor (Macro Editor). This tool, is available by clicking an icon on the session panel, provides graphical user interface (consisting of input fields, text boxes, checkboxes, and so on) with which a user can modify or add to each screen interaction with the host application. Besides a user to edit and enhance the macro's screen recognition and user input, the Macro Editor provides features that allow a to add more intelligent behavior to the macro, such as choosing alternate paths through an application, skipping a screen that not be processed, or backing up to a previous screen. And there more powerful capabilities including the ability to read and data from the session screen, to notify the operator of status, prompt the operator for an important decision, to download or files from the host, and to automate the printing of application screens.</p>
				<h3 id="wq15">Programming features</h3>
				<p>The Macro Editor also provides programming features. A user programming experience can add functionality to a Host On-Demand by creating and manipulating variables, using arithmetic and expressions, writing if-then-else conditions, chaining to macro, calling Java methods stored in external Java libraries, native applications, and writing trace information.</p>
				<p>The Code Editor, a text editor that is launched from the Editor, allows the user to view and modify the XML elements that up the macro script, and also to cut and paste text through the clipboard.</p>
				<h3 id="wq16">Samples</h3>
				<p>This book contains macro code samples throughout. The chapter <button onclick="scrollHere('ms1_sample')">Sample macro code</button> contains an example of a macro that reads from a sample CICS database and writes them into a Microsoft spreadsheet.</p>
			</div>

			<button id="wq17" class="accordian">Deploying macros</button>
			<div class="panel" style="display:none">
				<p>The Host On-Demand Deployment Wizard includes that enable system administrators to deploy macros to users in libraries located at Web locations or on LAN or DVD-ROM drives.</p>
				<p>For more information see "Creating and deploying server macro libraries" in the document <em>Planning, Installing, and Host On-Demand</em>.</p>
				<p>A local user can save a macro in any location where they have write-access.</p>
			</div>

			<button id="wq18" class="accordian">Using macros to integrate your enterprise applications</button>
			<div class="panel" style="display:none">
				<p>You can use Host On-Demand macros to integrate your Telnet-applications with your workstation applications. Macros provide path for data to flow into or out of your Telnet-accessible applications.</p>
				<p>Host On-Demand includes two programming interfaces that allow to drive macros:</p>
				<ul>
					<li>Programmable Host On-Demand <p>This is a set of Java APIs allows developers to integrate various pieces of the Host On-client code, such as terminals, menus, and toolbars, into their custom Java applications and applets.</p>
						<p>For more see the document <em>Programmable Host On-Demand </em> the Host On-Demand documentation.</p>
					</li>
					<li>Session Manager <p>Session Manager APIs are JavaScript for managing host sessions and text-based interactions with host sessions.</p>
						<p>more information see the document <em>Session API Reference</em> in the Host On-Demand documentation.</p>
					</li>
				
				</ul>
			</div>

			<button id="wq19" class="accordian">Host Access Toolkit</button>
			<div class="panel" style="display:none">
				<p>The Host Access Toolkit is a separate product that provides control of the Host On-Demand client and other features, Java APIs for launching and interacting with Host On-Demand macros.</p>
			</div>

			<button id="introsecurity" class="accordian">Macros and security</button>
			<div class="panel" style="display:none">
				<p>Because a macro is an easily transportable, unencrypted, text-representation of interactions between a user and a host application, you should consider protecting your macros as valuable pieces of property.</p>
				<p>In particular, you should consider not storing unencrypted or other sensitive data in a macro script. Instead: </p>
				<ul>
					<li>You can design the macro so that it obtains sensitive from an outside source, for example by prompting the user for a or by obtaining data from a host or local application.</li>
					<li>You can use the following features for encrypting input: 			<ul>
							<li>The Password field of the FileUpload action (see <button onclick="scrollHere('ma_fu_uid')">User ID and Password</button>).</li>
							<li>The Password checkbox of the Input action (see <button onclick="scrollHere('ma_input_password')">Password</button>).</li>
							<li>The Password Response listbox of the Prompt action (see <button onclick="scrollHere('ma_prompt_password_response')">Password Response</button>).</li>
							<li>The Password field of the SQLQuery action (see <button onclick="scrollHere('ma_sql_uid')">User ID and Password</button>).</li>
							<li>The Record Password option (enabled by default) (see <button onclick="scrollHere('msec_recordpassword')">Record password</button>).</li>
						
						</ul>
					</li>
				
				</ul>
			</div>
			
			<button id="abouthisdocument" class="accordian">This book focuses on 3270 applications</button>
			<div class="panel" style="display:none">
				<p>Although macros can be used with 3270 Display sessions, with Display sessions, with VT Display sessions, and with CICS sessions, this book focuses almost entirely on 3270 Display and 3270 host applications.</p>
			</div>
		</div>

		<button id="mc_concepts" class="accordian">Macro components</button>
			<div class="panel" style="display:none">

			<button id="wq20" class="accordian">Overview</button>
			<div class="panel" style="display:none">
				<p>This chapter describes the components that you will encounter you use the macro capabilities of Host On-Demand. Here is an of the main components:</p>
				<ul>
				<li><strong>Macro Manager</strong>. This a broad term that to all the user interfaces in Host On-Demand that allow you to with macros. The Macro Manager consists of three main user interfaces: 	
					<ul>
						<li>Macro Manager toolbar. This is a toolbar with icons for used macro functions, such as Record a Macro, Play Macro, Edit Properties, and others. See <button onclick="scrollHere('mc1_mm_toolbar')">Macro Manager toolbar</button> in chapter.</li>
						<li>Macro Editor. This is the main user interface for editing a script. See <button onclick="scrollHere('mc1_macro_editor')">Macro Editor</button> in this chapter.</li>
						<li>Code Editor. This is a text editor that you lets you edit the XML language of a macro script. See <button onclick="scrollHere('mc1_code_editor')">Code Editor</button> in this chapter.</li>
					</ul>
				</li>
					<li><strong>Macro runtime</strong>. This is the program that plays macros. See <button onclick="scrollHere('mc1_macro_runtime')">Macro runtime</button>.</li>
					<li><strong>Macro object</strong>. This is the underlying object that provides macro capabilities. See <button onclick="scrollHere('mc1_macro_object')">Macro object</button>.</li>
				
				</ul>
				<p>The remaining sections of this chapter describe these in more detail. The final section of this chapter defines other terms that you might encounter in this book.</p>
			</div>

			<button id="wq21" class="accordian">Macro Manager</button>
			<div class="panel" style="display:none">
				<p>The Macro Manager is the umbrella term for all the macro user interfaces.There are three main interfaces: the Macro Manager toolbar, the Editor, and the Code Editor.</p>
				<h3 id="mc1_mm_toolbar">Macro Manager toolbar</h3>
				<p>The Macro Manager toolbar is a toolbar that contains icons common macro operations. All of these icons can be used by macro developers, while at least one of the icons is also for users of macros (the macro icon). <button onclick="scrollHere('mc_fig_mm_toolbar')">Figure 1</button> shows the Macro toolbar. (For the purpose of illustration, this figure is in one respect: it shows all the buttons on the toolbar enabled the same time.) </p>
				<div class="fignone" id="mc_fig_mm_toolbar"><span class="figcap">Figure 1. Macro Manager toolbar</span>
					<div class="mmobj">
						<img src="./mb_mmtoolbar.gif" alt="">
					
					</div>
				
				</div>
				<p class="indatacontent">To view the Macro Manager toolbar follow these steps:</p>
				<ol type="1">
					<li>Start a Host On-Demand client.</li>
					<li>Start a terminal emulator session (3270 Display session, Display session, VT session, or CICS Gateway session).</li>
					<li>Click View &gt; Macro Manager</li>
				
				</ol>
				<p class="indatacontent">Depending on your company's configuration of the display session, you might notice that a few of the icons on the Macro Manager also appear on the main toolbar. This placement is for extra and should not cause you any concern. The icons work the same no which toolbar they appear on.</p>
				<p>Here is a quick summary of the function of each part of the Manager toolbar, from left to right. You will learn more about of these functions later in the book.</p>
				<ul>
					<li>Currently selected macro. This white text field at the left of the toolbar is not an input field but a text field in which Macro Manager displays the name of the currently selected macro. the currently selected macro is ispf_usp.mac.</li>
					<li>Select a macro. This icon is the big downward-pointing arrowhead.Click this icon to select a current macro for playing, editing, copying, or deleting.</li>
					<li>Edit current macro properties. Click this icon to bring up Macro Edito (see <button onclick="scrollHere('mc1_macro_editor')">Macro Editor</button>).</li>
					<li>Delete current macro from list. Click this icon to delete currently selected macro.</li>
					<li>Play macro. Click this icon to play the currently selected macro.</li>
					<li>Record macro. Click this icon to record a new macro.</li>
					<li>Stop playing or recording macro. Click this icon to end or recording a macro.</li>
					<li>Pause playing or recording macro. Click this icon to suspend the playing or recording of a macro.</li>
					<li>Append recording. Click this icon to select an active as the current source of recorded material (see <button onclick="scrollHere('ms_recording')">Recording a macro that interacts with more than one session</button>).</li>
					<li>Add a prompt.</li>
					<li>Add a Smart Wait.</li>
					<li>Add an Extraction.</li>
				
				</ul>
				<p>To step through the process of recording and playing back a macro, see <button onclick="scrollHere('mx_record_and_playback')">Recording and playing back a simple macro</button>.</p>
				<h3 id="mc1_macro_editor">Macro Editor</h3>
				<p>The Macro Editor (the full name is the Host Access Macro Editor) is a graphical user interface (with buttons, input fields, list boxes, and so on) for editing the parts of a macro. <button onclick="scrollHere('mc_fig_macro_editor')">Figure 2</button> shows the Macro Editor. </p>
				<div class="fignone" id="mc_fig_macro_editor"><span class="figcap">Figure 2. Macro Editor</span>
					<div class="mmobj">
						<img src="./mb_hame_macro_tab.gif" alt="">
					
					</div>
				
				</div>
				<p>You will probably use the Macro Editor for most of your macro development.It is more powerful (in terms of managing data more easily) than Code Editor described in the next subsection, although it cannot everything that the Code Editor can do.</p>
				<p>To bring up the Macro Editor go to the Macro Manager toolbar.</p>
				<ol type="1">
					<li>Click the Select a macro icon to select a macro to edit.</li>
					<li>Click the Edit current macro properties icon to edit the with the Macro Editor.</li>
				
				</ol>
				<h3 id="mc1_code_editor">Code Editor</h3>
				<p>Both the Macro Editor and the Code editor edit macros. Both read from and write to the same type of underlying macro source, XML script. However, each tool is better for certain tasks.</p>
				<p>The Macro Editor provides a graphical user interface that is and user-friendly. It is the superior tool for creating and macros.</p>
				<p>On the other hand, the Code Editor provides a text editor that allows you to edit directly the XML elements of which a is made. <button onclick="scrollHere('mc_fig_code_editor')">Figure 3</button> shows the Code Editor a macro script.</p>
				<div class="fignone" id="mc_fig_code_editor"><span class="figcap">Figure 3. Code Editor</span>
					<div class="mmobj">
						<img src="./mb_ece_s1.gif" alt="">
					
					</div>
				
				</div>
				<p>You should use the Code Editor for more technical editing tasks, such as:</p>
				<ul>
					<li>Modifying a few attributes of the XML elements that the Editor does not provide access to.</li>
					<li>Looking at the XML elements to check your understanding of a macro will execute.</li>
					<li>Debugging a macro.</li>
					<li>Cutting and pasting XML code from other sources using the clipboard.</li>
				
				</ul>
				<p>To bring up the Code Editor:</p>
				<ol type="1">
					<li>Use the Macro Editor to open the file that you want to edit.</li>
					<li>Click Code Editor in the row of buttons at the bottom of the Editor window.</li>
				
				</ol>
			</div>

			<button id="mc1_macro_runtime" class="accordian">Macro runtime</button>
			<div class="panel" style="display:none">
				<p>The macro runtime is the program module that plays back a when a user clicks the Play Macro icon. Specifically, the macro reads the contents of the current macro script and generates the playback.</p>
			</div>

			<button id="mc1_macro_object" class="accordian">Macro object</button>
			<div class="panel" style="display:none">
				<p>The Macro object is the Java instance that provides the underlying the Macro Manager Toolbar, the Macro Editor, the Code Editor, and the macro runtime.</p>
				<p>The IBM Host Access Toolkit, a separately purchased product, programming access to the Macro object through the many methods the Macro class. This book does not describe how to use IBM Host Toolkit.</p>
			</div>

			<button id="mc1_other_terms" class="accordian">Definitions of other terms</button>
			<div class="panel" style="display:none">
				<p>Here are the definitions of a few other terms that you will in this book.</p>
				<table id="wq25" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 2. Definitions of terms</caption>
					<tbody valign="top">
						<tr>
							<td width="27%">action</td>
							<td width="72%">An action is an instruction that specifies activity that the macro runtime is to perform when it plays back macro (such as sending a sequence of keys to the session window, a prompt in a popup window, capturing a block of text from the screen, and other actions). You can edit or create actions in the Macro Editor.You can view and modify individual action elements in the Code Editor.See <button onclick="scrollHere('ma_actions_part1')">Macro actions</button>.</td>
						</tr>
						<tr>
							<td>application screen</td>
							<td>An application screen is a meaningful of characters displayed on the Host On-Demand session window by host application. See <button onclick="scrollHere('mc_application_screen')">Application screen</button>.</td>
						</tr>
						<tr>
							<td>descriptor</td>
							<td>A descriptor is an instruction that one characteristic of an application screen. You can edit or descriptors in the Macro Editor. You can view and modify descriptor elements in the Code Editor. See <button onclick="scrollHere('md1_description_tab')">Introduction to the Description tab</button>.</td>
						</tr>
						<tr>
							<td>macro screen</td>
							<td>A macro screen is a set of instructions tells the macro runtime how to manage a particular visit to a application screen. See <button onclick="scrollHere('mc2_macro_screen')">Macro screen</button>.</td>
						</tr>
						<tr>
							<td>macro script</td>
							<td>A macro script is an XML script in which a is stored. You can edit a macro script directly using the Code or indirectly using the Macro Editor. When you play a macro, the runtime executes the instructions in the script. See <button onclick="scrollHere('mc2_macro_script')">Macro script</button>.</td>
						</tr>
						<tr>
							<td>valid next screen</td>
							<td>A valid next screen is a macro screen that, during macro playback, is a valid candidate to be the next macro to be processed. See <button onclick="scrollHere('mc3_valid_next_screens')">Closer look at stage 1</button>.</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>

		<button id="mx_record_and_playback" class="accordian">Recording and playing back a simple macro</button>
		<div class="panel" style="display:none">
			<p>The purpose of this chapter is to give you a hands-on to the Macro Manager by stepping through three basic tasks:</p>
			<ul>
				<li>Recording a simple macro.</li>
				<li>Playing back the recorded macro.</li>
				<li>Assigning the playback of the macro to a particular key combination.</li>
			
			</ul>
			<p class="indatacontent">You can follow these same steps yourself by starting a Host On-3270 Display session, connecting to an MVS system, and logging to TSO. The ISPF Primary Option Menu is the first application to appear after you log on (see <button onclick="scrollHere('mx_fig_ispf_pom')">Figure 5</button>).</p>
			<p> Be sure to get permission from your systems administrator doing this, and have an experienced ISPF user sitting next to you, if necessary.</p>
			

			<button id="mx_recording" class="accordian">Recording a simple macro</button>
			<div class="panel" style="display:none">
				<p>This section shows you how to record a very simple macro. macro changes the application screen from the ISPF Primary Menu to the Data Set List Utility screen (passing through the Selection Panel screen on the way).</p>
				<p>Before recording this macro, assure that:</p>
				<ul>
					<li>The ISPF Primary Option Menu is displayed on the session window.See <button onclick="scrollHere('mx_fig_ispf_pom')">Figure 5</button>.</li>
					<li>The Macro Manager toolbar is displayed above the session window. <button onclick="scrollHere('mx_fig_mm_toolbar')">Figure 4</button> shows the Macro Manager toolbar (this the same illustration that is displayed in <button onclick="scrollHere('mc_fig_mm_toolbar')">Figure 1</button>).
						<div class="fignone" id="mx_fig_mm_toolbar"><span class="figcap">Figure 4. Macro Manager toolbar</span>
							<div class="mmobj">
								<img src="./mx_fig_mm_toolbar.gif" alt="">
							
							</div>
						
						</div>
					<p>If the Macro Manager toolbar is not displayed on your system, click View &gt; Macro Manager.</p>
				</li>
				
				</ul>
				<p class="indatacontent">For more information on the Macro Manager toolbar, see <button onclick="scrollHere('mc1_mm_toolbar')">Macro Manager toolbar</button>.</p>
				<p>To record the macro follow these steps:</p>
				<ol type="1">
					<li>Is TSO displaying the ISPF Primary Options screen? If not, go to the ISPF Primary Options screen. See <button onclick="scrollHere('mx_fig_ispf_pom')">Figure 5</button>.</li>
					<li>Click the Record macro icon to start recording. (This icon a single dot over an image of a cassette.)</li>
					<li>The Record Macro window appears. Follow these steps: 			<ol type="a">
							<li>Select a macro location, such as Personal Library</li>
							<li>Click New.</li>
							<li>Type a name in the Name field, such as <samp class="xph">ispf_ex1</samp> (names are case-sensitive).</li>
							<li>Type a description in the Description field, such as <samp class="xph">macro</samp>.</li>
							<li>Click OK.</li>
							<li>The Record Macro window disappears.</li>
						
						</ol>
					</li>
					<li>The ISPF Primary Option Panel is still displayed. See <button onclick="scrollHere('mx_fig_ispf_pom')">Figure 5</button>.  			<div class="fignone" id="mx_fig_ispf_pom"><span class="figcap">Figure 5. The ISPF Primary Option Menu</span>
							<div class="mmobj">
								<img src="./mb_ispf_pom1.gif" alt="">
							
							</div>
						
						</div>In the figure above, Host On-Demand is displaying the screen and waiting for user input in the same way that it always does.But at the same time, the Macro object is waiting to record the input when it occurs. There are two visual cues in the figure that show that a macro is being recorded: 			<ul>
							<li>In the status line at the bottom of the session panel is the message Recording macro.</li>
							<li>On the Macro Manager toolbar the five icons on the right are (Stop Macro, Pause Macro, and the three Add-A icons), while the icons on the left are temporarily disabled. See <button onclick="scrollHere('mx_fig_ispf_pom')">Figure 5</button>.</li>
						
						</ul>
					</li>
					<li>Click on the Option line near the top of the application screen.The Option line is the fourth line of the ISPF Primary Options and begins at the left side of the screen with the label<samp class="xph"> ===&gt;</samp>. You should see the text cursor appear at the that you clicked. Is the cursor displayed on the Option line? If not, then click again.</li>
					<li>Type 3 and the enter key. As the figure above shows, 3 is selection for Utilities.</li>
					<li>The application screen changes to the Utility Selection Panel.See <button onclick="scrollHere('mx_fig_ispf_usp1')">Figure 6</button>.
						<div class="fignone" id="mx_fig_ispf_usp1"><span class="figcap">Figure 6. The Utility Selection Panel application screen</span>
							<div class="mmobj">
								<img src="./mb_ispf_usp1.gif" alt="">
							
							</div>
						
						</div>In the figure above, ISPF has automatically placed the cursor on the Option line of this menu. On your screen, is the cursor on the Option line? If not then click on the Option line move the text cursor there.
					</li>
					<li>Type 4 followed by the enter key. As the figure above shows, is the selection for Dslist.</li>
					<li>The application screen changes to the Data Set List Utility. See <button onclick="scrollHere('mx_fig_ispf_dslu1')">Figure 7</button>.
						<div class="fignone" id="mx_fig_ispf_dslu1"><span class="figcap">Figure 7. The Utility Selection Panel application screen</span>
							<div class="mmobj">
								<img src="./mb_ispf_dslu1.gif" alt="">
							
							</div>
						
						</div>
					</li>
					<li>Click the Stop playing or recording macro icon to stop recording.This icon is the one that displays a black square with the image a cassette below it. The five icons on the right side of the Manager toolbar become disabled, and the five icons on the left become enabled.</li>
					<li>Recording is complete. The Data Set List Utility screen is displayed, as in <button onclick="scrollHere('mx_fig_ispf_dslu1')">Figure 7</button>.</li>
				
				</ol>
				<p>Some observations:</p>
				<ul>
					<li>You clicked the Record macro icon to start recording.</li>
					<li>You entered input (a mouse click and some keystrokes) just you normally would when using the application, and the host application, ISPF, displayed the application screens and responded to the input as it normally does.</li>
					<li>The Macro object recorded the application screens (or rather, a few identifying characteristics of each application screen) recorded the mouse clicks and keystrokes as you entered them.</li>
					<li>You clicked the Stop recording or playing macro icon to stop the macro.</li>
				</ul>
				<p>You can record interactions with more than one session into same macro. This is an advanced feature (see <button onclick="scrollHere('ms_multisession')">Interacting with more than one session</button>).</p>
			</div>

			<button id="g1_playback" class="accordian">Playing back a simple macro</button>
			<div class="panel" style="display:none">
				<p>This section shows how to play back the macro that you just recorded.Before you start, go back to ISPF Primary Option Menu. This is starting point for this macro.</p>
				<ol type="1">
					<li>Verify that the application screen is the ISPF Primary Menu. See <button onclick="scrollHere('mx_fig_ispf_pom')">Figure 5</button>.</li>
					<li>Select a macro to run. If you have just recorded the macro in this example, then the name of the macro is displayed in the selected macro field (the white text field on the left of the Manager toolbar.) If not, then follow these steps to make that the currently selected macro: 			<ul>
							<li>On the Macro Manager toolbar click Select a Macro. This icon the large downward-pointing arrowhead.</li>
							<li>The Available Macros window appears.</li>
							<li>Under Macro Location click the location of the macro, such Personal Library.</li>
							<li>Under Macro List, click the name, such as <samp class="xph">ispf_ex1.mac</samp>, that you assigned to the macro recorded in the previous section this chapter.</li>
							<li>Click OK</li>
						</ul>
					</li>
					<li>Verify that the name of the macro that you want to run is as the currently selected macro.</li>
					<li>Play the selected macro by clicking the Play macro icon. (icon displays a small rightward-pointing arrowhead over the of a cassette).</li>
					<li>You should see the application screen change quickly to the Selection Panel screen and then to the Data Set List Utility screen.Also, during the playback the icons on the left side of the Manager toolbar are briefly disabled. After the playback is these icons are re-enabled.</li>
					<li>Playback is complete.</li>
				</ol>
				<p>Some observations:</p>
				<ul>
					<li>You had to position the application to a particular screen before playing the macro. As is almost always the case a simple macro, the starting point for playing back the macro is point at which you started recording the macro. After all, this input makes sense only in a certain context, the context in it was recorded.</li>
					<li>You played the macro by: 			<ul>
							<li>Clicking the Select a macro icon and then selecting a macro.</li>
							<li>Clicking Play macro to play the selected macro.</li>
						</ul>
					</li>
					<li>While the macro played, the Macro runtime re-created the click and keystrokes that it recorded earlier. The application as it normally does. The application could not tell the between a human entering input and the Macro runtime entering during playback.</li>
					<li>By playing back the macro, you were able to accomplish the of moving from one ISPF menu through another to a third menu and accurately.</li>
				</ul>
			</div>


			<button id="wq29" class="accordian">Assigning the macro to a key combination</button>
			<div class="panel" style="display:none">
				<p>Host On-Demand allows you to assign a macro to a particular combination. To assign the macro that you just recorded to a combination, follow these steps:</p>
				<ol type="1">
					<li>Click Edit &gt; Preferences &gt; Keyboard. The Keyboard window appears.</li>
					<li>Click the Key Assignment tab.</li>
					<li>In the Category listbox select Macros.</li>
					<li>In the list of macros select the name of the macro to which want to assign a key, such as <samp class="xph"> ispf_ex1.mac </samp>.</li>
					<li>Click Assign a Key. The message Press a key is displayed.</li>
					<li>Type Ctrl+i. After you type this key sequence, the label Ctrl+is displayed beside the macro name.</li>
					<li>Click Save to save this assignment.</li>
					<li>Click OK to close the Keyboard window.</li>
				</ol>
				<p>To play back the macro using the assigned key combination, these steps:</p>
				<ol type="1">
					<li>Position the application to the starting point for this macro, which is the ISPF Primary Option Menu.</li>
					<li>Press Ctrl+i.</li>
					<li>The macro is played back.</li>
				</ol>
			</div>
		</div>

		<button id="mc2_concepts" class="accordian">Macro structure</button>
		<div class="panel" style="display:none">
			<p>This chapter has two purposes, first to describe the general of a macro as it can be seen in an XML macro script, and second show some of the connections between the Macro Editor and XML elements in the macro script.</p>
			<ul>
				<li><button onclick="scrollHere('mc2_macro_script')">Macro script</button> describes the &lt;HAScript&gt; and its connections with the Macro tab of the Macro Editor.</li>
				<li><button onclick="scrollHere('mc2_macro_screen_group')">The macro screen and its subcomponents</button> describes the &lt;screen&gt; element and its connections with the Screens tab of the Macro Editor.</li>
			</ul>


			<button id="mc2_macro_script" class="accordian">Macro script</button>
			<div class="panel" style="display:none">
				<p>A macro script is an XML script used to store a Host On-macro. You can view and edit the XML text of a macro script by the Code Editor (shown in <button onclick="scrollHere('mc1_code_editor')">Code Editor</button>). The Editor displays the same information that you see in the Code Editor, but the Macro Editor displays the information in a more user-format, using listboxes, checkboxes, input fields, and the other of the graphical user interface (see <button onclick="scrollHere('mc1_macro_editor')">Macro Editor</button>).</p>
				<p>Learning a little about the XML elements of the macro will greatly increase your understanding of important topics, the following:</p>
				<ul>
					<li>How to use the Macro Editor.</li>
					<li>How macro playback works.</li>
					<li>How to build effective macros.</li>
				</ul>
				<p>Therefore this book frequently refers not only to the input fields, buttons, and listboxes of the Macro Editor but also to the XML elements in which the same information is stored.</p>
				<h3 id="wq32">XML elements</h3>
				<p>To understand macro scripts you do not need to learn a great about XML, just the basics of the syntax. If your knowledge of syntax needs brushing up, you can learn more about it in <button onclick="scrollHere('ml1_macro_syntax')">XML syntax in the Host On-Demand macro language</button>. However, almost all of what you need know is covered in this subsection.</p>
				<p>As you probably know already, an XML script consists of a of XML elements, some of which contain other XML elements, in the same way that some HTML elements contain other HTML elements.However, unlike HTML, XML allows a program developer to define XML elements that reflect the structure of the information that developer wishes to store. The Host On-Demand macro language approximately 35 different types of XML elements for storing the needed to describe a macro. This macro language is described at in <button onclick="scrollHere('part_langref')">The macro language</button>.</p>
				<p>This book, when referring to an XML macro element, uses the name enclosed in angle brackets. Examples: &lt;HAScript&gt; element, &lt;screen&gt; element.</p>
				<p><button onclick="scrollHere('mc2_fig_sample_element')">Figure 8</button> shows an example of an element:</p>
				<div class="fignone" id="mc2_fig_sample_element"><span class="figcap">Figure 8. Sample XML element</span>
					<pre class="xmp"><code>&lt;SampleElement attribute1="value1" attribute2="value2"&gt; ...&lt;/SampleElement&gt;</code></pre>
				</div>
				<p class="indatacontent">The &lt;SampleElement&gt; element shown in the figure above the key components of every macro element. The first line is the tag. It consists of a left angle bracket (&lt;), followed by the of the XML element (SampleElement), followed by attribute definitions, followed by a right angle bracket (&gt;). The second line consists an ellipsis (...) that is not part of XML syntax but is used in figure above to indicate the possible presence of other elements the &lt;SampleElement&gt; element. The third line is the end tag. contains the name of the element enclosed in angle brackets with forward slash after the first angle bracket (&lt;/Sample Element&gt;).</p>
				<p>In the begin tag, the attributes are specified by using the name (such as attribute1), followed by an equals sign (=), by an attribute value enclosed in quotation marks (such as "value1").Any number of attributes can occur in the begin tag.</p>
				<p>If the macro element does not contain other XML elements then can be written in the shorthand fashion shown in <button onclick="scrollHere('mc2_fig_sample2')">Figure 9</button>:</p>
				<div class="fignone" id="mc2_fig_sample2"><span class="figcap">Figure 9. Sample XML element written in the shorthand format</span>
					<pre class="xmp"><code>&lt;SampleElement attribute1="value1" attribute2="value2"  /&gt;</code></pre>
				</div>
				<p class="indatacontent">In the figure above the &lt;SampleElement&gt; element is with a left angle bracket (&lt;) followed by the name (SampleElement), followed by the attributes, followed by a forward slash and a angle bracket (/&gt;). Thus the entire XML element is written a single pair of angle brackets.</p>
				<h3 id="mc2_conceptual_view_macro_script">Conceptual view of a macro script</h3>
				<p>A macro script consists of a single &lt;HAScript&gt; element can contain up to three major types of subelements:</p>
				<ul>
					<li>One &lt;import&gt; element. (Optional)</li>
					<li>One &lt;vars&gt; element. (Optional)</li>
					<li>One or more &lt;screen&gt; elements.</li>
				</ul>
				<p><button onclick="scrollHere('mc2_hascript_concept')">Figure 10</button> shows a conceptual view a sample macro script containing three &lt;screen&gt; elements.</p>
				<div class="fignone" id="mc2_hascript_concept"><span class="figcap">Figure 10. Conceptual view of a macro script</span>
					<div class="mmobj">
						<img src="./mb_hascript_concept.gif" alt="">
					</div>
				</div>
				<p class="indatacontent">The figure above shows an &lt;HAScript&gt; element (HAScript) contains instances of the major types of subelements: an &lt;import&gt; element (Import), a &lt;vars&gt; element (Variables), and three &lt;screen&gt; elements (Screen1, Screen2, and Screen3).</p>
				<p>All macro scripts are structured like this, except that most more screens. If there were 50 screens in the above macro, then diagram above would look much the same, except that after there would be additional screens: Screen4, Screen5, and so on, to Screen50. (However, the order in which the screens are stored not necessarily represent the order in which the screens are when the macro is played.)</p>
				<p>The &lt;HAScript&gt; element is the master element of a macro script.(HAScript stands for Host Access Script.) It encloses the entire and also contains, in its begin tag, attributes that contain applicable to the entire macro, such as the macro's name. For an of an &lt;HAScript&gt; element see <button onclick="scrollHere('mc2_fig_sample_hascript')">Figure 12</button>.</p>
				<p>The &lt;import&gt; element is used to import Java classes and is optional.Importing Java classes is an advanced topic that is not until <button onclick="scrollHere('mv_variables_imported')">Creating an imported type for a Java class</button>.</p>
				<p>The &lt;vars&gt; element is used to declare and initialize belonging to one of the standard data types (boolean, integer, double, string, or field). Using standard variables is an advanced topic is not discussed until <button onclick="scrollHere('mv_variables')">Variables and imported Java classes</button>.</p>
				<p>The &lt;screen&gt; element is used to define a macro screen. The &lt;screen&gt; element is the most important of the elements that occur inside the &lt;HAScript&gt;.As you can see in <button onclick="scrollHere('mc2_hascript_concept')">Figure 10</button> above, a script is composed mostly of &lt;screen&gt; elements (such as Screen1, Screen2, and Screen3 in the figure). Also, most of the other of XML elements in a macro script occur somewhere inside a &lt;screen&gt; element.</p>
				<h3 id="wq33">Introduction to the Macro tab</h3>
				<p>For the purpose of getting you acquainted with the Macro Editor, this section consists of a very simple comparison between the tab of the Macro Editor and the &lt;HAScript&gt; element described the previous section.</p>
				<p>The Macro Editor has four tabs: Macro, Screens, Links, and Variables.The first tab, the Macro tab, corresponds very closely to the &lt;HAScript&gt; element. In fact, the Macro tab is the graphical user interface some of the information that is stored in the attributes of the tag of the &lt;HAScript&gt; element.</p>
				<p>Therefore, as the &lt;HAScript&gt; element is the master element a macro script and contains in its attributes information that to the entire macro (such as the macro name), similarly the tab is the first tab of the Macro Editor and provides access to of the same global information.</p>
				<p> <button onclick="scrollHere('mc2_hame_macro_tab')">Figure 11</button> shows the Macro Editor the Macro tab selected.</p>
				<div class="fignone" id="mc2_hame_macro_tab"><span class="figcap">Figure 11. Macro tab of the Macro Editor</span>
					<div class="mmobj">
						<img src="./mc2_hame_macro_tab.gif" alt="">
					</div>
				</div>
				<p class="indatacontent">In the figure above you can see that the Macro tab has fields for Macro Name, Description, and other information, along several checkboxes. You should notice two fields:</p>
				<ul>
					<li>The Macro Name field contains the name that you assign to macro. This is the same name that you will select when you want edit the macro or run the macro. Macro names are case-sensitive. example, <samp class="xph">ispf_usp</samp> is a different name than <samp class="xph">Ispf_usp, ispf_usP, ISPF_USP</samp>, and so on.</li>
					<li>The Use Variables and Arithmetic Expressions In Macro determines whether the Macro object uses the basic macro format the advanced macro format for this macro. In the figure above checkbox is not selected, indicating that the basic macro format be used (see <button onclick="scrollHere('me_choosing_a_format')">Choosing a macro format</button>).</li>
				</ul>
				<p><button onclick="scrollHere('mc2_fig_sample_hascript')">Figure 12</button> shows a sample &lt;HAScript&gt; element that contains the same information as is shown on the tab in <button onclick="scrollHere('mc2_hame_macro_tab')">Figure 11</button> , as well as some information. In the Code Editor an &lt;HAScript&gt; element is on a single line, but here the element is written on multiple so that you can see the attributes.</p>
				<div class="figrules" id="mc2_fig_sample_hascript"><span class="figcap">Figure 12. A sample &lt;HAScript&gt; element</span>
					<pre class="xmp"><code>&lt;     name="ispf_ex1"      description=" "      timeout="60000"      pausetime="300"      promptall="true"      author=""      creationdate=""      supressclearevents="false"      usevars="false"      ignorepauseforenhancedtn="false"      delayifnotenhancedtn="0"&gt; ... &lt;/HAScript&gt;</code></pre>
				</div>
				<p class="indatacontent">In the &lt;HAScript&gt; element in the figure above you notice that there is an attribute corresponding to each input of the Macro tab shown in <button onclick="scrollHere('mc2_hame_macro_tab')">Figure 11</button>. For example, the <strong>name</strong> attribute in the &lt;HAScript&gt; (<samp class="xph">name="ispf_ex1"</samp>) corresponds to the Macro Name field the Macro tab. Similarly, the <strong>usevars </strong> in the &lt;HAScript&gt; element (<samp class="xph">usevars="false"</samp>) to the Use Variables and Arithmetic Expressions checkbox on the tab.</p>
			</div>

			<button id="mc2_macro_screen_group" class="accordian">The macro screen and its subcomponents</button>
			<div class="panel" style="display:none">
				<p>This section describes the macro screen and its major subcomponents.The definition of macro screen depends on another term that defining, application screen.</p>
				<h3 id="mc_application_screen">Application screen</h3>
				<p>An application screen is a meaningful arrangement of displayed on the Host On-Demand session window by a host application.</p>
				<p>As you probably realize, you are already very familiar with concept of an application screen. An example of an application is the ISPF Primary Option Menu, which is displayed in <button onclick="scrollHere('mc_fig_appl_screen')">Figure 13</button>. (This same application screen is in <button onclick="scrollHere('mx_fig_ispf_pom')">Figure 5</button>.)</p>
				<div class="fignone" id="mc_fig_appl_screen"><span class="figcap">Figure 13. A sample application screen, the ISPF Primary Option Menu</span>
					<div class="mmobj">
						<img src="./mc_fig_appl_screen.gif" alt="">
					</div>
				</div>
				<p class="indatacontent">In the figure above you can see that this application has menu selections displayed in a row across the top (<samp class="xph">Menu</samp>, <samp class="xph">Utilities</samp>, <samp class="xph">Compilers</samp>, <samp class="xph">Options</samp>, and so on), function key assignments displayed in a row across bottom (<samp class="xph">F1=Help, F2=Split</samp>, and so on), a title near top (<samp class="xph">ISPF Primary Option Menu</samp>), a list of options the left side (<samp class="xph">0</samp> through <samp class="xph">V</samp>), and an input in which to type an option number or letter (<samp class="xph">Option ===&gt;</samp>).When the user provides input, for example by typing a 3 (for Utilities) followed by the enter key, the ISPF application removes all visible items from the session window and displays a different screen.</p>
				<h3 id="mc2_macro_screen">Macro screen</h3>
				<p>A macro screen is a set of instructions that tell the macro how to manage a visit to a particular application screen. A screen includes:</p>
				<ul>
					<li>A description of a particular application screen.</li>
					<li>The actions to take when visiting this particular screen.</li>
					<li>A list of the macro screens that can validly occur after particular application screen.</li>
				</ul>
				<p>Although the concept is not very intuitive at this point, might be in the same macro several macro screens that refer to same application screen. Because of the way macro screens are to one another, the macro runtime might visit the same screen several times during macro playback, processing a macro screen at each visit.</p>
				<p>Also, one macro screen might refer to more than one screen. When several application screens are similar to each other, a macro developer might build a macro screen that handles all of similar application screens.</p>
				<p>Nevertheless, each macro screen corresponds to some screen. When you record a macro, the Macro object creates and a macro screen for each application screen that you visit during course of the recording. If you visit the same application more than once, the Macro object creates and stores a macro for each visit. Similarly, when you play back a recorded macro, macro runtime processes a single macro screen for each screen that it visits during the course of the playback.</p>
				<h3 id="mc2_macro_screen_conceptual">Conceptual view of a macro screen</h3>
				<p>A macro screen consists of a single &lt;screen&gt; element that three required subelements:</p>
				<ul>
					<li>One &lt;description&gt; element. (Required)</li>
					<li>One &lt;actions&gt; element. (Required)</li>
					<li>One &lt;nextscreens&gt; element. (Required, except in an Exit Screen)</li>
				</ul>
				<p class="indatacontent">Each of the subelements is required, and only one of each occur.</p>
				<p><button onclick="scrollHere('mc2_fig_screen_concept')">Figure 14</button> shows a conceptual view a &lt;screen&gt; element:</p>
				<div class="fignone" id="mc2_fig_screen_concept"><span class="figcap">Figure 14. Conceptual view of a &lt;screen&gt; element</span>
					<div class="mmobj">
						<img src="./mb_screen_concept.gif" alt="">
					</div>
				</div>
				<p class="indatacontent">The figure above shows a &lt;screen&gt; element (Screen1) contains the three required subelements: a &lt;description&gt; (Description), an &lt;actions&gt; element (Actions), and a &lt;nextscreens&gt; element (Valid Next Screens).</p>
				<p>All &lt;screen&gt; elements are structured in this way, with three subelements. (A fourth and optional type of subelement, the &lt;recolimit&gt; element, is discussed later in this book.)</p>
				<p>The &lt;screen&gt; element is the master element of a macro screen.It contains all the other elements that belong to that macro screen, and it also contains, in its begin tag, attributes contain information applicable to the macro screen as a whole, as the macro screen's name.</p>
				<p>The &lt;description&gt; element contains descriptors that enable macro runtime to recognize that the &lt;screen&gt; element to which the &lt;description&gt; element belongs is associated with a particular application screen.The descriptors and the &lt;description&gt; element are described in <button onclick="scrollHere('md1_screen_description')">Screen description and recognition</button>.</p>
				<p>The &lt;actions&gt; element contains various actions that the runtime performs on the application screen, such as reading data the application screen or entering keystrokes. The actions and the &lt;actions&gt; element are described in <button onclick="scrollHere('ma_actions_part1')">Macro actions</button>.</p>
				<p>The &lt;nextscreens&gt; element (Valid Next Screens in <button onclick="scrollHere('mc2_fig_screen_concept')">Figure 14</button>) contains a list of the screen of all the &lt;screen&gt; elements that might validly occur after current macro screen. The &lt;nextscreens&gt; element and the that it encloses are described in <button onclick="scrollHere('mn_links')">Screen Recognition, Part 2</button>.</p>
				<h3 id="wq34">Introduction to the Screens tab</h3>
				<p>This section shows some of the ways in which the Screens tab the Macro Editor is related to the XML &lt;screen&gt; element in the previous section. <button onclick="scrollHere('mc2_hame_screens_tab')">Figure 15</button> the Macro Editor with the Screens tab selected:</p>
				<div class="fignone" id="mc2_hame_screens_tab"><span class="figcap">Figure 15. Screens tab of the Macro Editor</span>
					<div class="mmobj">
						<img src="./mb_hame_screens_tab.gif" alt="">
					</div>
				</div>
				<p class="indatacontent">In the figure above, notice that the Screens tab contains:</p>
				<ul>
					<li>A Screen Name listbox at the top of the tab.</li>
					<li>Three subordinate tabs, labeled General, Descriptions, and Actions.</li>
				</ul>
				<p class="indatacontent">Currently the General tab is selected.</p>
				<p>You should notice that there are two Screen Name fields on Screens tab: </p>
				<ul>
					<li>The Screen Name field at the top of the Screens tab is a that contains the names of all the macro screens in the macro.</li>
					<li>The Screen Name field at the top of the General subtab is an field in which you can type the name that you want to assign to currently selected screen.</li>
				</ul>
				<p>In the Screen Name listbox at the top of the Screens tab, you the name of the macro screen that you want to work on (such as Screen1), and the Macro Editor displays in the subtabs the information to that macro screen. For example, in <button onclick="scrollHere('mc2_hame_screens_tab')">Figure 15</button> listbox displays the macro screen name Screen1 and the subtabs the information belonging to Screen1. If the user selected macro screen name in the listbox, perhaps Screen10, then the Editor would display in the subtabs the information belonging to screen Screen10.</p>
				<p>In the Screen Name input field under the General tab, you the name that you want to assign to the currently selected macro screen.A screen name such as Screenx, where x stands for some integer (example, Screen1), is a temporary name that the Macro object to the macro screen when it creates the macro screen. You can this name, or you can replace it with a more descriptive name is easier to remember. (When all your macro screens have names as Screen3, Screen10, Screen24, and so on, it is difficult to which macro screen does what.)</p>
				<p>You have probably already noticed that the subtabs General, Description, and Actions on the Screens tab correspond to the main parts of XML &lt;screen&gt; element described in the previous section. Specifically,</p>
				<ul>
					<li>The General subtab presents the information stored in the of a &lt;screen&gt; element.</li>
					<li>The Description subtab presents the information stored in the &lt;description&gt; subelement of a &lt;screen&gt; element.</li>
					<li>The Actions subtab presents the information stored in the &lt;actions&gt; subelement of a &lt;screen&gt; element.</li>
				</ul>
				<p class="indatacontent">But what about the &lt;nextscreens&gt; subelement? For reasons the information belonging to the &lt;nextscreens&gt; is presented in a higher-level tab, the Links tab. You can see Links tab immediately to the right of the Screens tab in <button onclick="scrollHere('mc2_hame_screens_tab')">Figure 15</button>.</p>
				<p><button onclick="scrollHere('mc2_fig_sample_screen_element_partial')">Figure 16</button> shows XML begin tag and end tag of a sample &lt;screen&gt; element named Screen1:</p>
				<div class="figrules" id="mc2_fig_sample_screen_element_partial"><span class="figcap">Figure 16. Begin tag and end tag of a &lt;screen&gt; element</span>
					<pre class="xmp"><code>   &lt;screen name="Screen1" entryscreen="true" exitscreen="false" transient="false"&gt;    ...   &lt;/screen&gt;</code></pre>
				</div>
				<p class="indatacontent">In the figure above, the ellipsis (...) is not part of the text but indicates that the required elements contained inside the &lt;screen&gt; element have been omitted for simplicity. You should notice that attributes in the begin tag correspond to fields on the General in <button onclick="scrollHere('mc2_hame_screens_tab')">Figure 15</button>. For example, the <strong>name</strong> (<samp class="xph">name="Screen1"</samp> ) corresponds to the Screen Name field on the General tab, and the <strong>entryscreen</strong> (<samp class="xph">entryscreen="true"</samp>) corresponds to the Entry Screen on the General tab.</p>
				<p><button onclick="scrollHere('mc2_fig_sample_screen_element')">Figure 17</button> shows the XML for the entire &lt;screen&gt; element including the enclosed elements:</p>
				<div class="figrules" id="mc2_fig_sample_screen_element"><span class="figcap">Figure 17. Sample XML &lt;screen&gt; element</span>
					<pre class="xmp"><code>   &lt;screen name="Screen1" entryscreen="true" exitscreen="false" transient="false"&gt;       &lt;description&gt;          &lt;oia status="NOTINHIBITED" optional="false" invertmatch="false" /&gt;       &lt;/description&gt;       &lt;actions&gt;          &lt;mouseclick row="4" col="15" /&gt;          &lt;input value="3[enter]" row="0" col="0" movecursor="true"                    xlatehostkeys="true" encrypted="false" /&gt;       &lt;/actions&gt;       &lt;nextscreens timeout="0" &gt;          &lt;nextscreen name="Screen2" /&gt;       &lt;/nextscreens&gt;    &lt;/screen&gt;</code></pre>
				</div>
				<p class="indatacontent">In the figure above you should notice that the &lt;screen&gt; contains the required &lt;description&gt;, &lt;actions&gt;, and &lt;nextscreens&gt; elements.</p>
			</div>
		</div>

		<h1 id="part_developing_macros">Developing macros</h1>


		<button id="me_expressions" class="accordian">Data types, operators, and expressions</button>
		<div class="panel" style="display:none">


			<button id="me_choosing_a_format" class="accordian">Choosing a macro format</button>
			<div class="panel" style="display:none">
				<h3 id="me_basic_vs_advanced">The basic macro format versus the advanced macro format</h3>
				<p></p>
				<p>You must choose the format that you want your macro to be stored in: the basic macro format or the advanced macro format.</p>
				<p>The basic macro format is the default format. It supports a basic of function but it does not include support for expression evaluation, variables, or some other features supported by the advanced macro format. Nevertheless, you should choose the basic macro format initially unless you already that you are going to use expressions and variables. You can easily your macro to the advanced macro format later on. (In contrast, if you out with the advanced macro format it is much more difficult to switch macro to the basic macro format.)</p>
				<p>You indicate which format you want with the Use Variables and Expressions in Macro checkbox on the Macro tab of the Macro Editor:</p>
				<ul>
					<li>Clear this checkbox to select the basic macro format (default).</li>
					<li>Set this checkbox to select the advanced macro format.</li>
				</ul>
				<p>The basic macro format:</p>
				<ul>
					<li>Allows you to enter literal values, including integers, doubles, (true or false), and strings.</li>
				</ul>
				<p>In contrast the advanced macro format:</p>
				<ul>
					<li>Likewise allows you to enter literal values, including integers, doubles, boolean (true or false), and strings.</li>
					<li>Allows string concatenation using the '+' string operator.</li>
					<li>Allows arithmetic expressions.</li>
					<li>Allows conditional expressions.</li>
					<li>Allows variables.</li>
					<li>Allows imported Java variable types and methods</li>
				</ul>
				<h3 id="me_representing_strings">Representation of strings and special characters, treatment of characters</h3>
				<p>You must write strings and the two special characters single quote (') and backslash (\) differently in the macro depending on whether you have the basic macro format or the advanced macro format. Also, some that are ordinary characters in the basic macro format are used as in the advanced macro format.</p>
				<p>However, these rules affect only input fields located on the tabs:</p>
				<ul>
					<li>Description tab of the Screens tab</li>
					<li>Actions tab of the Screens tab</li>
					<li>Variables tab</li>
				</ul>
				<p>The input fields that are affected on these tabs are as follows:</p>
				<ul>
					<li>Of course, text input fields on the surface of the tab, such as the of Fields text input field on the Field Counts and OIA window of the tab.</li>
					<li>But also, the text input field in the window that pops up when you the <samp class="xph">&lt;Expression&gt;</samp> entry in a listbox on the tab, such as the <samp class="xph">&lt;Expression&gt;</samp> entry in the Ignore Case listbox on the String window.</li>
				</ul>
				<p>For input fields on all other tabs than those listed above, always the rules for the basic macro format.</p>
				<p>The following two sections describe these differing rules.</p>
				<h4 id="wq35">In the basic macro format, rules for representation of strings, etc.</h4>
				<p>If you have chosen the basic macro format, use the following rules input fields on the Description tab, Actions tab, and Variables tab:</p>
				<ul>
					<li>Strings must be written without being enclosed in single quotes. Examples: 	<pre class="xmp"><code>To be or not to John Smith</code></pre>
					</li>
					<li>The single quote (') and the backslash (\) are represented by the themselves without a preceding backslash. Examples: 	<pre class="xmp"><code>New Year's c:\Documents and Settings\User</code></pre>
					</li>
					<li>The following characters or character sequences are not treated as operators: 	+, -, *, /, %, ==, !=, &gt;, &lt;, &gt;=, &lt;=, &amp;&amp;, ||, !.</li>
				</ul>
				<h4 id="me_advanced_format_rules">In the advanced macro format, rules for representation of strings, etc.</h4>
				<p>If you have chosen the advanced macro format, use the following rules input fields on the Description tab, Actions tab, and Variables tab:</p>
				<ul>
					<li>All strings must be written enclosed in single quotes. Examples: <pre class="xmp"><code>'apple' 'banana' 'To be or not to be' 'John Smith'</code></pre>
					</li>
					<li>The single quote (') and the backslash (\) are represented by the themselves preceded by a backslash. Examples: <pre class="xmp"><code>'New Year\'s Day' c:\\Documents and Settings\\User</code></pre>
					</li>
					<li>The following characters or character sequences are treated as operators:  				<ul>
							<li>String concatenation operators: +</li>
							<li>Arithmetic operators:  +, -, *, /, %</li>
							<li>Conditional operators: ==, !=, &gt;, &lt;, &gt;=, &lt;=</li>
							<li>Logical operators: &amp;&amp;, ||, !</li>
						</ul>
					</li>
				</ul>
				<h3 id="me_convert_macro_format">Converting your macro to a different format</h3>
				<h4 id="wq36">Converting your macro to the advanced macro format</h4>
				<p>You can easily convert your macro from the basic macro format to the macro format, just by checking the "Use Variables and Arithmetic in Macro" checkbox on the Macro tab. As a result the Macro object does following:</p>
				<ul>
					<li>It enables all the advanced features for your macro.</li>
					<li>It automatically converts, in all input fields where conversion is required, all the strings in your macro and all occurrences of the two special single quote (') and backslash (\) from their basic representations to advanced representations.</li>
				</ul>
				<p class="indatacontent">That is, the Macro object will find all the strings in your macro surround them with single quotes, and the Macro object will change all of ' and \ to \' and \\. Also, any operator characters will be treated operators.</p>
				<h4 id="wq37">Converting your macro to the basic macro format</h4>
				<p>Converting your macro from the advanced macro format to the basic format can be very difficult. There are no automatic conversions when uncheck the "Use Variables and Arithmetic Expressions in Macro" checkbox.The only automatic result is that the Macro object:</p>
				<ul>
					<li>Disables all the advanced features for the macro.</li>
				</ul>
				<p class="indatacontent">You yourself must change, one at a time, by hand, all the of strings and of the two special characters back to the basic representations.Also, you will have to delete any instances where advanced features have used in the macro. If you do not do so then you might encounter errors unexpected results when you try to save or run the script. Any remaining characters will be treated as literal characters rather than as operators.</p>
			</div>

			<button id="mc_standard_data_types" class="accordian">Standard data types</button>
			<div class="panel" style="display:none">
				<p>The Macro object supports the following standard data types:</p>
				<ul>
					<li>boolean</li>
					<li>integers</li>
					<li>doubles</li>
					<li>strings</li>
				</ul>
				<p>These types are described in the subsections below.</p>
				<h3 id="me_boolean">Boolean data</h3>
				<p>The boolean values <samp class="xph">true</samp> and <samp class="xph">false</samp> can be with any combination of uppercase and lower case letters (such as True, TRUE, FALSE, falsE, and so on).</p>
				<p>An example of a input field that requires a boolean value is the Screen field on the General tab of the Screens tab. Enter <samp class="xph">true</samp> set the condition to true or <samp class="xph">false</samp> to set the condition to false.</p>
				<h4 id="wq38">Boolean values are not strings</h4>
				<p>The boolean values are not strings and therefore never need to be in single quotes. To repeat, whether you use the basic macro format or advanced macro format, booleans are always written <samp class="xph">true</samp> and <samp class="xph">false</samp>, not <samp class="xph">'true'</samp> and <samp class="xph">'false'</samp>.</p>
				<p>However, string values are converted to boolean values in a boolean (see <button onclick="scrollHere('me_cast_to_boolean')">Conversion to boolean</button>). Therefore with the advanced format you could enter the string <samp class="xph">'true'</samp> in a boolean field, the Macro Editor would convert the string <samp class="xph">'true' </samp>to the value<samp class="xph"> true</samp>.</p>
				<h3 id="wq39">Integers</h3>
				<p>Integers are written without commas or other delimiters. Examples:</p>
				<pre class="xmp"><code>-</code></pre>
				<h4 id="wq40">Integer constants</h4>
				<p>The Macro Editor has a number of integer constants that are written all uppercase characters. These values are treated as integers not strings.Examples:</p>
				<ul>
					<li>NOTINHIBITED</li>
					<li>FIELD_PLANE</li>
					<li>COLOR_PLANE</li>
				</ul>
				<h3 id="wq41">Doubles</h3>
				<p>Doubles are written without commas or other delimiters. Examples:</p>
				<pre class="xmp"><code>3.4.-119.</code></pre>
				<h3 id="wq42">Strings</h3>
				<p>A string is any sequence of characters and can include leading, trailing, or intervening blank characters. Strings in some input fields must be differently depending on whether the macro has been set to use the basic format or the advanced macro format. See <button onclick="scrollHere('me_representing_strings')">Representation of strings and special characters, treatment of characters</button>.</p>
				<p>The following examples use the representation for the advanced macro format:</p>
				<pre class="xmp"><code>'apple' 'User4' 'Total number of users' '   This string has 3 leading blanks.' 'This string has 3 trailing blanks.   '</code></pre>
				<p>Here are the same examples using the representation for the basic format.</p>
				<pre class="xmp"><code>Total number of    This string has 3 leading blanks.This string has 3 trailing blanks.   </code></pre>
				<p class="indatacontent"> Notice that with the basic format trailing blanks are still allowed but are difficult to detect. If doubt see the representation of the string in the Code Editor.</p>
			</div>


			<button id="wq43" class="accordian">Fields</button>
			<div class="panel" style="display:none">
				<p>See <button onclick="scrollHere('mv_field_vars')">Field variables</button>.</p>
			</div>


			<button id="wq44" class="accordian">The value null</button>
			<div class="panel" style="display:none">
				<p>The value <samp class="xph">null</samp> is a reserved word, not a string. When used place of an object belonging to an imported Java class, it has the same as it does in the Java language.</p>
				<p>Do not use <samp class="xph">null</samp> to signify an empty string. To signify an string, use a pair of single quotes ('') in the advanced macro format, nothing at all in the basic macro format. If you use the value <samp class="xph">null</samp> a string context (for example, by assigning it to a string variable), the Macro Editor or the macro runtime will convert the value <samp class="xph">null</samp> the string 'null'.</p>
			</div>


			<button id="me_arithmetic" class="accordian">Arithmetic operators and expressions</button>
			<div class="panel" style="display:none">
				<p>In order to use arithmetic expressions you must first check the "Use and Arithmetic Expressions in Macro" checkbox on the Macro tab (see <button onclick="scrollHere('me_representing_strings')">Representation of strings and special characters, treatment of characters</button>).</p>
				<h3 id="me_operators_and_expressions">Operators and expressions</h3>
				<p>The arithmetic operators are:</p>
				<table id="wq45" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 3. Arithmetic operators</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq46" align="left" valign="top">Operator</th>
							<th id="wq47" align="left" valign="top">Operation</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td headers="wq46">+</td>
							<td headers="wq47">Addition</td>
						</tr>
						<tr>
							<td headers="wq46">-</td>
							<td headers="wq47">Subtraction</td>
						</tr>
						<tr>
							<td headers="wq46">*</td>
							<td headers="wq47">Multiplication</td>
						</tr>
						<tr>
							<td headers="wq46">/</td>
							<td headers="wq47">Division</td>
						</tr>
						<tr>
							<td headers="wq46">%</td>
							<td headers="wq47">Modulo</td>
						</tr>
					</tbody>
				</table>
				<p>In an arithmetic expression the terms are evaluated left to right. order of precedence of the operators is: *, /, %, +, -. For example, the of :</p>
				<pre class="xmp"><code>4 * 2 + 16 / 8 - 1 * 2</code></pre>
				<p class="indatacontent">is 8. You can use parentheses to the order in which you want expressions to be evaluated:</p>
				<pre class="xmp"><code>(4 * 2) + (16 / 8) - (1 * 2)    evaluates to 4 * (( 2 + 16) / (8 - 1)) * 2   evaluates to 20.571</code></pre>
				<h3 id="wq48">Where arithmetic expressions can be used</h3>
				<p>You can use an arithmetic expression almost anywhere that you can use arithmetic value. Examples:</p>
				<ul>
					<li>As a parameter for a screen. For example,  				<ul>
							<li>To specify a recognition limit for a screen.</li>
							<li>To specify a pause time for a screen.</li>
						</ul>
					</li>
					<li>As a parameter for a descriptor. For example,  				<ul>
							<li>To specify a row or column in cursor descriptor.</li>
							<li>To specify the number of fields in a numeric field count descriptor.</li>
							<li>To specify a row, column, or attribute value in an attribute descriptor.</li>
							<li>As a term in a conditional descriptor.</li>
						</ul>
					</li>
					<li>As a parameter in an action. For example,
						<ul>
							<li>To specify a row or column in a mouse click action.</li>
							<li>To specify a row or column in a box selection action.</li>
							<li>As the number of milliseconds in a pause action.</li>
							<li>To specify a value in a variable update action.</li>
							<li>As a term in a conditional action.</li>
						</ul>
					</li>
					<li>As an initial value for a variable.</li>
				</ul>
			</div>

			<button id="me_string_concat_operator" class="accordian">String concatenation operator (+)</button>
			<div class="panel" style="display:none">
				<p>You can use the string concatenation operator '+' only if you check "Use Variables and Arithmetic Expressions in Macro" checkbox on the tab. See <button onclick="scrollHere('me_basic_vs_advanced')">The basic macro format versus the advanced macro format</button>.</p>
				<h3 id="wq49">Operators and expressions</h3>
				<p>The string operators are shown in the table below.</p>
				<table id="wq50" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 4. Arithmetic operators</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq51" align="left" valign="top">Operator</th>
							<th id="wq52" align="left" valign="top">Operation</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td headers="wq51">+</td>
							<td headers="wq52">Concatenate</td>
						</tr>
					</tbody>
				</table>
				<p class="indatacontent">You can write a string expression containing multiple concatenations.The following examples use the string representation required for the format (see <button onclick="scrollHere('me_representing_strings')">Representation of strings and special characters, treatment of characters</button>). </p>
				<pre class="xmp"><code>Expression:               Evaluates to:  'Hello ' + 'Fred' + '!'   'Hello Fred!' 'Hi' 'There'              (Error, a + operator is required to concatenate strings) 'Hi' + 'There'            'HiThere' </code></pre>
			</div>

			<button id="me_conditional_expressions" class="accordian">Conditional and logical operators and expressions</button>
			<div class="panel" style="display:none">
				<p>The conditional operators are:</p>
				<table id="wq53" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 5. Conditional operators</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq54" align="left" valign="top">Operator</th>
							<th id="wq55" align="left" valign="top">Operation</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td headers="wq54">==</td>
							<td headers="wq55">Equal</td>
						</tr>
						<tr>
							<td headers="wq54">!=</td>
							<td headers="wq55">Not equal</td>
						</tr>
						<tr>
							<td headers="wq54">&gt;</td>
							<td headers="wq55">Greater than</td>
						</tr>
						<tr>
							<td headers="wq54">&lt;</td>
							<td headers="wq55">Less than</td>
						</tr>
						<tr>
							<td headers="wq54">&gt;=</td>
							<td headers="wq55">Greater than or equal</td>
						</tr>
						<tr>
							<td headers="wq54">&lt;=</td>
							<td headers="wq55">Less than or equal</td>
						</tr>
					</tbody>
				</table>
				<p class="indatacontent">The logical operators are:</p>
				<table id="wq56" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 6. Logical operators</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq57" align="left" valign="top">Operator</th>
							<th id="wq58" align="left" valign="top">Operation</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td headers="wq57">&amp;&amp;</td>
							<td headers="wq58">AND</td>
						</tr>
						<tr>
							<td headers="wq57">||</td>
							<td headers="wq58">OR</td>
						</tr>
						<tr>
							<td headers="wq57">!</td>
							<td headers="wq58">NOT</td>
						</tr>
					</tbody>
				</table>
				<p class="indatacontent">If you are entering &amp;&amp; in an HTML or XML editor you have to enter &amp;amp;&amp;amp;</p>
				<p>In a conditional expression the terms are evaluated left to right. order of precedence of the operators is the same order in which they are in the tables above. You can use parentheses to indicate the order in you want expressions to be evaluated. Examples:</p>
				<pre class="xmp"><code>Expression:                  Evaluates to:  (4 &gt; 3)                      !(4 &gt; 3 )                    (4 &gt; 3) &amp;&amp; (8 &gt; 10)          (4 &gt; 3) || (8 &gt; 10)          </code></pre>
				<h3 id="wq59">Conditional expression can include complex terms</h3>
				<p>A conditional expression can contain arithmetic expressions, variables, and calls to methods of imported Java classes.</p>
				<h3 id="wq60">Where conditional expressions can be used</h3>
				<p>Conditional and logical operators can be used only in two contexts:</p>
				<ul>
					<li>The Condition field of a conditional descriptor</li>
					<li>The Condition field of a conditional action</li>
				</ul>
				<p></p>
			</div>


			<button id="me_data_type_conversion" class="accordian">Automatic data type conversion</button>
			<div class="panel" style="display:none">
				<h3 id="wq61">Effect of context</h3>
				<p>If an item of data belongs to one standard data type (boolean, integer, double, or string) but the context requires a different standard data type, then when the data is evaluated (either when the Macro Editor saves the or else when the macro runtime plays the macro) it is automatically to the standard data type required by the context, if possible.</p>
				<p>Examples of context are:</p>
				<ul>
					<li>The Condition field of a Condition descriptor (expects a boolean value)</li>
					<li>The Message Text field of a Message action (expects a string value)</li>
					<li>The Value field of a Variable update action when the variable is a variable (expects a location string)</li>
					<li>The Row value of an Input action (expects an integer value)</li>
				</ul>
				<p class="indatacontent">However, if the data cannot be converted to the new data type (for example, the string <samp class="xph">123apple</samp> cannot be converted to an integer) then error occurs. The Macro Editor displays an error message. The macro stops the macro playback and displays an error message.</p>
				<p>The following subsections discuss the conversions that can occur for standard data type.</p>
				<h3 id="me_cast_to_boolean">Conversion to boolean</h3>
				<p>The string <samp class="xph">'true'</samp>  (or <samp class="xph">'TRUE'</samp>, <samp class="xph">'True'</samp>, and so on) in a boolean context is converted to boolean true. Any other in a boolean context (including <samp class="xph">'false'</samp>, <samp class="xph">'1'</samp>, <samp class="xph">'apple'</samp>, and any other) is converted to boolean false. </p>
				<pre class="xmp"><code>'true' (in an input field that requires a boolean)  converts to 'apple' (in an input field that requires a boolean)  converts to false</code></pre>
				<h3 id="wq62">Conversion to integer</h3>
				<p>A string in valid integer format and occurring in an integer context to integer.</p>
				<pre class="xmp"><code>'4096'                 converts to       '-9'                   converts to       -9</code></pre>
				<h3 id="wq63">Conversion to double</h3>
				<p>A string in valid double format occurring in a double context to double.</p>
				<pre class="xmp"><code>'148.3'                 converts to 148.3</code></pre>
				<p>An integer combined with a double results in a double:</p>
				<pre class="xmp"><code>10 +  6.4             evaluates to 16.4</code></pre>
				<h3 id="wq64">Conversion to string</h3>
				<p>A boolean, integer, or double in a string context converts to a string.(Remember, the boolean values true and false are not strings. See <button onclick="scrollHere('me_boolean')">Boolean data</button>.)</p>
				<pre class="xmp"><code>'The result is ' + true                         evaluates to 'The result is true' FALSE (in an input field that requires a string) converts to 'FALSE' 'The answer is ' + 15                           evaluates to 'The answer is 15' 22 (in an input field that requires a string)   converts to  '22' ('4.5' == .45e1)                                evaluates to 14,52 (in an input field that requires a string) evaluates to'14,52'</code></pre>
				<h3 id="wq65">Conversion errors</h3>
				<p>If the context requires a conversion but the format of the data is valid for the conversion then the Macro Editor displays an error message.If the error occurs while a macro is playing then the macro runtime an error message and terminates the macro with a run-time error.</p>
				<pre class="xmp"><code>'123apple'       in an integer context    '22.7peach'      in a double context      </code></pre>
			</div>

			<button id="me_equivalents" class="accordian">Equivalents</button>
			<div class="panel" style="display:none">
				<p> Any context that accepts an immediate value of a particular standard type also accepts any entity of the same data type.</p>
				<p>For example, if an input field accepts a string value, such as <samp class="xph">'Dialog'</samp>, it also accepts:</p>
				<ul>
					<li>An expression that evaluates to a string.</li>
					<li>A value that converts to a string.</li>
					<li>A string variable.</li>
					<li>A call to an imported method that returns a string.</li>
				</ul>
				<p>Similarly, if an input field accepts a boolean value (true or false), also accepts:</p>
				<ul>
					<li>An expression that evaluates to a boolean value.</li>
					<li>A value that converts to a boolean value.</li>
					<li>A boolean variable.</li>
					<li>A call to an imported method that returns a boolean.</li>
				</ul>
				<p>Recognizing this flexibility in the macro facility will help you more powerful macros.</p>
			</div>

			<button id="me1_negative_row_or_col" class="accordian">Significance of a negative value for a row or column</button>
			<div class="panel" style="display:none">
				<p>In the String descriptor and in several other descriptors and actions, a negative value for a row or column of the session window indicates an from the last row or the last column of the session window. The macro calculates the row or column location as follows:</p>
				<pre class="xmp"><code>actual row    = (number of rows in text area)    + 1 + (negative row offset) actual column = (number of columns in text area) + 1 + (negative column offset)</code></pre>
				<p class="indatacontent">For example, if the session window has 24 rows of text then a row of -1 indicates an actual row coordinate of 24 (calculated as: 24 + 1 - 1).Similarly if the session window has 80 columns of text then a column of -1 indicates an actual column coordinate of 80 (calculated as 80 + 1 -
				1).</p>
				<p>The row calculation above ignores the OIA row. For example, if the window is 25 rows high, it has only 24 rows of text.</p>
				<p>The advantage of this convention is that if you want to specify a at the bottom of the session window, then this calculation gives the result whether the session window has 25, 43, or 50 rows. Similarly, if want to specify a rectangle at the right side of the session window, this calculation gives the right result whether the session window has columns or 132 columns.</p>
				<p>The following tables shows the results for a few calculations:</p>
				<table id="wq66" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 7. Negative value for row</caption>
					<tbody valign="top">
						<tr>
							<td>Negative value for row:</td>
							<td>Actual value in session window with 24 columns of (OIA row is ignored):</td>
							<td>Actual value in session window with 42 columns of (OIA row is ignored):</td>
							<td>Actual value in session window with 49 columns of (OIA row is ignored):</td>
						</tr>
						<tr>
							<td>-1</td>
							<td>24</td>
							<td>42</td>
							<td>49</td>
						</tr>
						<tr>
							<td>-2</td>
							<td>23</td>
							<td>41</td>
							<td>48</td>
						</tr>
						<tr>
							<td>-3</td>
							<td>22</td>
							<td>40</td>
							<td>47</td>
						</tr>
					</tbody>
				</table>
				<table id="wq67" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 8. Negative value for column</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq68" align="left" valign="top">Negative value for column:</th>
							<th id="wq69" align="left" valign="top">Actual value in session window with columns:</th>
							<th id="wq70" align="left" valign="top">Actual value in session window with columns:</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td headers="wq68">-1</td>
							<td headers="wq69">80</td>
							<td headers="wq70">132</td>
						</tr>
						<tr>
							<td headers="wq68">-2</td>
							<td headers="wq69">79</td>
							<td headers="wq70">131</td>
						</tr>
						<tr>
							<td headers="wq68">-3</td>
							<td headers="wq69">78</td>
							<td headers="wq70">130</td>
						</tr>
					</tbody>
				</table>
				<p>Whether you make use of this convention or not, you should at least that a rectangular area with coordinates of (1,1) and (-1,-1) means the text area of the session window.</p>
			</div>
		</div>

		<button id="mc3_processing_macro_screen" class="accordian">How the macro runtime processes a macro screen</button>
		<div class="panel" style="display:none">
			<p>This section describes the activities that occur when the macro processes a macro screen. Although this topic is tedious to read about is important, and sooner or later you are likely to have a question it. You might want to read through the the first part of this chapter (Overview) now and skip the remaining parts until you have a specific question.</p>
			

			<button id="wq71" class="accordian">Overview</button>
			<div class="panel" style="display:none">
				<h3 id="wq72">Scenario used as an example</h3>
				<p>As an example, this chapter uses a scenario from a macro recorded in previous chapter, <button onclick="scrollHere('mx_record_and_playback')">Recording and playing back a simple macro</button>. This macro only two macro screens, Screen1 and Screen2.</p>
				<p>The scenario begins at the point at which the macro runtime has all the actions in Screen1 and is ready to search for the next macro to be processed.</p>
				<p>Screen1 is the macro screen that handles the ISPF Primary Option Menu (see <button onclick="scrollHere('mx_fig_ispf_pom')">Figure 5</button>). <button onclick="scrollHere('mc3_table_macro_screen1')">Table 9</button> shows conceptual view of the contents of Screen1:</p>
				<table id="mc3_table_macro_screen1" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 9. Contents of macro screen Screen1</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq73" align="left" valign="top">XML element contained in &lt;screen&gt; Screen1:</th>
							<th id="wq74" align="left" valign="top">Contents of XML element:</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td headers="wq73">&lt;description&gt;</td>
							<td headers="wq74">Descriptors:  						<ul>
									<li>The input inhibited indicator is cleared (input is not inhibited).</li>
								</ul>
							</td>
						</tr>
						<tr>
							<td headers="wq73">&lt;actions&gt;</td>
							<td headers="wq74">Actions:  						<ol type="1">
									<li>Move the text cursor to row 4 and column 16.</li>
									<li>Type '3[enter]'.</li>
								</ol>
							</td>
						</tr>
						<tr>
							<td headers="wq73">&lt;nextscreens&gt;</td>
							<td headers="wq74">Names of macro screens that can validly occur this macro screen:  						<ul>
									<li>Screen2</li>
								</ul>
							</td>
						</tr>
					</tbody>
				</table>
				<p>Screen2 is the macro screen that handles the Utility Selection Panel (see <button onclick="scrollHere('mx_fig_ispf_usp1')">Figure 6</button>). <button onclick="scrollHere('mc3_table_macro_screen2')">Table 10</button> shows conceptual view of the contents of Screen2:</p>
				<table id="mc3_table_macro_screen2" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 10. Contents of macro screen Screen2</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq76" align="left" valign="top">XML element contained in &lt;screen&gt; Screen2:</th>
							<th id="wq77" align="left" valign="top">Contents of XML element:</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td headers="wq76">&lt;description&gt;</td>
							<td headers="wq77">Descriptors:  						<ul>
									<li>The input inhibited indicator is cleared (input is not inhibited).</li>
									<li>There are 80 fields.</li>
									<li>There are 3 input fields.</li>
								</ul>
							</td>
						</tr>
						<tr>
							<td headers="wq76">&lt;actions&gt;</td>
							<td headers="wq77">Actions (the host application pre-positions the cursor in the correct input field):  						<ol type="1">
									<li>Type '4[enter]'.</li>
								</ol>
							</td>
						</tr>
						<tr>
							<td headers="wq76">&lt;nextscreens&gt;</td>
							<td headers="wq77">Names of macro screens that can validly occur this macro screen:  						<ul>
									<li>(None. This is the last macro screen in the macro.)</li>
								</ul>
							</td>
						</tr>
					</tbody>
				</table>
				<h3 id="wq79">Stages in processing a macro screen</h3>
				<p>During macro playback the macro runtime loops through the same three of activity again and again until the macro terminates:</p>
				<div class="figrules" id="mc3_fig_the_3_stages"><span class="figcap">Figure 18. Stages in processing a macro screen</span>
					<ol type="1">
						<li>Determine the next macro screen to be processed.</li>
						<li>Make the selected macro screen the new current macro screen.</li>
						<li>Perform the actions in the new current macro screen's &lt;actions&gt; element.</li>
					</ol>
				</div>
				<button id="mc3_valid_next_screens"></button>
				<h3 id="wq81">Closer look at stage 1</h3>
				<p>Stage 1 requires a more detailed explanation than stage 2 or 3. Stage itself contains three steps:</p>
				<div class="figrules" id="mc3_fig_substeps_of_stage1"><span class="figcap">Figure 19. Three steps in stage 1</span>
					<ul>
						<li>1(a) Add the names of candidate macro screens to the list of valid screens.</li>
						<li>1(b) Do screen recognition to match one of the candidate macro to the actual application screen that is currently displayed in the window.</li>
						<li>1(c) Remove the names of candidate macro screens from the list of next screens.</li>
					</ul>
				</div>
				<p class="indatacontent">Each of these steps involves the list of valid next screens.</p>
				<p>The list of valid next screens is just a list that can hold macro names. The macro runtime creates this list at the beginning of macro (before playing back the first macro screen), and discards this list macro playback is complete. Initially the list is empty (except possibly transient screens, which are described later in this chapter).</p>
				<p>During macro playback, each time the macro runtime needs to determine next macro screen to be processed, it performs the three steps 1(a), 1(b), and 1(c) using the list of valid next screens.</p>
				<h3 id="mc3_overview_of_entire_process">Overview of the entire process (all 3 stages)</h3>
				<p>In stage 1 the macro runtime determines the next macro screen to be processed.As stated in the previous section, stage 1 includes three steps.</p>
				<p>In step 1(a) the macro runtime collects the names of macro screens can occur after the current macro screen, and adds these names to the of valid next screens. There may be just one such screen on the list or several.In the example scenario, the macro runtime would look in the &lt;nextscreens&gt; element of Screen1, find one name (Screen2), and add that name to the (see <button onclick="scrollHere('mc3_table_macro_screen1')">Table 9</button>).</p>
				<p>In step 1(b), the macro runtime periodically checks each macro screen the list to determine whether it matches the application screen.</p>
				<p>There is a time factor here. Because of an action that the macro has just performed in the current macro screen (in Screen1, typing '3[enter]' as the last action of the &lt;actions&gt; element), the host application is the process of changing the session window so that it displays the new screen (the Utility Selection Panel) instead of the old application (ISPF Primary Option Menu). However, this change does not occur or all at once. The change takes some hundreds of milliseconds and may several packets of data from the host.</p>
				<p> Therefore, during step 1(b), every time the OIA line or the session window'presentation space is updated, the macro runtime again checks the macro (or screens) named in the list of valid next screens to determine one of them matches the application screen in its current state.</p>
				<p>Eventually the session window is updated to the extent that the macro is able to match one of the macro screens on the list to the application screen.</p>
				<p>In step 1(c), the macro runtime removes all the macro screen names the list of valid next screens (except transient screens if any).</p>
				<p>In stage 2, the macro runtime makes the selected macro screen (the that matched the application screen in step 1(b)) the new current macro screen.</p>
				<p>Finally, in stage 3, the macro runtime performs the actions in the &lt;actions&gt; element of Screen2.</p>
				<h3 id="wq82">Conclusion of the overview</h3>
				<p>At this point, if you are reading this book for the first time, you want to skip the rest of this chapter and begin the next chapter. Later, you have a question about how the macro runtime processes a macro screen, you can return to this chapter to learn more.</p>
				<p>The rest of this chapter describes the same processing sequence as in overview but provides more information about each step.</p>
			</div>

			<button id="wq83" class="accordian">Stage 1: Determining the next macro screen to be processed</button>
			<div class="panel" style="display:none">
				<p>As stated earlier, stage 1 contains three steps: adding macro screen to the list of valid next screens, doing screen recognition, and the macro screen names from the list of valid next screens.</p>
				<h3 id="wq84">Adding macro screen names to the list of valid next screens (step 1(a))</h3>
				<p>In this step the macro runtime places the names of candidate macro on the list of valid next screens.</p>
				<h4 id="wq85">Valid next screens</h4>
				<p>When a host application has displayed an application screen in the window, and a user input has occurred, then usually only a few screens (frequently just one) can occur next.</p>
				<p>In the example scenario, the current macro screen is Screen1, the application screen is the ISPF Primary Option menu, and the input is '3' the enter key (see <button onclick="scrollHere('mc3_table_macro_screen1')">Table 9</button>). In this context, only one application screen can occur next, the Utility Selection Panel. the name of only one macro screen needs to be added to the list of valid screens: Screen2.</p>
				<p>But wait a minute, you say. The ISPF Primary Option Menu has about 30 possible inputs (15 options, 6 menu selections, and 8 function keys). should be 30 names of macro screens on the list, not just 1.</p>
				<p>The reason that the list of valid next screens usually has only one a few names on it is that the macro is executing a series of that are aimed at accomplishing some specific task. In Screen1, the are aimed at getting from the ISPF Primary Option Menu to the Utility Panel. The necessary actions have been performed to make this transition ('3[enter]') and the macro screen is now just waiting for the expected screen to appear.</p>
				<h4 id="wq86">How the macro runtime selects the names of candidate macro screens</h4>
				<p>This section describes how the macro runtime selects the macro screen that it places on the list of valid next screens. There are two cases:</p>
				<ul>
					<li>For the very first macro screen to be played back, the macro runtime the name of any macro screen in the macro that is marked as an entry screen.</li>
					<li>For all subsequent macro screens being played back, the macro uses the names that it finds in the &lt;nextscreens&gt; element of the macro screen.</li>
				</ul>
				<h5 id="wq87">First macro screen</h5>
				<p>When macro playback begins, the list of valid next screens is empty (possibly for transient screens, see <button onclick="scrollHere('mc3_transient_screens')">Transient screens</button>).</p>
				<p>To get candidates for the first macro screen to be processed, the runtime searches the entire macro, finds each macro screen that is as an entry screen, and adds the names of these macro screens to the list.</p>
				<p>The entry screen setting (an attribute of the &lt;screen&gt; element) for exactly this purpose, to mark macro screens that can occur as the screen to be processed.</p>
				<p>When a macro is recorded, the Macro object by default marks just the macro screen to be recorded as an entry screen. After recording is complete, the macro developer can mark (or unmark) any macro screen as an entry screen, and there can be multiple entry screens.</p>
				<p>Entry screens are described in more detail in <button onclick="scrollHere('mn_entry_screen')">Entry screens</button>.</p>
				<p>If no macro screen is marked as an entry screen, then the macro uses all the macro screens in the macro as candidates for the first screen to be processed.</p>
				<h5 id="wq88">Subsequent macro screens</h5>
				<p>For subsequent macro screens (including the one immediately after the macro screen), the macro runtime finds the names of the candidate macro listed in the &lt;nextscreens&gt; element of the current macro screen.</p>
				<p>In the example scenario, Screen1 is the current macro screen, and its &lt;nextscreens&gt; element contains the name of one macro screen, Screen2 (see <button onclick="scrollHere('mc3_table_macro_screen1')">Table 9</button>).Therefore the macro runtime adds Screen2 to the list.</p>
				<p>However many macro screen names are listed in the &lt;nextscreens&gt; element, the macro runtime adds all of them to the list of valid next screens.</p>
				<p>During macro recording, when the Macro object begins to record a new screen, it stores the name of that new macro screen (such as Screen2) in the &lt;nextscreens&gt; element of the macro screen that it has just finished recording (such as Screen1).Therefore each macro screen (except the last) of a recorded macro has name of one macro screen stored in its &lt;nextscreens&gt; element.</p>
				<p>Subsequently a macro developer can add or delete the name of any screen in the macro to or from the &lt;nextscreens&gt; element of any macro screen.</p>
				<p>The &lt;nextscreens&gt; element is described in more detail in <button onclick="scrollHere('ms1_valid_next_screens')">Valid next screens</button>.</p>
				<h5 id="mc3_transient_screens">Transient screens</h5>
				<p>A transient screen is a screen that can occur at any point in the macro, that occurs unpredictably, and that always needs to be cleared. An of a transient screen is an error screen that appears in response to input.</p>
				<p>The Macro object does not mark any macro screen as a transient screen macro recording. However, subsequently the macro developer can mark any screen as a transient screen.</p>
				<p>When macro playback begins, the macro runtime searches the macro, each macro screen that is marked as a transient screen, and adds the of each transient macro screen to the list of valid next screens. These remain on the list for the duration of the macro playback.</p>
				<p>For more information on transient screens see <button onclick="scrollHere('mn_transient_screen')">Transient screens</button>.</p>
				<h3 id="wq89">Screen recognition (step 1(b))</h3>
				<p>In this step the macro runtime matches one of the macro screens named the list of valid next screens to the current application screen.</p>
				<p> This process is called screen recognition because the macro runtime one of the macro screens on the list as corresponding to the application that is currently displayed in the session window.</p>
				<h4 id="wq90">Overview of evaluation</h4>
				<p>The macro runtime evaluates the candidate macro screens in the order which their names appear in the list of valid next screens.</p>
				<p>If the macro runtime finds that one of the candidates matches the screen, then the macro runtime immediately stops evaluating and goes on the next step of removing the candidate names from the list (step 1(c)). matching screen becomes the next macro screen to be processed (stage 2).</p>
				<p>However, if the macro runtime evaluates each macro screen named in list without finding a match, then the macro runtime stops evaluating, temporarily, and does nothing further until the session window is updated.</p>
				<h4 id="mc3_again_tries_to_match">Re-doing the evaluation</h4>
				<p>While the macro runtime is working on screen recognition, the host is working on updating the session window with the new application screen.In the example scenario, the host application is updating the session so that it displays the Utility Selection Panel (see <button onclick="scrollHere('mc3_table_macro_screen1')">Table 9</button> and <button onclick="scrollHere('mc3_table_macro_screen2')">Table 10</button>). This process takes some hundreds of and may require several packets of data from the host.</p>
				<p>This situation explains why the macro runtime temporarily stops on screen recognition until the screen is updated. If screen recognition failed, the reason may be that the new application screen is incomplete. the macro runtime waits.</p>
				<p>Each time that the OIA line is updated or the presentation space of session window is updated, the macro runtime again makes a pass through list of valid next screens, trying to find a match to the current screen. If no match occurs then the macro runtime waits again.</p>
				<p>The macro runtime may go through several cycles of waiting and re-before screen recognition succeeds.</p>
				<p>Eventually enough of the new application screen arrives so that the runtime can match one of the macro screens named in the list to the new screen.</p>
				<h4 id="wq91">Determining whether a macro screen matches the application screen</h4>
				<p>The macro runtime determines whether a macro screen matches the application screen by comparing individual descriptors in the macro to the current session window.</p>
				<p>In the example scenario, the macro runtime find the name Screen2 on list of valid next screens, retrieves Screen2, looks at its descriptors, compares the descriptors with the session window.</p>
				<p>Each macro screen contains a &lt;description&gt; element that itself one or more descriptors. A descriptor is a statement of fact about the window (application screen in its current state) that can be either true false. In the example scenario, Screen2 contains three descriptors:</p>
				<ul>
					<li>The input inhibited indicator is cleared (input is not inhibited).</li>
					<li>There are 80 fields in the session window.</li>
					<li>There are 3 input fields in the session window.</li>
				</ul>
				<p>When there are several descriptors in a &lt;description&gt; element, as here, the method that the macro runtime uses to evaluate the descriptors (as true or false) and to combine their results into a single result (true false) depends on some additional configuration information that is not here.</p>
				<p>However, in the example scenario, Screen2 is configured in the manner, so that the macro runtime evaluates each of the three in turn. If all three are true, then the macro runtime concludes that overall result is true, and that Screen2 matches the current application screen.</p>
				<p>For more information about evaluating descriptors see <button onclick="scrollHere('md1_evaluation_of_descriptors')">Evaluation of descriptors</button>.</p>
				<h4 id="wq92">Two recognition features</h4>
				<h5 id="wq93">Timeout setting for screen recognition</h5>
				<p>You can set a timeout value that causes the macro runtime to the macro if screen recognition does not occur before the timer expires (see <button onclick="scrollHere('mt_screen_recog_timeout')">Timeout settings for screen recognition</button>).</p>
				<h5 id="wq94">Recognition limit</h5>
				<p>You can set a recognition count that causes the macro runtime to the macro or to jump to a specified macro screen if the macro runtime a macro screen, such as ScreenA, a number of times equal to the count (see <button onclick="scrollHere('mn_recolimit')">Recognition limit (General tab of the Screens tab)</button>).</p>
				<h3 id="wq95">Removing the names of candidate macro screens from the list of next screens (step 1(c))</h3>
				<p>After screen recognition has succeeded, the macro runtime immediately its next task, which is cleaning up the list of valid next screens (step 1(c)).</p>
				<p>This is a simple step. The macro runtime removes the names of all the macro screens, whether recognized or not, from the list of valid next screens.</p>
				<p> If the list contains the names of transient screens, those names on the list (see <button onclick="scrollHere('mn_transient_screen')">Transient screens</button>).</p>
			</div>

			<button id="wq96" class="accordian">Stage 2: Making the successful candidate the new current macro screen</button>
			<div class="panel" style="display:none">
				<p>Stage 2 is simple. In stage 2 the macro runtime makes the successful macro screen the new current macro screen.</p>
				<p>In the example scenario, the macro runtime makes Screen2 the new macro screen. The session window displays the new application screen, Utility Selection Panel (see <button onclick="scrollHere('mc3_table_macro_screen1')">Table 9</button> and <button onclick="scrollHere('mc3_table_macro_screen2')">Table 10</button>).</p>
				<p>The macro runtime immediately begins stage 3.</p>
			</div>

			<button id="wq97" class="accordian">Stage 3: Performing the actions in the new current macro screen</button>
			<div class="panel" style="display:none">
				<p>In stage 3 the macro runtime performs the actions in the new current screen's &lt;actions&gt; element. If the new current macro screen does not an &lt;actions&gt; element or if the &lt;actions&gt; element is empty, then macro runtime skips this stage.</p>
				<p>Each macro screen typically contains an &lt;actions&gt; element that one or more actions to be performed. An action is an instruction that some type of activity, such as sending a sequence of keys to the session window, displaying a prompt in a popup window for the user, capturing a block of from the screen, or some other activity.</p>
				<p>In the example scenario Screen2 contains only one action:</p>
				<ul>
					<li>Type '4' followed by the enter key.</li>
				</ul>
				<p class="indatacontent">Screen2 does not need an action to position the text cursor in the input field because the Utility Selection Panel automatically positions text cursor there.</p>
				<p>If the &lt;actions&gt; element contains multiple actions, the macro run performs each macro action in turn in the order in which it occurs in the &lt;actions&gt; element.</p>
				<p>For more information on actions see <button onclick="scrollHere('ma_actions_part1')">Macro actions</button>.</p>
				<h3 id="wq98">Inserting a delay after an action</h3>
				<p>Because the macro runtime executes actions much more quickly than a user does, unforeseen problems can occur during macro playback that an action not to perform as expected, because of a dependency on a action.</p>
				<p>To avoid this type of problem, the macro runtime by default inserts a of 150 milliseconds after every Input action or Prompt action in every screen, and a delay of 300 milliseconds after the last action of every screen (see <button onclick="scrollHere('mt_pause_between_actions')">Pause Between Actions (Macro tab)</button>).</p>
				<p>You should leave this feature enabled, although you can disable it if want. You can change the delays from 150 milliseconds and 300 to other values.</p>
				<p>If you want to change the duration of the delay for a particular screen, you can do so (see <button onclick="scrollHere('mt_set_pause_time')">Set Pause Time (General tab of the Screens tab)</button>).</p>
				<p>Also, for any particular action, you can increase the delay by adding Pause action after the action (see <button onclick="scrollHere('ma_pause')">Pause action (&lt;pause&gt; element)</button>).</p>
			</div>

			<button id="wq99" class="accordian">Repeating the processing cycle</button>
			<div class="panel" style="display:none">
				<p>After the macro runtime has performed all the actions in the &lt;actions&gt; element of the current macro screen, the macro runtime immediately the processing cycle again, starting with step 1(a), and using the macro screens listed in the &lt;nextscreens&gt; element of the new current screen.</p>
			</div>

			<button id="wq100" class="accordian">Terminating the macro</button>
			<div class="panel" style="display:none">
				<p>The macro runtime terminates the macro when it finishes processing a screen that is marked as an exit screen.</p>
				<p>In the example scenario Screen2 is marked as an exit screen (see <button onclick="scrollHere('mc3_table_macro_screen2')">Table 10</button>).</p>
				<p>The exit screen setting (an attribute of the &lt;screen&gt; element) for exactly this purpose, to mark macro screens that terminate the macro.</p>
				<p>When a macro is recorded, the Macro object by default marks the last screen to be recorded as an exit screen. After recording is complete, macro developer can mark (or unmark) any macro screen as an exit screen, there can be multiple exit screens.</p>
				<p>Exit screens are described in more detail in <button onclick="scrollHere('mn_exit_screen')">Exit screens</button>.</p>
			</div>
		</div>

		<button id="md1_screen_description" class="accordian">Screen description and recognition</button>
		<div class="panel" style="display:none">
			<p>This chapter discusses:</p>
			<ul>
				<li>The terms descriptor, screen recognition, and screen description</li>
				<li>The Description tab</li>
				<li>How the Macro Facility records a description of an screen</li>
				<li>How to combine multiple descriptors</li>
				<li>The various types of descriptors</li>
			</ul>
			
			<button id="md1_screen_desc_and_recog" class="accordian">Terms defined</button>
			<div class="panel" style="display:none">
				<p>A descriptor is an XML element that occurs in the &lt;description&gt; element of a macro screen and that states an identifying of the application screen that the macro screen corresponds to.</p>
				<p>For example, a macro screen named ScreenB might contain a descriptor (&lt;string&gt; element) that states that row 3 of the screen contains the string <samp class="xph">ISPF Primary Option Menu</samp>. macro playback, when the macro runtime is determining which screen to process next, and when ScreenB is a candidate, the runtime compares the descriptor in ScreenB with the actual screen. If the descriptor matches the actual application screen (3 of the application screen really does contain the string), the macro runtime selects ScreenB as the next macro screen to be processed.</p>
				<p>Screen recognition is the process that the macro runtime when it attempts to match a candidate macro screen to the application screen.</p>
				<p>As you may remember from <button onclick="scrollHere('mc3_processing_macro_screen')">How the macro runtime processes a macro screen</button>, when the macro runtime needs to determine the next macro screen be processed, the macro runtime places the names of candidate screens (usually found in the &lt;nextscreens&gt; element of the macro screen) onto a list of valid next screens. Then, as the application updates the session window with the new application screen, the macro runtime compares the descriptors of each macro screen the list with the new application screen. Eventually the screen is updated to the extent (for example, the string <samp class="xph">Primary Option Menu</samp> appears in row 3) that the macro can match one of the macro screens on the list to the screen. The matched macro screen becomes the next macro screen be processed (see <button onclick="scrollHere('mc3_overview_of_entire_process')">Overview of the entire process (all 3 stages)</button>).</p>
				<p>Screen description is the process of adding descriptors to the &lt;description&gt; element of a macro screen. You engage in screen description when go to the Description tab of a macro screen and create or edit a (such as the String descriptor in the previous example). Likewise, the Macro object during macro recording creates one or more for each new macro screen that it creates (see <button onclick="scrollHere('mc3_recorded_descriptions')">Recorded descriptions</button>).</p>
			</div>

			<button id="md1_description_tab" class="accordian">Introduction to the Description tab</button>
			<div class="panel" style="display:none">
				<h3 id="wq101">Sample Description tab</h3>
				<p>The Description tab on the Screens tab of the Macro Editor you access to the information stored inside the &lt;description&gt; of a macro screen. <button onclick="scrollHere('md1_hame_desc_tab')">Figure 20</button> shows a Description tab:</p>
				<div class="fignone" id="md1_hame_desc_tab"><span class="figcap">Figure 20. Description tab</span>
					<div class="mmobj">
						<img src="./mb_hame_desc_tab.gif" alt="">
					</div>
				</div>
				<p class="indatacontent">In the figure above, the Screens tab of the Macro Editor selected. The name of the currently selected screen, Screen2, is in the Screen Name field at the top of the Screens tab. Below Screen Name field are the General, Description, and Actions subtabs.The Description tab is selected.</p>
				<p>As you look at Description tab in the figure above, you can that it has an upper area and a lower area.</p>
				<p> The upper area contains controls that operate on a single element considered as a whole. In particular, the Descriptor situated in the upper left corner of the Description tab the name of the currently selected descriptor. In the figure above, the currently selected descriptor is a <samp class="xph">Field Counts and OIA</samp> at the top of the list. (Descriptors do not have names. <samp class="xph">Counts and OIA</samp> is the type of the descriptor.)</p>
				<p>The lower area of the Description tab displays the contents the currently selected descriptor. Because the currently descriptor is a Fields Counts and OIA descriptor, the lower area the Description tab presents the contents appropriate to that of descriptor. If the user created and selected another type of descriptor, such as a String descriptor, then the lower area would present contents appropriate to a String descriptor.</p>
				<p>Looking more closely at the lower area of the Description tab in <button onclick="scrollHere('md1_hame_desc_tab')">Figure 20</button> , you can see that the Field Counts OIA descriptor contains three tests of identity:</p>
				<ul>
					<li>The screen contains 80 fields (the <samp class="xph">Number of Fields</samp> is set to 80).</li>
					<li>The screen contains 3 input fields (the <samp class="xph">Number of Input Fields</samp> is set to 3).</li>
					<li>The screen has the input inhibited indicator cleared (the <samp class="xph">for OIA to Become Uninhibited</samp> listbox is set to<samp class="xph"> true</samp>).</li>
				</ul>
				<p class="indatacontent">The macro runtime will apply these three tests of identity it tries to match this macro screen to an application screen.</p>
				<p>Caution: Although the Macro Editor presents the Fields Counts OIA descriptor as a single descriptor containing three tests, in the macro language defines these three tests as three separate independent descriptors. See <button onclick="scrollHere('md1_fieldcounts_and_oia')">Field Counts and OIA descriptor</button>.</p>
				<p>The lower area of the Description tab  in <button onclick="scrollHere('md1_hame_desc_tab')">Figure 20</button> also displays, for each of these tests in the Field Counts and OIA descriptor, two more fields, labeled <samp class="xph">Option</samp> and <samp class="xph">Descriptor</samp>. You can ignore these two fields for now. They described in the section <button onclick="scrollHere('md1_default_method')">Default combining method</button>.</p>
				<h4 id="md1_creating_new_descriptor">Creating a new descriptor</h4>
				<p>Looking again at the Descriptor listbox in <button onclick="scrollHere('md1_hame_desc_tab')">Figure 20</button> , you should notice that only the entry is an actual descriptor. The remaining selections, which all enclosed in angle brackets and all begin with the word <samp class="xph">new</samp>, are for creating new descriptors. Here is the list from <button onclick="scrollHere('md1_hame_desc_tab')">Figure 20</button>:</p>
				<div class="figrules" id="md1_fig_desc1"><span class="figcap">Figure 21. Contents of the Descriptor listbox with one actual descriptor</span>
					<pre class="xmp"><code>Fields Counts and &lt;new string descriptor&gt; &lt;new cursor descriptor&gt; &lt;new attribute descriptor&gt; &lt;new condition descriptor&gt; &lt;new variable update&gt;</code></pre>
				</div>
				<p>For example, if you clicked &lt;new string descriptor&gt;, the object would create a new String descriptor and place it at the of the list. The lower area of the Description tab would allow to fill out the various fields that belong to a String (such as a row and column location and a character string). The listbox would then look like this:</p>
				<div class="figrules" id="md1_fig_desc2"><span class="figcap">Figure 22. Contents of the Descriptor listbox with two actual descriptors</span>
					<pre class="xmp"><code>String descriptor(3, 29) Fields Counts and &lt;new string descriptor&gt; &lt;new cursor descriptor&gt; &lt;new attribute descriptor&gt; &lt;new condition descriptor&gt; &lt;new variable update&gt;</code></pre>
				</div>
				<p class="indatacontent">In the figure above, the currently selected descriptor is the <samp class="xph">String descriptor</samp> at the top of the list (the <samp class="xph">3,29</samp> for row 3, column 29). The <samp class="xph">Field Counts and OIA</samp> is now second on the list.</p>
				<p>For information on how the macro runtime handles multiple descriptors, as in the figure above, see <button onclick="scrollHere('md1_evaluation_of_descriptors')">Evaluation of descriptors</button>.</p>
			</div>

			<button id="mc3_recorded_descriptions" class="accordian">Recorded descriptions</button>
			<div class="panel" style="display:none">
				<h3 id="wq102">What information is recorded</h3>
				<p>During macro recording the Macro object adds one or more to the new &lt;description&gt; element of each new macro screen it creates.</p>
				<p>For the first macro screen of the macro being recorded, the object creates only one descriptor, a Field Counts and OIA with the following contents:</p>
				<ul>
					<li>The Number of Fields is set to blanks (meaning, ignore the of fields).</li>
					<li>The Number of Input Fields is set to blanks (meaning, ignore number of input fields).</li>
					<li>The Wait for OIA to Become Uninhibited field is set to true.</li>
				</ul>
				<p class="indatacontent">Therefore, when the recorded macro is played back (without been revised in any way), the macro runtime matches the first screen to its corresponding application screen based entirely on the input inhibited indicator is cleared.</p>
				<p>For every other application screen of the macro after the application screen, the Macro object likewise creates only one descriptor, a Field Counts and OIA descriptor, but with different contents:</p>
				<ul>
					<li>The Number of Fields is set to the actual number of fields the application screen (can be 0).</li>
					<li>The Number of Input Fields is set to the actual number of fields in the application screen (can be 0).</li>
					<li>The Wait for OIA to Become Uninhibited field set to true.</li>
				</ul>
				<p class="indatacontent">Therefore, when the recorded macro is played back (without been revised in any way), the macro runtime matches every macro after the first one to its corresponding application screen on whether the input inhibited indicator is cleared, whether the of fields in the macro screen's description matches the number fields in the application screen, and whether the count of input in the macro screen's description matches the number of input in the application screen.</p>
				<h3 id="wq103">Why the recorded descriptions work</h3>
				<p>The recorded descriptions work rather well for at least three reasons.</p>
				<p>First, the three parts of the Field Counts and OIA descriptor be applied unfailingly to every possible application screen. is, every application screen has some number of fields (perhaps number is 0), some number of input fields (perhaps 0), and an inhibited indicator that is either set or cleared.</p>
				<p>Second, the combination of a Number of Fields descriptor and Number of Input Fields descriptor provides a pretty reliable of an application screen, because application screens typically many fields. For example, the Utility Selection Panel shown in <button onclick="scrollHere('mx_fig_ispf_usp1')">Figure 6</button> currently contains 80 fields of all types, 3 of which are input fields. The ISPF Primary Option Menu shown in <button onclick="scrollHere('mx_fig_ispf_pom')">Figure 5</button> currently contains 116 fields of all types, 3 of which are input fields. When application screens contain fields, there is less chance of the macro runtime confusing two screens with one another because each contains the same number fields and the same number of input fields.</p>
				<p>Third, and perhaps most important, during screen recognition macro runtime compares the new application screen to a short (usually a very short list) of macro screens called valid next (see <button onclick="scrollHere('mc3_valid_next_screens')">Closer look at stage 1</button>). Therefore a single screen need not be differentiated from every other macro screen the macro, only from the other screens in the list of valid next screens.Frequently the list consists of a single macro screen.</p>
				<h3 id="wq104">Recorded descriptors provide a framework</h3>
				<p>Macro recording is a very useful feature because it quickly a framework for your macro. However, for some macro screens the description might not be sufficient to allow the macro runtime reliably distinguish one application screen from another similar screen. In such cases you should improve the recorded description.</p>
				<p>Often the most straightforward way to improve a recorded is to add a String descriptor. For example, if the macro screen for the Utility Selection Panel shown in <button onclick="scrollHere('mx_fig_ispf_usp1')">Figure 6</button>, then you might add a String descriptor specifying that the screen contains the string '<samp class="xph">Utility Selection Panel'</samp> in row 3. Of course you are not limited to using a String descriptor.Some situations might require that you use one or more of the descriptors (such as a Cursor descriptor, Attribute descriptor, Condition descriptor) to assure that the application screen is recognized.</p>
			</div>

			<button id="md1_evaluation_of_descriptors" class="accordian">Evaluation of descriptors</button>
			<div class="panel" style="display:none">
				<p>This section describes in detail how the macro runtime whether a macro screen matches an application screen.</p>
				<h3 id="wq105">Practical information</h3>
				<p>Before you read through the following subsections, you should aware of the following facts:</p>
				<ul>
					<li>In most macro screens the &lt;description&gt; element contains than one descriptor. (Remember that the Field Counts and OIA can include up to three independent descriptors. See <button onclick="scrollHere('md1_fieldcounts_and_oia')">Field Counts and OIA descriptor</button>.)</li>
					<li>The default settings in the Description tab are that all are required (the Optional setting of each descriptor is false) that the default combining rule is used.</li>
					<li>The most common scenario that you will encounter is that all are required. (That is, if you have defined three descriptors, want all three of them to be true in order for the macro screen be recognized.) If you are facing this scenario, then you should the default settings.</li>
					<li>If you are faced with a scenario that is more complicated the default scenario, then you should use the <strong>uselogic</strong> method.</li>
				</ul>
				<h3 id="wq106">Overview of the process</h3>
				<p> Here is an overview of the process. </p>
				<ol type="1">
					<li>The macro runtime evaluates each descriptor individually and at a boolean result for that descriptor, either true or false.</li>
					<li>The macro runtime then combines the boolean results of the descriptors to determine whether the description as a whole is (the macro screen matches the application screen) or false. To the results of the individual descriptors the macro runtime uses the default combining method or the <strong>uselogic </strong>method.  				<ol type="a">
							<li>With the default combining method:
								<ol type="i">
									<li>The macro runtime inverts the boolean result of any that has the Inverse Descriptor option set to true.</li>
									<li>The macro runtime combines the boolean results of the descriptors using:  								<ul>
											<li>The setting of the Optional option for each descriptor.</li>
											<li>The default rule for combining descriptors.</li>
										</ul>
									</li>
								</ol>
							</li>
							<li>In contrast, with the <strong>uselogic</strong> method:  						<ol type="i">
									<li>The macro runtime ignores the settings for Inverse and Optional.</li>
									<li>The macro runtime combines the results of individual using a rule that you provide in the <strong>uselogic</strong> attribute.</li>
								</ol>
							</li>
						</ol>
					</li>
				</ol>
				<h3 id="md1_eval_indiv_descriptors">Evaluation of individual descriptors</h3>
				<p>For each individual descriptor in the macro description, the runtime evaluates the descriptor and arrives at a boolean result true or false.</p>
				<p> For example, if the descriptor is a String descriptor, then macro runtime looks in the application screen at the row and that the descriptor specifies, and compares the string at that with the string that the descriptor specifies. If the two match, then the macro runtime assigns a value of true to the descriptor. If the two strings do not match then the macro a value of false to the String descriptor.</p>
				<p>Usually a macro screen contains more than one descriptor.</p>
				<p>However, if a macro screen contains only one descriptor (and that the descriptor does not have the Inverse Descriptor option to true) then if the single descriptor is true the entire is true, and the macro runtime recognizes the macro screen as a for the application screen. In contrast, if the single is false, then the entire description is false, and the macro is not recognized.</p>
				<h3 id="md1_default_method">Default combining method</h3>
				<p>If you have more than one descriptor in a &lt;description&gt; element, then you must use either the default combining method described this section or the <strong>uselogic </strong> attribute in <button onclick="scrollHere('md1_uselogic_attribute')">The uselogic attribute</button>.</p>
				<h4 id="wq111">When to use the default combining method</h4>
				<p>The default combining method is appropriate for only two scenarios:</p>
				<ul>
					<li>You want the description as a whole to be true only if ALL individual descriptors are true (this is the most common scenario); or</li>
					<li>You want the description as a whole to be true if AT LEAST of the individual descriptors is true.</li>
				</ul>
				<p class="indatacontent">You should not use the default method for any other scenario, unless you thoroughly understand how the default combining works.</p>
				<p>The default combining method uses:</p>
				<ul>
					<li>The boolean result for each individual descriptor (see <button onclick="scrollHere('md1_eval_indiv_descriptors')">Evaluation of individual descriptors</button>).</li>
					<li>The value of the Inverse Descriptor option in each descriptor.</li>
					<li>The value of the Optional option in each individual descriptor.</li>
					<li>The default combining rule.</li>
				</ul>
				<h4 id="md1_inverse_descriptor">Inverse Descriptor</h4>
				<p> Every descriptor has an Inverse Descriptor option that is to false (the default) or true. You can see the Inverse option as a listbox below and to the right of the Number of input field in <button onclick="scrollHere('md1_hame_desc_tab')">Figure 20</button>. The macro uses the <strong>invertmatch</strong> attribute of the element to store this option.</p>
				<p>By default this option is false, so that it has no effect on evaluation of the descriptor.</p>
				<p>If this setting is true, then the macro runtime inverts the result that it obtains from evaluating the descriptor, changing to false or false to true.</p>
				<p>For example, if the macro runtime determines that a String is true (the string in the descriptor matches the screen in the window), but the String descriptor has the Inverse Descriptor set to true, then the macro runtime changes the String descriptor'result from true to false.</p>
				<h4 id="md1_optional">Optional</h4>
				<p>Every descriptor has an Optional option that is set to either (the default) or true. You can see this option as a listbox the Number of Fields input field in <button onclick="scrollHere('md1_hame_desc_tab')">Figure 20</button>.The macro language uses the <strong>optional</strong> of the descriptor element to store this option</p>
				<p>The Optional option states how a individual descriptor's is to be treated when the macro runtime uses the default rule to combine the boolean results of the descriptors. By this option is set to false, signifying that the descriptor's is required rather than optional.</p>
				<h4 id="wq112">Default combining rule</h4>
				<p>As stated earlier, the default combining rule is appropriate only two scenarios:</p>
				<ul>
					<li>You want the description as a whole to be true only if ALL individual descriptors are true (this is the most common scenario); or</li>
					<li>You want the description as a whole to be true if AT LEAST of the individual descriptors is true.</li>
				</ul>
				<p>If you want the description as a whole to be true only if ALL descriptors are true, then set the Optional setting of all the in the description to false (the default setting).</p>
				<p>In contrast, if you want the description as a whole to be if AT LEAST ONE of the descriptors is true, then set the setting of all of the descriptors in the description to true.</p>
				<p>You should not use the default combining rule in any other where you have multiple descriptors in one macro screen, unless understand the rule and its implications thoroughly. For more see <button onclick="scrollHere('mo_default_combining_rule')">The default combining rule for multiple descriptors in one macro screen</button>.</p>
				<p>Also, you should not set the Optional settings of multiple in one macro screen differently (some true, some false) unless understand the rule and its implications thoroughly.</p>
				<h3 id="md1_uselogic_attribute">The uselogic attribute</h3>
				<p>The <strong>uselogic</strong> attribute of the &lt;description&gt; element allows you to define more complex logical relations multiple descriptors than are available with the default method described in the previous section.</p>
				<p>If you use the <strong>uselogic</strong> attribute, then macro runtime ignores the Inverse Descriptor settings and the settings in the individual descriptors.</p>
				<p>You have to add the <strong>uselogic</strong> attribute the &lt;description&gt; element manually using the the Code Editor. Macro Editor does not provide a control for this.</p>
				<p>The value of the <strong>uselogic </strong>attribute is simplified logical expression whose terms are 1-based indexes of descriptors that follow. <button onclick="scrollHere('md1_fig_uselogic')">Figure 23</button> shows example of a &lt;description&gt; element that contains a <strong>uselogic</strong> (some of the attributes of the &lt;string&gt; element are omitted clarity):</p>
				<div class="figrules" id="md1_fig_uselogic"><span class="figcap">Figure 23. Example of the uselogic attribute of the &lt;description&gt; element</span>
					<pre class="xmp"><code>&lt;description uselogic="(1 and 2) or (!1 and 3)" /&gt;    &lt;oia status="NOTINHIBITED" optional="false" invertmatch="false"/&gt;    &lt;string value="&amp;apos;Foreground&amp;apos; row="5" col="8"/&gt;    &lt;cursor row="18" col="19" optional="false" invertmatch="false"/&gt; &lt;/description&gt;</code></pre>
				</div>
				<p class="indatacontent">In the figure above the value of the <strong>uselogic</strong> is:</p>
				<pre class="xmp"><code>(1 and 2) or (!1 and 3)</code></pre>
				<p class="indatacontent">This logical expression is a regular logical expression (as described in <button onclick="scrollHere('me_conditional_expressions')">Conditional and logical operators and expressions</button>) but rather a simplified of logical expression used only in the<strong> uselogic </strong>attribute.The rules for this style of logical expression are:</p>
				<ul>
					<li>The numerals 1, 2, 3, and so on stand for the boolean of, respectively, the first, second, and third descriptors in the &lt;description&gt; element (&lt;oia&gt;, &lt;string&gt;, and &lt;cursor&gt; in the figure above).You can use any numeral for which a corresponding descriptor exists.For example, if a &lt;description&gt; element has seven descriptors, then you can use 7 to refer to the boolean result of the seventh descriptor, 6 to refer to the boolean result of the sixth descriptor, and so on.</li>
					<li>Only the following logical operators are allowed:  				<table id="md1_table_logical_ops" width="90%" summary="" border="1" frame="border" rules="all">
							<caption>Table 11. Logical operators for the uselogic attribute</caption>
							<thead valign="bottom">
								<tr>
									<th id="wq113" align="left" valign="top">Operator:</th>
									<th id="wq114" align="left" valign="top">Meaning:</th>
								</tr>
							</thead>
							<tbody valign="top">
								<tr>
									<td headers="wq113">and</td>
									<td headers="wq114">Logical AND</td>
								</tr>
								<tr>
									<td headers="wq113">or</td>
									<td headers="wq114">Logical OR (inclusive)</td>
								</tr>
								<tr>
									<td headers="wq113">!</td>
									<td headers="wq114">Logical NOT (inversion)</td>
								</tr>
							</tbody>
						</table>
					</li>
					<li>You can use parentheses () to group terms.</li>
					<li>The following entities are not allowed:  				<ul>
							<li>Arithmetic operators and expressions</li>
							<li>Conditional operators and expressions</li>
							<li>Variables</li>
							<li>Calls to Java methods</li>
						</ul>
					</li>
				</ul>
				<p>In the example in <button onclick="scrollHere('md1_fig_uselogic')">Figure 23</button> the macro will determine that the description as a whole is true if:</p>
				<ul>
					<li>The result of the first descriptor is true and the result of second descriptor is true (1 and 2); or</li>
					<li>The result of the first descriptor is false and the result the third descriptor is true (!1 and 3).</li>
				</ul>
				<p>Remember that if you use the <strong>uselogic</strong> attribute, then the macro runtime ignores the Inverse Descriptor settings the Optional settings in the individual descriptors.</p>
			</div>

			<button id="wq115" class="accordian">The descriptors</button>
			<div class="panel" style="display:none">
				<h3 id="wq116">Overview</h3>
				<p>Each type of descriptor is stored as an individual XML situated within the &lt;description&gt; element of one macro screen.</p>
				<p>You do not have to understand all the types of descriptors at first.Instead you should begin by becoming familiar with just two types:</p>
				<ul>
					<li>The Fields Counts and OIA descriptor (actually contains 3 descriptors)</li>
					<li>The String descriptor</li>
				</ul>
				<p class="indatacontent">These types of descriptors are sufficient to reliably many and perhaps even most application screens. However, if types are not sufficient, then you should turn for help to one the other types of descriptors.</p>
				<p><button onclick="scrollHere('md1_table_descriptors')">Table 12</button> lists all the types of and shows the number of descriptors of each type that are to exist in one macro screen (more specifically, in one &lt;description&gt; element belonging to one &lt;screen&gt; element):</p>
				<table id="md1_table_descriptors" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 12. Types of descriptors, how many of each type allowed</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq117" align="left" valign="top">Type of descriptor:</th>
							<th id="wq118" align="left" valign="top">Number of this type of allowed per macro screen:</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td headers="wq117">Field Counts and OIA</td>
							<td headers="wq118">1 (required)</td>
						</tr>
						<tr>
							<td headers="wq117">String descriptor</td>
							<td headers="wq118">0 or more</td>
						</tr>
						<tr>
							<td headers="wq117">Cursor descriptor</td>
							<td headers="wq118">0 or 1</td>
						</tr>
						<tr>
							<td headers="wq117">Attribute descriptor</td>
							<td headers="wq118">0 or more</td>
						</tr>
						<tr>
							<td headers="wq117">Condition descriptor</td>
							<td headers="wq118">0 or more</td>
						</tr>
					</tbody>
				</table>
				<p class="indatacontent">The following subsections describe each type of in detail.</p>
				<h3 id="md1_fieldcounts_and_oia">Field Counts and OIA descriptor</h3>
				<h4 id="wq119">Required</h4>
				<p>The Field Counts and OIA descriptor is required and must be unique.That is, every Description tab (&lt;description&gt; element) must one and only one Field Counts and OIA descriptor.</p>
				<p>This fact should not cause you any trouble in practice, for following reasons:</p>
				<ul>
					<li>Although the Field Counts and OIA descriptor itself is required, only one of the three tests that it contains is required. the actual requirement is that every Description tab must one and only one Wait for OIA to Become Uninhibited descriptor.</li>
					<li>The Macro Editor and the Code Editor enforce these rules and not let you mistakenly include more than one Field Counts and descriptor in a Description tab (or &lt;description&gt; element). example,  				<ul>
							<li>The Delete button on the Description tab does not have any when you try to delete the Field Counts and OIA descriptor.</li>
							<li>The Descriptor listbox on the Description tab does not a &lt;new&gt; entry for the Field Counts and OIA descriptor.</li>
						</ul>
					</li>
				</ul>
				<h4 id="wq120">Presents three separate and independent descriptors as if one</h4>
				<p>For user friendliness and for certain design reasons that are discussed here, the Macro Editor presents the Field Counts and descriptor as one descriptor (see <button onclick="scrollHere('md1_hame_desc_tab')">Figure 20</button>).However, in fact each of the three parts of the Field Counts and descriptor on the Description tab of the Macro Editor to a separate and independent descriptor in the underlying XML language. Specifically:</p>
				<ul>
					<li>The Number of Fields setting is stored as a &lt;numfields&gt; descriptor.</li>
					<li>The Number of Input Fields setting is stored as a &lt;numinputfields&gt; descriptor.</li>
					<li>The Wait for OIA to Become Uninhibited setting is stored as an &lt;oia&gt; descriptor.</li>
				</ul>
				<p><button onclick="scrollHere('md1_table_3_descriptors')">Table 13</button> lists these three of descriptors and shows how many of each can occur within a &lt;description&gt; element:</p>
				<table id="md1_table_3_descriptors" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 13. Number of each descriptor type allowed</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq121" align="left" valign="top">Type of descriptor:</th>
							<th id="wq122" align="left" valign="top">Number of this type of allowed per macro screen (that is, per &lt;description&gt; element):</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td headers="wq121">&lt;oia&gt;</td>
							<td headers="wq122">1 (required)</td>
						</tr>
						<tr>
							<td headers="wq121">&lt;numfields&gt;</td>
							<td headers="wq122">1 (optional)</td>
						</tr>
						<tr>
							<td headers="wq121">&lt;numinputfields&gt;</td>
							<td headers="wq122">1 (optional)</td>
						</tr>
					</tbody>
				</table>
				<p class="indatacontent">As the table above shows, only one of each type of these can occur in a &lt;description&gt; element. The &lt;oia&gt; descriptor required, but the &lt;numfields&gt; descriptor and the &lt;numinputfields&gt; descriptor are optional. The Macro Editor enforces these rules.</p>
				<p>You can reinforce these ideas in your mind by looking at a Counts and OIA descriptor first as it appears on the Description of the Macro Editor and then in the Code Editor. <button onclick="scrollHere('md1_hame_desc_tab')">Figure 20</button> shows a Field Counts and OIA on the Description tab of the Macro Editor. The settings of the parts of the Field Counts and OIA descriptor are set as follows:</p>
				<pre class="xmp"><code>Number of Fields:  Number of Input fields:  Wait for OIA to Become Uninhibited:  true</code></pre>
				<p class="indatacontent">But if you look the corresponding &lt;description&gt; element with the Code Editor, see the following:</p>
				<div class="figrules" id="md1_fig_three_descriptors"><span class="figcap">Figure 24. A &lt;description&gt; element with three descriptors</span>
					<pre class="xmp"><code>&lt;description&gt;    &lt;oia status="NOTINHIBITED" optional="false" invertmatch="false" /&gt;    &lt;numfields number="80" optional="false" invertmatch="false" /&gt;    &lt;numinputfields number="3" optional="false" invertmatch="false" /&gt; &lt;/description&gt;</code></pre>
				</div>
				<p class="indatacontent">The XML code fragment above shows that the &lt;description&gt; element contains three separate and independent descriptors, corresponding to one of the three parts of the Field Counts and descriptor.</p>
				<p>Now suppose if you will that you change the Field Counts and descriptor settings to be as follows:</p>
				<pre class="xmp"><code>Number of Fields:  (blank) Number of Input fields:  (blank) Wait for OIA to Become Uninhibited:  true</code></pre>
				<p class="indatacontent">Setting the first fields to blank tells the Macro Editor that these items are not be included in the script. If you look again at the corresponding &lt;description&gt; element with Code Editor you now see:</p>
				<pre class="xmp"><code>&lt;description&gt;    &lt;oia status="NOTINHIBITED" optional="false" invertmatch="false" /&gt; &lt;/description&gt;</code></pre>
				<p class="indatacontent">The XML code fragment above shows that the &lt;description&gt; element now contains only one descriptor, an &lt;oia&gt; descriptor to the Wait for OIA to Become Uninhibited setting in the Field and OIA descriptor.</p>
				<h4 id="wq123">Treatment during screen recognition</h4>
				<p>During screen recognition, when the macro runtime evaluates descriptors and combines the boolean results, the macro runtime the &lt;oia&gt; descriptor, the &lt;numfields&gt; descriptor (if it is present), and the &lt;numinputfields&gt; descriptor (if it is present) each a separate and independent descriptor, one like any other descriptor.</p>
				<p>For more information about evaluating multiple descriptors see <button onclick="scrollHere('md1_evaluation_of_descriptors')">Evaluation of descriptors</button></p>
				<h4 id="md1_oia">Wait for OIA to Become Uninhibited descriptor (&lt;oia&gt; element)</h4>
				<p><button onclick="scrollHere('md1_table_oia')">Table 14</button> shows:</p>
				<ul>
					<li>The three permissible settings for the Wait for OIA to Uninhibited listbox.</li>
					<li>The corresponding values used in the &lt;oia&gt; element.</li>
					<li>How the macro runtime evaluates the setting.</li>
				</ul>
				<table id="md1_table_oia" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 14.  Valid settings for the descriptor Wait for OIA to Become Uninhibited</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq124" align="left" valign="top">Setting on the Description tab:</th>
							<th id="wq125" align="left" valign="top">Value of the<samp class="xph"> status</samp> in the &lt;oia&gt; element:</th>
							<th id="wq126" align="left" valign="top">Meaning:</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td headers="wq124"><samp class="xph">true</samp></td>
							<td headers="wq125">NOTINHIBITED</td>
							<td headers="wq126">If the input inhibited indicator in the window is cleared (that is, input is not inhibited) then the runtime evaluates the descriptor as true. Otherwise the macro evaluates the descriptor as false.</td>
						</tr>
						<tr>
							<td headers="wq124"><samp class="xph">false</samp></td>
							<td headers="wq125">DONTCARE</td>
							<td headers="wq126">The macro runtime always evaluates the as true.</td>
						</tr>
						<tr>
							<td headers="wq124"><samp class="xph">&lt;Expression&gt;</samp></td>
							<td headers="wq125">'NOTINHIBITED', 'DONTCARE', or any that evaluates to one of these strings.</td>
							<td headers="wq126">The macro runtime evaluates the expression then interprets the resulting string.</td>
						</tr>
					</tbody>
				</table>
				<p>In almost all scenarios you can accept the default setting this descriptor, which is true (on the Description tab) and (in the macro language). Then, during screen recognition:</p>
				<ul>
					<li>If the input inhibited indicator in the session window is (that is, input is inhibited), then the macro runtime will this descriptor as false.</li>
					<li>But if the input inhibited indicator is cleared (that is, is not inhibited), then the macro runtime will evaluate this as true.</li>
				</ul>
				<p class="indatacontent">These are the results that you would want and expect. You do not want the macro runtime to recognize the macro screen and start processing its actions while the input inhibited indicator still set. An important timing issue is involved here, which you read about separately (see <button onclick="scrollHere('mt_screen_completion')">Screen completion</button>). no matter how you resolve that issue, you should almost always this descriptor at the default setting, which is true.</p>
				<p>However, if you have a scenario in which you want the macro to ignore the input inhibited condition, then set this to false on the Description tab (the equivalent setting in the language is DONTCARE).</p>
				<h5 id="md1_oia_hostid">Specifying a session</h5>
				<p>Use the Host ID field to specify the session to which you this descriptor to refer:</p>
				<ul>
					<li>If you want this descriptor to refer to the session that the macro, then leave the Host ID field blank.</li>
					<li>If you want this descriptor to refer to some other session, a session reference into the Host ID field (see <button onclick="scrollHere('ms_hostid')">Specifying a Host ID</button>).</li>
				</ul>
				<p>If the referenced session is active, then you can use any editing feature with the referenced session (see <button onclick="scrollHere('ms_auto_edit')">Using automatic editing features with other sessions</button>).</p>
				<h4 id="md1_numfields">Number of Fields descriptor (&lt;numfields&gt; element)</h4>
				<p>The Number of Fields descriptor specifies a particular number 3270 (or 5250) fields. You can use an integer in the Number of input field, or any entity that evaluates to an integer (such as variable, an arithmetic expression, or a call to an external method).</p>
				<p>During screen recognition the macro runtime:</p>
				<ol type="1">
					<li>Evaluates this descriptor and obtains an integer result.</li>
					<li>Counts the number of fields in the application screen (in current state).</li>
					<li>Compares the two numbers.</li>
				</ol>
				<p class="indatacontent">If the two numbers are equal then the macro runtime this descriptor as true. Otherwise the macro runtime evaluates descriptor as false.</p>
				<p>When the macro runtime counts the fields in the session it counts all types of 3270 (or 5250) fields, including input fields.</p>
				<p>If you do not want to use this descriptor then set the Number Fields input field to blank.</p>
				<h5 id="md1_numfields_hostid">Specifying a session</h5>
				<p>Use the Host ID field to specify the session to which you this descriptor to refer:</p>
				<ul>
					<li>If you want this descriptor to refer to the session that the macro, then leave the Host ID field blank.</li>
					<li>If you want this descriptor to refer to some other session, a session reference into the Host ID field (see <button onclick="scrollHere('ms_hostid')">Specifying a Host ID</button>).</li>
				</ul>
				<p>If the referenced session is active, then you can use any editing feature with the referenced session (see <button onclick="scrollHere('ms_auto_edit')">Using automatic editing features with other sessions</button>).</p>
				<h4 id="md1_numinputfields">Number of Input Fields descriptor (&lt;numinputfields&gt; element)</h4>
				<p>The Number of Input Fields descriptor is very similar to the of Fields descriptor described in the previous section. The is that the Number of Input Fields descriptor specifies a number 3270 (or 5250) input fields, whereas the Number of Fields specifies a number of fields of all types, including input fields.</p>
				<p>You can use an integer in the Number of Input Fields field, any entity that evaluates to an integer (such as a variable, an expression, or a call to an external Java method).</p>
				<p>During screen recognition the macro runtime: </p>
				<ol type="1">
					<li>Evaluates this descriptor and obtains an integer result.</li>
					<li>Counts the number of input fields in the application screen (its current state).</li>
					<li>Compares the two numbers.</li>
				</ol>
				<p class="indatacontent">If the two numbers are equal then the macro runtime this descriptor as true. Otherwise the macro runtime evaluates descriptor as false.</p>
				<p>If you do not want to use this descriptor then set the Number Input Fields field to blank.</p>
				<h5 id="md1_numinputfields_hostid">Specifying a session</h5>
				<p>Use the Host ID field to specify the session to which you this descriptor to refer:</p>
				<ul>
					<li>If you want this descriptor to refer to the session that the macro, then leave the Host ID field blank.</li>
					<li>If you want this descriptor to refer to some other session, a session reference into the Host ID field (see <button onclick="scrollHere('ms_hostid')">Specifying a Host ID</button>).</li>
				</ul>
				<p>If the referenced session is active, then you can use any editing feature with the referenced session (see <button onclick="scrollHere('ms_auto_edit')">Using automatic editing features with other sessions</button>).</p>
				<h4 id="md1_use_field_counts">Counting fields in the session window during macro development</h4>
				<p>When you are editing a Field Counts and OIA descriptor and want to set the Number of Fields field and the Number of Input field to the correct values, you can use the Current button each input field to count the fields in the application screen you.</p>
				<p>To use this feature follow these steps:</p>
				<ol type="1">
					<li>Click on the session window to activate it (see <button onclick="scrollHere('mg_using_session_window')">Using the session window</button>).</li>
					<li>In the session window, go to the application screen to the macro screen that you are working on.</li>
					<li>In the Description tab select the Field Counts and OIA descriptor.</li>
					<li>On the Description tab click the Current button immediately the right of the Number of Fields input field. The Macro Editor the number of fields in the current application screen and then the count in the input field.</li>
					<li>On the Description tab click the Current button immediately the right of the Number of Input Fields input field. The Macro counts the number of input fields in the current application and then displays the count in the input field.</li>
				</ol>
				<h3 id="md1_string">String descriptor (&lt;string&gt; element)</h3>
				<p>The String descriptor specifies the following information:</p>
				<ul>
					<li>A sequence of characters (the string).</li>
					<li>A rectangular area of text on the session window.</li>
				</ul>
				<p>The macro runtime searches inside the entire rectangular area text for the string you specify. If the macro runtime finds the inside the rectangular area of text, then it evaluates the descriptor as true. If not, then it evaluates the string as false.</p>
				<h4 id="wq130">Specifying the rectangular area</h4>
				<p>You define the rectangular area of text by specifying the row column coordinates of opposite corners. The default values for coordinates are (1,1) and (-1,-1), indicating the entire text of the session window (for the significance of negative values as -1,-1, see <button onclick="scrollHere('me1_negative_row_or_col')">Significance of a negative value for a row or column</button>). You can an integer or any entity that evaluates to an integer (such as a variable, an arithmetic expression, or a call to an external Java method).</p>
				<p>The rectangular area can be just large enough to contain the string, or much larger than the string. For example, suppose that the screen that you want to match to the macro screen has the string <samp class="xph">'and user parameters'</samp> in the rectangular area (6,20), (6,37).This rectangular area is exactly large enough to contain the string.If the application screen always has this string at this location, then you might specify the exact rectangular area.</p>
				<p>However, suppose that the application screen that you want to to the macro screen has the same string, <samp class="xph">'Terminal and user parameters'</samp>, located somewhere on it, but that you cannot predict which row the application screen will contain the string. In this case you specify the rectangular area (1,1), (-1,-1), indicating that the runtime should search every row of the application screen for identifying string.</p>
				<p>For the string value you can use a string or any entity that to a string (such as a variable, an expression, or a call to an Java method). The string must be in the form required by the format that you have chosen, either basic or advanced (see <button onclick="scrollHere('mg_string_error')">Error in specifying a string</button>).</p>
				<p>During screen recognition the macro runtime:</p>
				<ol type="1">
					<li>Evaluates the row and column values and obtains an integer for each value.</li>
					<li>Evaluates the string value and obtains a string result.</li>
					<li>Looks for the string anywhere within the rectangular block text in the application screen (in its current state) specified the row and column values.</li>
				</ol>
				<p>If the the macro runtime finds the string within the block of text then the macro runtime evaluates this descriptor true. Otherwise the macro runtime evaluates this descriptor as false.</p>
				<h4 id="md_wrap_option">How the macro runtime searches the rectangular area (Wrap option)</h4>
				<p>If the Wrap option is set to false (the default setting), the macro runtime searches each row of the rectangular area separately.This method works well when the entire string is contained one row. For example, if the string is <samp class="xph">Utility Selection Panel</samp> the rectangular area is (1,1), (24,80), then the macro runtime for the string as follows:</p>
				<ol type="1">
					<li>Get the first row of the rectangular area. Determine whether string occurs in the this row. If it does not, then search the row.</li>
					<li>Get the second row of the rectangular area. Determine the string occurs in this row. If it does not, then search the row.</li>
					<li>And so on.</li>
				</ol>
				<p>In contrast, if the Wrap option is set to true then the macro searches for the string as follows:</p>
				<ol type="1">
					<li>Get all the lines of the rectangular area and concatenate all in order.</li>
					<li>Determine whether the string occurs in the concatenated string.</li>
				</ol>
				<p>If the string you are searching for can wrap from one line to next of the session window, then you should set the Wrap option true. Do not confuse this option with the Unwrap attribute of Extract action, which is based on fields rather than blocks of (see <button onclick="scrollHere('ma_unwraptext')">Unwrap Text option</button>).</p>
				<p>The following description provides an example in which the option is set to true.</p>
				<p><button onclick="scrollHere('md_fig_rect_block')">Figure 25</button> shows rows 14 through 18 of application screen:</p>
				<div class="figrules" id="md_fig_rect_block"><span class="figcap">Figure 25. Rows 14-18 of an application screen</span>
					<pre class="xmp"><code> 6  Hardcopy    Initiate hardcopy  7  Transfer    Download ISPF Client/Server or Transfer data  8  Outlist     Display, delete, or print held job  9  Commands    Create/change an application command  *  Reserved    This option reserved for future expansion</code></pre>
				</div>
				<p class="indatacontent">In the rows above, the first character of each row is a space. For example, in row 14, the the first two characters are <samp class="xph">' 6'</samp>, that is, a blank space followed by the numeral 6. that you want to set up a String descriptor that checks for the rectangular block of text on this application screen:</p>
				<pre class="xmp"><code>Reserved</code></pre>
				<p>The steps in setting up the String descriptor for this multi-block are as follows:</p>
				<ol type="1">
					<li>Create a new String descriptor.</li>
					<li>Set the values in the Row and Column fields. The row and location of the upper left corner of the text rectangle above is (14, 5) and the row and column location of the lower right corner is (18, 12).</li>
					<li>Set the string value. The string value is: <pre class="xmp"><code>'HardcopyTransferOutlist CommandReserved'</code></pre></li>
					<li>Set the Wrap option to true.</li>
					<li>Leave all the other options set to the default.</li>
				</ol>
				<p class="indatacontent">Notice that in step 3 above the five rows are concatenated a single string, without any filler characters added (such as a or space at the end). However, the string does contain a blank after <samp class="xph">'Outlist'</samp> because that blank space does fall the boundaries of the rectangle.</p>
				<h5 id="wq135">Using an extracted string in a String descriptor</h5>
				<p>If you use an Extract action to read text from the screen a string variable (see <button onclick="scrollHere('ma_extract')">Extract action (&lt;extract&gt; element)</button>) then in a screen you can use the string variable in the String input field a String descriptor.</p>
				<p>For example, in ScreenA you might read a company name from session window into a string variable named $strTmp$, using an action. Then in ScreenB you could use $strTmp$ as the string to searched for in a String descriptor.</p>
				<p>You can do this when extracting multiple lines of text if you the Wrap option set to true.</p>
				<h4 id="wq136">The '*' string in a new String descriptor</h4>
				<p>When you create a new String descriptor the Macro Editor the string <samp class="xph">'*'</samp> into the String input field as an initial, default value. Just erase this initial string and fill in the that you want. The asterisk (*) does not mean anything or have function. The initial string could say 'Default string value' have the same effect.</p>
				<h4 id="wq137">Easy method for filling in the parameters</h4>
				<p>When you are editing a String descriptor and you want to the correct text rectangle and text string, you can use the rectangle to set these values. To use this feature follow these steps:</p>
				<ol type="1">
					<li>In the Descriptions tab, select the String descriptor that want to edit.</li>
					<li>Click on the session window to activate it (see <button onclick="scrollHere('mg_using_session_window')">Using the session window</button>).</li>
					<li>In the session window, go to the application screen to the macro screen that you are working on.</li>
					<li>In the session window, use the marking rectangle to mark the of text that you want to use in the String descriptor (see <button onclick="scrollHere('mg_bounding_rectangle')">Using the marking rectangle</button>).
						<ul>
							<li>When you complete the marking rectangle in the session window, the Macro Editor automatically copies the row and column values the corners of the rectangle into the Start Row, Start Column, Row, and End Column input fields in the String descriptor window the Description tab.</li>
						</ul>
					</li>
					<li>In the session window, click Edit &gt; Copy.</li>
					<li>In the String descriptor window, click the String field. the text cursor in the String field to the position at which you to add the string.</li>
					<li>Click Ctrl-v.</li>
					<li>If you captured a rectangle containing more than one row of from the session window, then the string requires further editing.Read the description below of how to edit the string.</li>
				</ol>
				<p class="indatacontent">When you click Ctrl-v the Macro Editor does the following:</p>
				<ul>
					<li>Copies the text from the rectangular block in the session into the String field.</li>
				</ul>
				<p>However, if you captured more than one row of text (as in the in <button onclick="scrollHere('md_wrap_option')">How the macro runtime searches the rectangular area (Wrap option)</button>), then the paste operation an extra space after each row of text except the last. Edit the field to remove these extra spaces. In the example in <button onclick="scrollHere('md_wrap_option')">How the macro runtime searches the rectangular area (Wrap option)</button>, the String field contains the following before editing:</p>
				<pre class="xmp"><code>'Hardcopy Transfer Outlist  Command Reserved'</code></pre>
				<p>Notice that the string is too long (by 4 characters) to fit the rectangle of the specified size (5 rows, 8 columns), and an extra blank space has been inserted after each row. You edit the string to the following value:</p>
				<pre class="xmp"><code>'HardcopyTransferOutlist CommandReserved'</code></pre>
				<h4 id="wq139">Multiple String descriptors in the same &lt;description&gt; element</h4>
				<p>The Macro Editor does not prevent you from creating more than String descriptor in the same &lt;description&gt; element. You use as many String descriptors as you need in order to create a description.</p>
				<p>You can even define two different strings for the same block of text in the same &lt;description&gt; element. You might do if the application screen corresponding to your macro screen different strings in the same location at different times. However, if you do define two different strings for the same rectangular of text, you should be careful to indicate that both of the are not required (both are optional).</p>
				<h4 id="md1_string_hostid">Specifying a session</h4>
				<p>Use the Host ID field to specify the session to which you this descriptor to refer:</p>
				<ul>
					<li>If you want this descriptor to refer to the session that the macro, then leave the Host ID field blank.</li>
					<li>If you want this descriptor to refer to some other session, a session reference into the Host ID field (see <button onclick="scrollHere('ms_hostid')">Specifying a Host ID</button>).</li>
				</ul>
				<p>If the referenced session is active, then you can use any editing feature with the referenced session (see <button onclick="scrollHere('ms_auto_edit')">Using automatic editing features with other sessions</button>).</p>
				<h3 id="md1_cursor">Cursor descriptor (&lt;cursor&gt; element)</h3>
				<p>The Cursor descriptor specifies a row and column location on application screen, such as row 10 and column 50. For either the value or the column value you can use an integer or any entity evaluates to an integer (such as a variable, an arithmetic expression, or a call to an external Java method).</p>
				<p>During screen recognition the macro runtime:</p>
				<ol type="1">
					<li>Evaluates the row value and obtains an integer result.</li>
					<li>Evaluates the column value and obtains an integer result.</li>
					<li>Looks at the row and column location of the text cursor in application screen (in its current state).</li>
					<li>Compares the row and column location in the descriptor with row and column location of the text cursor in the application screen.</li>
				</ol>
				<p>If the two locations are the same then the macro runtime this descriptor as true. Otherwise the macro runtime evaluates descriptor as false.</p>
				<p>When you are editing a Cursor descriptor and you want to the correct row and column values, you can use the Current button.The Current button is situated immediately to the right of the and Column fields in the Cursor descriptor window.</p>
				<p>To use this feature follow these steps:</p>
				<ol type="1">
					<li>Click on the session window to activate it (see <button onclick="scrollHere('mg_using_session_window')">Using the session window</button>).</li>
					<li>In the session window, go to the application screen to the macro screen that you are working on.</li>
					<li>In the session window, use the mouse or the keyboard to set text cursor to the location that you want.</li>
					<li>In the Cursor descriptor window click Current.</li>
				</ol>
				<p class="indatacontent">When you click Current the Macro Editor does the following:</p>
				<ul>
					<li>Finds the location of the text cursor in the current session and sets the Row and Column values to that location.</li>
				</ul>
				<h4 id="md1_cursor_hostid">Specifying a session</h4>
				<p>Use the Host ID field to specify the session to which you this descriptor to refer:</p>
				<ul>
					<li>If you want this descriptor to refer to the session that the macro, then leave the Host ID field blank.</li>
					<li>If you want this descriptor to refer to some other session, a session reference into the Host ID field (see <button onclick="scrollHere('ms_hostid')">Specifying a Host ID</button>).</li>
				</ul>
				<p>If the referenced session is active, then you can use any editing feature with the referenced session (see <button onclick="scrollHere('ms_auto_edit')">Using automatic editing features with other sessions</button>).</p>
				<h3 id="md1_attribute">Attribute descriptor (&lt;attrib&gt; element)</h3>
				<p>The attribute descriptor specifies a 3270 or 5250 attribute a row and column location on the application window.</p>
				<p>During screen recognition the macro runtime compares the attribute (such as 0x3) to the actual attribute at the row and specified. If the attributes are the same, then the macro evaluates the descriptor as true. Otherwise the macro runtime the descriptor as false.</p>
				<p>This descriptor can be useful when you are trying to between two application screens that are very similar except for attributes.</p>
				<h4 id="wq142">Specifying an attribute</h4>
				<p>Before you specify an attribute, use the Data Plane listbox select the data plane in which the attribute that you are for occurs. If you select <samp class="xph">&lt;Expression&gt;</samp> then you specify an expression (such as a variable named $strDataPlane$) resolves at runtime to one of the data plane strings in the (<samp class="xph">FIELD_PLANE</samp>,<samp class="xph"> COLOR_PLANE</samp>, or <samp class="xph">EXFIELD_PLANE</samp>).</p>
				<p>Use the Row and Column input fields to specify the Row and location on the application screen of the attribute that you are for.</p>
				<p>You can use any one of three methods to specify an attribute value:</p>
				<ul>
					<li>Click the session window and move the text cursor to the row column location of an attribute like the one that you want in the Attribute descriptor, then click Current in the Macro Editor; or</li>
					<li>Click Edit Attributes and use the controls on the popup window; or</li>
					<li>Type the value into the Attribute Value input field (for example, <samp class="xph">0x3</samp>).</li>
				</ul>
				<h4 id="md1_attribute_hostid">Specifying a session</h4>
				<p>Use the Host ID field to specify the session to which you this descriptor to refer:</p>
				<ul>
					<li>If you want this descriptor to refer to the session that the macro, then leave the Host ID field blank.</li>
					<li>If you want this descriptor to refer to some other session, a session reference into the Host ID field (see <button onclick="scrollHere('ms_hostid')">Specifying a Host ID</button>).</li>
				</ul>
				<p>If the referenced session is active, then you can use any editing feature with the referenced session (see <button onclick="scrollHere('ms_auto_edit')">Using automatic editing features with other sessions</button>).</p>
				<h3 id="md_condition">Condition descriptor (&lt;condition&gt;) element</h3>
				<p>The Condition descriptor specifies a conditional expression the macro runtime evaluates during screen recognition, such as <samp class="xph">$intNumVisits$ == 0</samp>. For more information on conditional expressions see <button onclick="scrollHere('me_conditional_expressions')">Conditional and logical operators and expressions</button>.</p>
				<p>During screen recognition the macro runtime:</p>
				<ul>
					<li>Evaluates the conditional expression and obtains a boolean result.</li>
				</ul>
				<p>If the conditional expression evaluates to true then the runtime evaluates this descriptor as true. Otherwise the macro evaluates this descriptor as false.</p>
				<p>The Condition descriptor increases the flexibility and power screen recognition by allowing the macro runtime to determine next macro screen to be processed based on the value of one or variables or on the result of a call to a Java method.</p>
				<h3 id="md_customreco">Custom descriptor (&lt;customreco&gt; element)</h3>
				<p>The Custom descriptor allows you to call custom description code.</p>
				<p>To use a Custom descriptor you need the separate Host Access product.</p>
				<p>To create a Custom descriptor you must use the Code Editor to an &lt;customreco&gt; element to the &lt;description&gt; element of macro screen. For more information on this element see <button onclick="scrollHere('mr_customreco')">&lt;customreco&gt; element</button>.</p>
			</div>

			<button id="md1_var_update" class="accordian">Variable update action (&lt;varupdate&gt; element)</button>
			<div class="panel" style="display:none">
				<p>The final type of entry that can occur in the Descriptor is the Variable update entry, which is not a descriptor at all, rather an action that the macro language allows to occur inside a &lt;description&gt; element.</p>
				<p>The Variable update action in a &lt;description&gt; element the very same type of operation that it performs in an &lt;actions&gt; element, which is to store a specified value into a specified variable.</p>
				<p> For information about creating a Variable update action see <button onclick="scrollHere('ma_varupdate')">Variable update action (&lt;varupdate&gt; element)</button>.</p>
				<h3 id="md1_vu_process">Processing a Variable update action in a description</h3>
				<p>You should be aware of how the macro runtime processes one or Variable update actions when they occur in a &lt;description&gt; element:</p>
				<ol type="1">
					<li>The macro runtime performs all the Variable update actions immediately, as if they were first in sequence.</li>
					<li>The macro runtime then evaluates the remaining items (descriptors) in the description as usual and arrives at an overall boolean result.The Variable update actions have no effect on the boolean result.</li>
				</ol>
				<p>As you might remember, the macro runtime can go through the recognition process a number of times before matching a macro to an application screen (see <button onclick="scrollHere('mc3_again_tries_to_match')">Re-doing the evaluation</button>).Therefore, if a &lt;description&gt; element contains one or more update actions, then the macro runtime will perform the Variable actions each time that it evaluates the &lt;description&gt; element.</p>
				<p>For example, suppose that a macro is being played back, that screen name ScreenB is on the list of valid next screens, and ScreenB contains a &lt;description&gt; element like the one shown in <button onclick="scrollHere('md_fig_screenb_desc')">Figure 26</button>:</p>
				<div class="figrules" id="md_fig_screenb_desc"><span class="figcap">Figure 26. The &lt;description&gt; element of ScreenB</span>
					<pre class="xmp"><code>&lt;description&gt;    &lt;oia status="NOTINHIBITED" optional="false" invertmatch="false" /&gt;    &lt;varupdate name="$boolUpdate$" value="true" /&gt;    &lt;attrib value="0x4" row="1" col="1" plane="COLOR_PLANE" optional="false"                invertmatch="false" /&gt; &lt;/description&gt;</code></pre>
				</div>
				<p class="indatacontent">Each time that the macro runtime tries to match ScreenB to current application screen:</p>
				<ol type="1">
					<li>The macro runtime sees the &lt;varupdate&gt; action and it, storing the value <samp class="xph">true</samp> into <samp class="xph">$boolUpdate$</samp>.</li>
					<li>The macro runtime evaluates the &lt;oia&gt; descriptor and the &lt;attrib&gt; descriptor and arrives at a boolean result for the entire &lt;description&gt; element.</li>
				</ol>
				<h3 id="md1_vu_diff_sequence">Variable update with the <strong>uselogic</strong> attribute</h3>
				<p>If you want the macro runtime to perform a Variable update in a &lt;description&gt; element in some other sequence than first, can change the order of execution by using the &lt;description&gt; element's <strong>uselogic</strong> attribute instead of the default rule (see <button onclick="scrollHere('md1_uselogic_attribute')">The uselogic attribute</button>).</p>
				<p>When a Variable update action is used in a <strong>uselogic</strong> attribute:</p>
				<ul>
					<li>The macro runtime performs the Variable update action in the order in which it occurs in the <strong>uselogic</strong> attribute.</li>
					<li>The macro runtime always evaluates the Variable update to true.</li>
				</ul>
			</div>
		</div>

		<button id="ma_actions_part1" class="accordian">Macro actions</button>
		<div class="panel" style="display:none">

			<button id="wq145" class="accordian">In general</button>
			<div class="panel" style="display:none">
				<h3 id="wq146">The actions by function</h3>
				<p> Here is a list of all the actions, grouped according to function. </p>
				<ul>
					<li>Interaction with the user:  				<ul>
							<li>Box selection</li>
							<li>Input (keystrokes and key-activated functions, such as copy clipboard)</li>
							<li>Message</li>
							<li>Mouse click</li>
							<li>Prompt</li>
						</ul>
					</li>
					<li>Getting data from the application and sending data to the  				<ul>
							<li>Extract</li>
							<li>FileUpload</li>
							<li>SQLQuery</li>
							<li>Transfer (file transfers between host and client, either or download)</li>
							<li>Variable update</li>
						</ul>
					</li>
					<li>
						<ul>
							<li>Comm wait</li>
							<li>Pause</li>
						</ul>
					</li>
					<li>
						<ul>
							<li>Conditional</li>
							<li>Perform (call a Java method)</li>
							<li>PlayMacro (chain to another macro)</li>
							<li>Run program (launch a program on the client operating system)</li>
							<li>Variable update</li>
						</ul>
					</li>
					<li>
						<ul>
							<li>Print extract</li>
							<li>Print start</li>
							<li>Print end</li>
							<li>Run program (launch a program on the client operating system)</li>
						</ul>
					</li>
					<li>
						<ul>
							<li>Trace</li>
						</ul>
					</li>
				</ul>
				<h3 id="wq147">How actions are performed</h3>
				<h4 id="wq148">The runtime context</h4>
				<p>As you may remember from <button onclick="scrollHere('mc3_processing_macro_screen')">How the macro runtime processes a macro screen</button>, when the macro runtime has selected a new current macro screen, macro runtime immediately begins to perform the actions in the &lt;actions&gt; element of that macro screen.</p>
				<p>After the macro runtime has performed all the actions, it goes on to the next step of determining the next macro screen to processed.</p>
				<h4 id="wq149">The macro screen context</h4>
				<p>Within a single macro screen, the macro runtime performs the in the order in which they occur in the &lt;actions&gt; element. is the same order in which you haved ordered the actions in the listbox.</p>
				<p>You are not required to create any actions for a macro screen.If there is no &lt;actions&gt; element or if the &lt;actions&gt; is empty, then the macro runtime goes straight to the next of macro screen processing, which is selecting the next macro to be processed.</p>
				<h3 id="wq150">Specifying parameters for actions</h3>
				<p>In specifying the parameters of an action, remember that, in general, any context that accepts an immediate value of a particular data type also accepts any entity of the same data type. For example, if an input field accepts a string value, then it also accepts expression that evaluates to a string, a value that converts to string, a string variable, or a call to an imported method that a string (see <button onclick="scrollHere('me_equivalents')">Equivalents</button>).</p>
				<p>However, there are a few fields in which you cannot use (see <button onclick="scrollHere('mv_where_use_variables')">Using the value that the variable holds</button>).</p>
			</div>

			<button id="ma_actions_tab" class="accordian">Introduction to the Actions tab</button>
			<div class="panel" style="display:none">
				<h3 id="ma_sample_actions_tab">Sample Actions tab</h3>
				<p>The Actions tab on the Screens tab of the Macro Editor allows to create and edit actions. When you create an action in the tab, the Macro Editor inserts the new action into the &lt;actions&gt; element of the currently selected screen. <button onclick="scrollHere('ma_hame_actions_tab')">Figure 27</button> shows a sample Actions tab:</p>
				<div class="fignone" id="ma_hame_actions_tab"><span class="figcap">Figure 27. Actions tab</span>
					<div class="mmobj">
						<img src="./mb_hame_actions_tab.gif" alt="">
					</div>
				</div>
				<p class="indatacontent">In the figure above, the Screens tab of the Macro Editor selected. The name of the currently selected screen, Screen1, is in the Screen Name field at the top of the Screens tab. Below Screen Name field are the General, Description, and Actions subtabs.The Actions tab is selected.</p>
				<p>As you look at the Actions tab in the figure above, you can that, like the Description tab, it has an upper area and a lower area.</p>
				<p> The upper area contains controls that operate on a single element considered as a whole. In particular, the Action listbox in the upper left corner of the Actions tab contains the name of currently selected action. In the figure above, there is no selected action, because no action has been created yet.</p>
				<p>The lower area of the Actions tab displays the contents of currently selected action, if any. If the currently selected is an Input action, then the lower area of the Actions tab the contents appropriate to that type of action. If the user or selects another type of action, such as an Extract action, the lower area presents the contents appropriate to an Extract action.</p>
				<h3 id="md1_creating_new_action">Creating a new action</h3>
				<p>Looking again at the Actions listbox in <button onclick="scrollHere('ma_hame_actions_tab')">Figure 27</button>, you should notice that it does not contain any actions. The selections, which are all enclosed in brackets and all begin with the word <samp class="xph">new</samp>, are for new actions. As you can see in <button onclick="scrollHere('ma_hame_actions_tab')">Figure 27</button>, the displayable part of the Actions listbox is not tall enough show the whole list at once. Here is the entire list:</p>
				<div class="figrules" id="ma_fig_actions_listbox"><span class="figcap">Figure 28. Contents of the list of an Actions listbox with no actions created</span>
					<pre class="xmp"><code>&lt;new input action&gt; &lt;new extract action&gt; &lt;new prompt action&gt; &lt;new message action&gt; &lt;new pause action&gt; &lt;new xfer action&gt; &lt;new comm wait action&gt; &lt;new trace action&gt; &lt;new mouse click action&gt; &lt;new box select action&gt; &lt;new run program&gt; &lt;new variable update action&gt; &lt;new play macro action&gt; &lt;new perform action&gt; &lt;new conditional action&gt; &lt;new print start action&gt; &lt;new print extract action&gt; &lt;new print end action&gt; &lt;new sql query action&gt; &lt;new file upload action&gt;</code></pre>
				</div>
				<p>For example, if you clicked &lt;new input action&gt;, the Macro would create a new Input action and place it at the top of the list.The lower area of the Actions tab would allow you to fill out various fields that belong to an Input action (such as the input sequence). The new Input item would be in the selected area of Actions listbox, and the list part of the listbox would then like this:</p>
				<div class="figrules" id="ma_fig_actions_listbox2"><span class="figcap">Figure 29. Contents of the list of an Actions listbox with one actual action</span>
					<pre class="xmp"><code>Input action1(0,0) &lt;new input action&gt; &lt;new extract action&gt; &lt;new prompt action&gt; &lt;new message action&gt; &lt;new pause action&gt; &lt;new xfer action&gt; &lt;new comm wait action&gt; &lt;new trace action&gt; &lt;new mouse click action&gt; &lt;new box select action&gt; &lt;new run program&gt; &lt;new variable update action&gt; &lt;new play macro action&gt; &lt;new perform action&gt; &lt;new conditional action&gt; &lt;new print start action&gt; &lt;new print extract action&gt; &lt;new print end action&gt; &lt;new sql query action&gt; &lt;new file upload action&gt;</code></pre>
				</div>
				<p>When the macro runtime processes this macro screen, it the actions in the same order in which they are listed in the listbox. To change the order of the actual actions, click the Order button to the right of the Actions listbox.</p>
			</div>

			<button id="wq151" class="accordian">The actions</button>
			<div class="panel" style="display:none">
				<h3 id="ma_boxselection">Box selection action (&lt;boxselection&gt; element)</h3>
				<p>The Box selection action draws a marking rectangle on the window, simulating the action in which an actual user clicks on session window, presses mouse button 1, and drags the mouse to a marking rectangle.</p>
				<h4 id="wq152">Specifying row and column values</h4>
				<p>In the lower area of the Actions tab, specify the row and locations of the corners of the marking rectangle that you want create or edit. Or, if the Box selection action is the currently action in the Actions listbox, you can click and drag the mouse the session window to create the marking rectangle that you want create. When you have completed the marking rectangle on the window, the Macro Editor writes the row and column value of the of the marking rectangle into the appropriate Row and Column fields of the Box selection action.</p>
				<p>You can type a negative number (such as -1) into the Row (Corner) input field and into the Column (Bottom Corner) input to specify a relative offset from the last row and last column the session window. For example, if the session window is 24 by and you specify corners of (1, 1) and (-4, -10), then the macro draws a marking rectangle with the coordinates (1, 1) and (21, 71) (see <button onclick="scrollHere('me1_negative_row_or_col')">Significance of a negative value for a row or column</button>).</p>
				<h4 id="wq153">Erasing the marking rectangle</h4>
				<p>If you draw a marking rectangle and then click the session anywhere outside the boundaries of the marking rectangle, the window erases the marking rectangle. However, when the macro is playing a macro, a Mouse click action does not erase an marking rectangle.</p>
				<p>To erase a marking rectangle in a macro you have two choices:</p>
				<ul>
					<li>Draw a new marking rectangle in a different location .When draw a new marking rectangle the old one is erased.</li>
					<li>Use the Code Editor to set the <strong>type</strong> of the &lt;boxselection&gt; element to DESELECT. For the DESELECT the macro runtime ignores the row and column coordinates and erases the existing marking rectangle if there is one.</li>
				</ul>
				<h4 id="ma_boxselection_hostid">Specifying a session</h4>
				<p>Use the Host ID field to specify the session in which you this action to be performed:</p>
				<ul>
					<li>If you want this action to be performed in the session that the macro, then leave the Host ID field blank.</li>
					<li>If you want this action to be performed in some other session, type a session reference into the Host ID field (see <button onclick="scrollHere('ms_hostid')">Specifying a Host ID</button>).</li>
				</ul>
				<p>If the referenced session is active, then you can use any editing feature with the referenced session (see <button onclick="scrollHere('ms_auto_edit')">Using automatic editing features with other sessions</button>).</p>
				<h4 id="wq154">Example</h4>
				<p>See <button onclick="scrollHere('ma_copypaste_section')">Copy and paste example</button>.</p>
				<p></p>
				<h3 id="ma_commwait">Comm wait action (&lt;commwait&gt; element)</h3>
				<p>The Comm wait action waits until the communication status of session changes to some state that you have specified in the action.For example, you might create a Comm wait action to wait until session was completely connected.</p>
				<h4 id="wq155">How the action works</h4>
				<p>When the macro runtime starts to perform a Comm wait action, looks at the communication status specified in the Comm wait and compares it to the actual communication status of the session.If the two statuses match, then the macro runtime concludes that Comm wait action is completed, and the macro runtime goes on to the next action.</p>
				<p>However, if the two statuses do not match, then the macro does no further processing, but just waits for the communication that is specified in the Comm wait action to actually occur in session.</p>
				<p>You can specify in the Comm wait action a timeout value in that causes the macro runtime to end the Comm wait action when timeout value has expired. That is, the macro runtime terminates action when the timeout value has expired, even if the status that the macro runtime has been looking for has not been reached.</p>
				<p>After a Comm wait action, you probably want to use some other action, such as an Extract action, to check some characteristic of the screen that indicates to you whether the session has actually the communication status that you wanted, or whether the Comm action ended because of a timeout.</p>
				<h4 id="wq156">Specify a communication status that is persistent</h4>
				<p>As the session connects or disconnects, the communication typically moves quickly through some states (such as pending active, then active, then ready) until it reaches a particular state at it remains stable for some time (such as workstation id ready). most situations you want to specify that persistent, ending in the Comm wait action. See the next section for a list of states.</p>
				<p>(If instead you specified some transitional state such as active, then the session might pass through that state and go on the next state before the macro runtime gets a chance to perform Comm wait action. Therefore when the macro runtime does perform Comm wait action it waits interminably for some state that has occurred.)</p>
				<h4 id="ma_cw_comm_states">Communication states</h4>
				<p>You can specify any of the states listed in the Connection listbox. <button onclick="scrollHere('ma_table_comm_states')">Table 15</button> lists the name and of each state:</p>
				<table id="ma_table_comm_states" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 15. Communication states</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq157" align="left" valign="top">Communication state:</th>
							<th id="wq158" align="left" valign="top">Significance:</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td headers="wq157"> Connection Initiated</td>
							<td headers="wq158">Initial state. Start Communications issued.</td>
						</tr>
						<tr>
							<td headers="wq157">Connection Pending Active</td>
							<td headers="wq158">Request socket connect.</td>
						</tr>
						<tr>
							<td headers="wq157">Connection Active</td>
							<td headers="wq158">Socket connected. Connection with host.</td>
						</tr>
						<tr>
							<td headers="wq157">Connection Ready</td>
							<td headers="wq158">Telnet negotiation has begun.</td>
						</tr>
						<tr>
							<td headers="wq157">Connection Device Name Ready</td>
							<td headers="wq158">Device name negotiated.</td>
						</tr>
						<tr>
							<td headers="wq157">Connection Workstation ID Ready</td>
							<td headers="wq158">Workstation ID negotiated.</td>
						</tr>
						<tr>
							<td headers="wq157"> Connection Pending Inactive</td>
							<td headers="wq158">Stop Communications issued.</td>
						</tr>
						<tr>
							<td headers="wq157">Connection Inactive</td>
							<td headers="wq158"> Socket closed. No connection with host.</td>
						</tr>
					</tbody>
				</table>
				<p>The stable states (that is, the ones that usually persist for than a few seconds) are:</p>
				<ul>
					<li>Connection Inactive - Here the session is completely disconnected.</li>
					<li>Connection Workstation ID Ready - Here the session is connected.</li>
				</ul>
				<p>If you select <samp class="xph">&lt;Expression&gt;</samp> in the Connection listbox, then you must specify an expression that resolves to of the keywords that the macro runtime expects to find in the <strong>value</strong> attribute of the &lt;commwait&gt; element (see <button onclick="scrollHere('mr_commwait')">&lt;commwait&gt; element</button>). For example, you might specify a variable named <samp class="xph">$strCommState$</samp>) that resolves to <samp class="xph">CONNECTION_READY</samp>.</p>
				<h4 id="ma_commwait_hostid">Specifying a session</h4>
				<p>Use the Host ID field to specify the session in which you this action to be performed:</p>
				<ul>
					<li>If you want this action to be performed in the session that the macro, then leave the Host ID field blank.</li>
					<li>If you want this action to be performed in some other session, type a session reference into the Host ID field (see <button onclick="scrollHere('ms_hostid')">Specifying a Host ID</button>).</li>
				</ul>
				<p>If the referenced session is active, then you can use any editing feature with the referenced session (see <button onclick="scrollHere('ms_auto_edit')">Using automatic editing features with other sessions</button>).</p>
				<h4 id="wq159">Examples</h4>
				<p></p>
				<div class="figrules" id="ma_fig_commwait_xml"><span class="figcap">Figure 30. Example of Comm wait action</span>
					<pre class="xmp"><code>&lt;commwait value="CONNECTION_READY" timeout="10000" /&gt;</code></pre>
				</div>
				<h3 id="ma_condition">Conditional action (&lt;if&gt; element and &lt;else&gt; element)</h3>
				<p>The Conditional action contains the following items:</p>
				<ul>
					<li>A conditional expression that the macro runtime evaluates to or false.</li>
					<li>A list of actions that the macro runtime performs if the evaluates to true. (Optional)</li>
					<li>A list of actions that the macro runtime performs if the evaluates to false. (Optional)</li>
				</ul>
				<p>The Conditional action provides the functions of an if-or of an if-else statement.</p>
				<h4 id="wq160">Specifying the condition</h4>
				<p>You should specify in the Condition field the conditional that you want the macro runtime to evaluate. The conditional can contain logical operators and conditional operators and can terms that include arithmetic expressions, immediate values, variables, and calls to Java methods (see <button onclick="scrollHere('me_conditional_expressions')">Conditional and logical operators and expressions</button>).</p>
				<h4 id="wq161">Condition is True (&lt;if&gt; element)</h4>
				<p>Use the Condition is True tab to specify the actions that you to be performed if the condition evaluates to true.</p>
				<p>The Condition is True tab contains controls that are almost to the controls for the Actions tab. Specifically:</p>
				<ul>
					<li>The Action listbox on the Condition is True tab allows you create and edit actions in the same way that the Action listbox the Actions tab does.</li>
					<li>The Delete button and the Change Order button on the is True tab allow you to delete or reorder actions in the same that the Delete button and the Change Order button on the tab do.</li>
					<li>The lower area of the Condition is True tab allows you to the values of the currently selected action in the same way that area of the Actions tab does.</li>
				</ul>
				<p>Use these controls on the Condition is True tab to create and the actions that you want the macro runtime to perform if the is true.</p>
				<p> For example, you might set the Condition field to the name a variable, such as <samp class="xph">$boolResult$</samp>, into which a operation has stored its result. If the value of $boolResult$ is true, you might want to a perform a Message action that displays a message to the user. Therefore, in the Condition is True tab you create a Message action that contains the status message that want to display.</p>
				<p>During macro playback the macro would evaluate the condition, $boolResult$.If the value is true then the macro runtime would perform the action that you had defined in the Condition is True tab. If the is false then the macro runtime would skip over the Message and over all the other actions (if any) that you had defined in Condition is True tab.</p>
				<h4 id="wq162">Condition is false (&lt;else&gt; element)</h4>
				<p>Use the Condition is False tab to specify the actions that want to be performed if the condition evaluates to false.</p>
				<p>Like the Condition is True tab, the Condition is False tab controls that are almost identical to the controls for the tab. Use these controls on the Condition is False tab to create edit the actions that you want the macro runtime to perform if condition is false.</p>
				<h4 id="wq163">Condition action not allowed within a Condition action</h4>
				<p>The Macro Editor does not allow you to create a Condition inside the Condition is True tab or inside the Condition is tab. Therefore you cannot have the equivalent of an if-statement inside another if-statement, or of an if-statement nested inside else-statement. The Code Editor enforces the same rules.</p>
				<h4 id="ma_condition_example">Example</h4>
				<p>The following code fragment prompts the user for input. If input string is the string <samp class="xph">true</samp>, the code fragment a message window with the message "You typed TRUE". If the input is any other string, the code fragment displays a message window the message "You typed FALSE". This example uses the following actions: Prompt action, Condition action, and Message action.</p>
				<p>You can copy this code fragment from this document into the clipboard, and then from the system clipboard into the Code Editor.Because this code is a fragment, you must copy it into a macro in an existing macro script. You must also create a string named $strData$. To create the variable, add the follow lines the &lt;HAScript&gt; begin tag and before the first &lt;screen&gt; element:</p>
				<pre class="xmp"><code>&lt;vars&gt;    &lt;create name="$strData$" type="string" value="" /&gt; &lt;/vars&gt;</code></pre>
				<p class="indatacontent">After you save the script in the Macro Editor, can edit it either with the Macro Editor or with the Code Editor.</p>
				<p> You should notice the following facts about this example:</p>
				<ul>
					<li>The example consists of one code fragment containing an &lt;actions&gt; element and the actions inside it.</li>
					<li>The first action is a Prompt action that displays a message and copies the user's input into the variable $strData$, without the input into an input field in the session window.</li>
					<li>The first part of the condition action (the &lt;if&gt; element) the condition, which is simply <samp class="xph">$strData$</samp>.</li>
					<li>Because $strData$ is a string variable in a boolean context, macro runtime tries to convert the string to a boolean value (see <button onclick="scrollHere('me_data_type_conversion')">Automatic data type conversion</button>). If the user's input is the string <samp class="xph">'true'</samp> (upper, lower, or mixed case), then the conversion is successful the condition contains the boolean value true. If the user's is any other string, then the conversion fails and the condition the boolean value false.</li>
					<li>If the condition is true, then the macro runtime performs action inside the &lt;if&gt; element, which is a Message action the message You typed TRUE. Then, having exhausted all the to be performed when the condition is true (just one action here), the macro runtime skips over the &lt;else&gt; action and continues usual.</li>
					<li>In contrast, if the condition is false, then the macro skips over the actions in the &lt;if&gt; element and begins the actions in the &lt;else&gt; element, which include one Message that displays the message You typed FALSE. After performing all actions in the &lt;else&gt; action, then the macro runtime as usual.</li>
				</ul>
				<div class="figrules" id="ma_fig_condition"><span class="figcap">Figure 31. Sample code fragment showing a Condition action</span>
					<pre class="xmp"><code>&lt;actions&gt;    &lt;prompt name="’Type true or false’" description="" row="0" col="0"                len="80" default="" clearfield="false" encrypted="false"                movecursor="true" xlatehostkeys="true" assigntovar="$strData$"                varupdateonly="true" /&gt;    &lt;if condition="$strData$" &gt;        &lt;message title="" value="’You typed TRUE’" /&gt;    &lt;/if&gt;    &lt;else&gt;        &lt;message title="" value="’You typed FALSE’" /&gt;    &lt;/else&gt; &lt;/actions&gt;</code></pre>
				</div>
				<h3 id="ma_extract">Extract action (&lt;extract&gt; element)</h3>
				<p>The Extract action captures text from the session window and the text into a variable. This action is very useful and is the method that the Macro object provides for reading application (short of using programming APIs from the toolkit).</p>
				<p>If you have the IBM Host Access Toolkit product, then you can the Extract action to read data from any of the available data planes.For more information see <button onclick="scrollHere('ma_using_toolkit_for_extract')">Using the Toolkit to capture data from any data plane</button>.</p>
				<h4 id="wq164">Capturing text</h4>
				<p>The most common use of the Extract action is to capture text is being displayed in the session window. This operation does require the IBM Host Access Toolkit.</p>
				<p>Here is an overview of the steps to follow. Each step is in more detail in the following subsections.</p>
				<ol type="1">
					<li>Set the Continuous Extract option, if necessary</li>
					<li>Specify an area on the session window that you want to capture.</li>
					<li>Specify an extraction name.</li>
					<li>Specify TEXT_PLANE as the data plane.</li>
					<li>Specify a variable in which you want the text to be stored.</li>
				</ol>
				<h5 id="ma_set_ce">Set the Continuous Extract option</h5>
				<p>If you want to capture a rectangular block of text, then set Continuous Extract option to false (this is the default value). more information, see <button onclick="scrollHere('ma_example_ce_false')">Capturing a rectangular area of the session window</button>.</p>
				<p>In contrast, if you want to capture a continuous sequence of that wraps from line to line, then set the Continuous Extract to true. For more information, see <button onclick="scrollHere('ma_continuous_extract')">Capturing a sequence of text from the session window</button> .</p>
				<h5 id="wq166">Specify the area of the session window</h5>
				<p>To specify the area of the session window that you want to capture, you can either use the marking rectangle to gather the row and coordinates, or else you can type the row and column coordinates the text area into the Row and Column fields on the Extract window.</p>
				<p>Whichever method you use, the macro runtime interprets the differently depending on whether the Continuous Extract option set to false or true (see <button onclick="scrollHere('ma_set_ce')">Set the Continuous Extract option</button>).</p>
				<p>If you are using the marking rectangle (see <button onclick="scrollHere('mg_bounding_rectangle')">Using the marking rectangle</button>) then the macro runtime writes row and column coordinates of the upper left corner of the rectangle into the first pair of Row and Column values (labeled Corner on the Extract action window) and the row and column of the lower right corner into the second pair of Row and Column (labeled Bottom Corner).</p>
				<p>If you enter the Row and Column values yourself, then type first set of row and column coordinates into the first pair of and Column values (labeled Top Corner on the Extract action window) and type the second set of coordinates into the second pair of and Column values (labeled Bottom Corner). You can use the text on the session window as an aid to determine the coordinates you want (see <button onclick="scrollHere('mg_using_text_cursor')">Using the session window's text cursor</button>).</p>
				<p>In the Row (Bottom Corner) input field you can enter <samp class="xph">-1</samp> signify the last row of the data area on the session window. feature is helpful if your users work with session windows of heights (such as 25, 43, 50) and you want to capture data down the last row. Similarly for the Column (Bottom Corner) input you can enter <samp class="xph">-1</samp> to signify the last column of the on the session window (see <button onclick="scrollHere('me1_negative_row_or_col')">Significance of a negative value for a row or column</button>).</p>
				<h5 id="ma_ex_extraction_name">Specify an extraction name</h5>
				<p>You must specify an extraction name, such as <samp class="xph">'Extract1'</samp>.However, you can not use this name for any purpose unless you using the IBM Host Access Toolkit product.</p>
				<h5 id="wq167">Specify TEXT_PLANE as the data plane</h5>
				<p>In the Data Plane listbox click TEXT_PLANE. This is the default.</p>
				<h5 id="ma_ex_variable">Specify the variable in which you want the text to be stored</h5>
				<p>Set the checkbox labeled Assign Text Plane to a Variable and the name of the variable into which you want the text to be stored.You have to use this method to store the captured text unless are using the IBM Host Access Toolkit product.</p>
				<p>The text is returned as a string. In most cases you probably to store the string in a string variable, so that some other in your macro can process the string.</p>
				<p>However, if you specify a variable of some other standard type (boolean, integer, double) then the macro runtime converts string to the format of the variable, if possible. For example, the text on the screen is <samp class="xph">1024</samp> and the variable is an variable then the macro runtime converts the string <samp class="xph"> 1024 </samp> the integer 1024 and store the value in the integer variable. If format is not valid for converting the string to the data type the variable then the macro runtime terminates the macro with a run-error. For more information about data conversion see <button onclick="scrollHere('me_data_type_conversion')">Automatic data type conversion</button>.</p>
				<h4 id="wq168">Treatment of nulls and other undisplayable characters</h4>
				<p>Text captured from the TEXT_PLANE does not contain any nulls (0x00) or other undisplayable characters. Any character cell on the screen that appears to contain a blank space character is as a blank space character.</p>
				<h4 id="ma_example_ce_false">Capturing a rectangular area of the session window</h4>
				<p>When the Continuous Extract option is false (this is the value), the macro runtime treats the two pairs of Row and Column as the upper left and lower right corners (inclusive) of a block of text. The rectangular block can be as small as one or as large as the entire application window.</p>
				<p>The macro runtime:</p>
				<ul>
					<li>Initializes the result string to an empty string.</li>
					<li>Reads the rectangular block of text row by row, each row to the result string.</li>
					<li>Stores the result string in the specified variable.</li>
				</ul>
				<p> As an example, suppose that the first 40 characters of rows 16, 17, and 18 of the session window are as follows:</p>
				<pre class="xmp"><code>.8..Outlist.....Display, delete, or .9..Commands....Create/change an .10.Reserved....This option reserved for</code></pre>
				<p class="indatacontent">and suppose that macro runtime is about to perform an Extract action with the settings:</p>
				<ul>
					<li>Continuous Extract is false.</li>
					<li>The row and column pairs are (16, 5) (the 'O' of Outlist) (18, 12) (the 'd' of 'Reserved').</li>
					<li>The extraction name is 'Extract1'.</li>
					<li>The data plane is TEXT_PLANE.</li>
					<li>The string variable $strTmp$ is the variable in which the string is to be stored.</li>
				</ul>
				<p>Because the Continuous Extract option is false, the macro treats the row and column pairs as marking a rectangular block text, with the upper left corner at row 16 and column 5 and the right corner at row 18 and column 12.</p>
				<p>The macro runtime initializes the result string to an empty string.Then the macro runtime reads the rectangular block of text one at a time ('Outlist.', 'Commands', 'Reserved'), concatenating row to the result string. Finally the macro runtime stores the result string into the result variable $strTmp$. The variable $strTmp$ 		now contains the following string:</p>
				<pre class="xmp"><code>'Outlist.CommandsReserved'</code></pre>
				<h4 id="ma_continuous_extract">Capturing a sequence of text from the session window</h4>
				<p>When the Continuous Extract option is true, the macro runtime the two pairs of Row and Column values as the beginning and positions (inclusive) of a continuous sequence of text that from line to line if necessary to get from the beginning to the ending position. The sequence of text can be as small as character or as large as the entire application window.</p>
				<p>The macro runtime:</p>
				<ul>
					<li>Initializes the result string to an empty string.</li>
					<li>Reads the continuous sequence of text from beginning to end, around from the end of one line to the beginning of the next if necessary.</li>
					<li>Stores the result string in the specified variable.</li>
				</ul>
				<p>For example, suppose that rows 21 and 22 of the session contain the following text (each row is 80 characters):</p>
				<pre class="xmp"><code>........Enter / on the data set list command field for the command prompt pop-or ISPF line command............................................................</code></pre>
				<p class="indatacontent">suppose that the macro runtime is about to perform an Extract with the following settings:</p>
				<ul>
					<li>Continuous Extract is true.</li>
					<li>The row and column pairs are (21, 9) (the 'E' of 'Enter') (22, 20) (the 'd' of 'command').</li>
					<li>The extraction name is 'Extract1'.</li>
					<li>The data plane is TEXT_PLANE.</li>
					<li>The string variable $strTmp$ is the variable in which the string is to be stored.</li>
				</ul>
				<p>Because the Continuous Extract option is true, the macro treats the row and column pairs as marking the beginning and end a sequence of text, with the beginning position at (21, 9) and ending at (22, 20).</p>
				<p>The macro runtime initializes the result string to an empty string.Then the macro runtime reads the sequence of text from beginning end, wrapping around from the last character of row 21 to the character of row 22. Finally the macro runtime stores the entire string into the result variable $strTmp$. The variable $strTmp$ contains the following string of 92 characters (the following is hyphenated to fit on the page of this document, but actually one string without a hyphen):</p>
				<pre class="xmp"><code>'Enter / on the data set list command field for the com-
				mand prompt pop-up or ISPF line command'</code></pre>
				<p>In contrast, if the Continuous Extract option is set to false this example, $strTmp$ would contain a string of 24 characters, <samp class="xph">'/ on tline command'</samp>.</p>
				<h4 id="ma_unwraptext">Unwrap Text option</h4>
				<p>This option was originally intended to be used with the IBM Access Toolkit product and only when the Continuous Extract was set to false. However, you can also use it without the toolkit, and you can use it with the Continuous Extract option set either false or true.</p>
				<p>When you set Unwrap Text to true, the macro runtime uses not the row and column pairs in the Extract window but also the boundaries in the session window in determining the data to collect.The macro runtime returns an array of strings (if you are using toolkit) or a single string of concatenated strings (if you are using the the toolkit).</p>
				<p>Do not confuse the Unwrap Text option with the Wrap option of String descriptor, which is based on a rectangular block of text than fields (see <button onclick="scrollHere('md_wrap_option')">How the macro runtime searches the rectangular area (Wrap option)</button>).</p>
				<h5 id="wq169">When Unwrap Text is true and Continuous Extract is false</h5>
				<p>When Continuous Extract is false, the row and column pairs the corners of a rectangular block of text. When you set Unwrap to true, the macro runtime reads each row of the rectangular of text and processes each field in the row as follows:</p>
				<ul>
					<li>If the field begins outside the row and continues into the row, then the macro runtime ignores the field.</li>
					<li>If the field begins inside the row and ends inside the row, the macro runtime includes the field's contents in the result.</li>
					<li>If the field begins inside the row and ends outside the row, the macro runtime includes the contents of the entire field (the part outside the rectangular block of text) in the result.</li>
				</ul>
				<p>The intent of the Unwrap Text option is to capture the entire of a field as one string even if the field wraps from one line the next.</p>
				<p>For example, suppose that the session window is 80 characters and that rows 9, 10, 11, and 12 of the session window are as follows:</p>
				<pre class="xmp"><code>...............................................Compress or print data set.....................................................................Reset statistics................................................................Catalog or information of an entire data set...............................................</code></pre>
				<p class="indatacontent">also that the following text areas in the lines above are fields:</p>
				<pre class="xmp"><code>Compress or print data Reset Catalog or display information of an entire data set</code></pre>
				<p class="indatacontent">Finally, suppose that:</p>
				<ul>
					<li>Continuous Extract is false (this is the default setting).</li>
					<li>Unwrap Text is true.</li>
					<li>The marking rectangle has its upper left corner at row 9 and 63 (the 'n' of 'print') and its lower right corner at row 11 and 73 (the ' ' after 'or').</li>
					<li>The extraction name is 'Extract1'.</li>
					<li>The data plane is TEXT_PLANE.</li>
				</ul>
				<p>If you are using the IBM Host Access toolkit the macro returns the following array of strings as the return value of toolkit method: <samp class="xph">'Reset statistics'</samp>, <samp class="xph">'Catalog or information of an entire data set'</samp>. The macro runtime:</p>
				<ul>
					<li>Skips <samp class="xph">'Compress or print data set'</samp> because the begins outside the marking rectangle.</li>
					<li>Returns <samp class="xph">'Reset statistics'</samp> because the field within the marking rectangle.</li>
					<li>Returns <samp class="xph">'Catalog or display information of an entire set'</samp> because the field begins inside the marking rectangle, even though the field wraps to the next line.</li>
				</ul>
				<p>If you are not using the toolkit, the macro runtime the individual strings and stores them as a single string into variable that you specified in the Extract window. In this the macro runtime stores the string <samp class="xph">'Reset or display information of an entire data set'</samp> into the variable.</p>
				<h5 id="wq170">When Unwrap Text is true and Continuous Extract is true</h5>
				<p>When Continuous Extract is true, the row and column pairs the beginning and ending locations of a continuous sequence of that wraps from line to line if necessary. When you then set Text to true, the macro runtime processes the continuous of text as follows:</p>
				<ul>
					<li>If the field begins outside the sequence and continues into sequence, then the macro runtime ignores the field.</li>
					<li>If the field begins inside the sequence and ends inside the sequence, then the macro runtime includes the field's contents in the result.</li>
					<li>If the field begins inside the sequence and ends outside the sequence, then the macro runtime includes the contents of the entire field (the part outside the continuous sequence) in the result.</li>
				</ul>
				<h4 id="ma_using_toolkit_for_extract">Using the Toolkit to capture data from any data plane</h4>
				<p>You can use the Java APIs from the IBM Host Access Toolkit to access data from any data plane, including the TEXT_PLANE.</p>
				<p>The data planes, together with the type of data associated each plane, are:</p>
				<ul>
					<li>TEXT_PLANE - The characters displayed on the screen.</li>
					<li>FIELD_PLANE - 3270 or 5250 field attributes</li>
					<li>COLOR_PLANE - 3270 or 5250 color attributes</li>
					<li>EXFIELD_PLANE - 3270 or 5250 extended attributes</li>
					<li>DBCS_PLANE - Double byte character set characters</li>
					<li>GRID_PLANE - Double byte character set grid information</li>
				</ul>
				<p>To access the extracted data using the Toolkit, you need to the MacroRuntimeListener class and register yourself with the bean. For every Extract action, the Macro bean fires data to you a MacroExtractEvent by calling your macroExtractEvent() method. the get methods of the MacroExtractEvent to access the data.</p>
				<h4 id="ma_extract_hostid">Specifying a session</h4>
				<p>Use the Host ID field to specify the session in which you this action to be performed:</p>
				<ul>
					<li>If you want this action to be performed in the session that the macro, then leave the Host ID field blank.</li>
					<li>If you want this action to be performed in some other session, type a session reference into the Host ID field (see <button onclick="scrollHere('ms_hostid')">Specifying a Host ID</button>).</li>
				</ul>
				<p>If the referenced session is active, then you can use any editing feature with the referenced session (see <button onclick="scrollHere('ms_auto_edit')">Using automatic editing features with other sessions</button>).</p>
				<h3 id="ma_fileupload">FileUpload action (&lt;fileupload&gt; element)</h3>
				<p>The FileUpload action is a powerful and useful action that you to create, append data to, replace, or update a table in a database. This action is a companion to the SQLQuery action, allows you to send an SQL statement to a host database (see <button onclick="scrollHere('ma_sqlquery')">SQLQuery action (&lt;sqlquery&gt; element)</button>).</p>
				<p>You can use the FileUpload action in any type of Host On-session that supports macros (3270 Display, 5250 Display, VT Display, or CICS Gateway).</p>
				<p>The database server to which you connect can be on a host than the host running your emulator session.</p>
				<h4 id="wq171">Connecting with the database server</h4>
				<h5 id="ma_fu_database_url">Database URL</h5>
				<p>In the Database URL field, type the database URL of the server that provides access to the database. The format of the URL depends on the type of Java Database Connectivity (JDBC) that you use to access the database (for more information on drivers see <button onclick="scrollHere('ma_fu_driver_identifier')">Driver Identifier and Driver Class</button>). <button onclick="scrollHere('ma_fu_table_dburl')">Table 16</button> shows the format of the database URL the JDBC driver included with Host On-Demand.</p>
				<table id="ma_fu_table_dburl" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 16. Formats for database URL</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq172" align="left" valign="top">Driver provided with Host On-Demand:</th>
							<th id="wq173" align="left" valign="top">Format for database URL:</th>
							<th id="wq174" align="left" valign="top">Examples:</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td headers="wq172">AS/400 Toolbox for Java</td>
							<td headers="wq173"><samp class="xph">jdbc:as400://<em>[host]</em></samp></td>
							<td headers="wq174">
								<ul>
									<li><samp class="xph">jdbc:as400://myISeries</samp></li>
									<li><samp class="xph">jdbc:as400://9.88.24.163</samp></li>
								</ul>
							</td>
						</tr>
					</tbody>
				</table>
				<p class="indatacontent">Notice that in the actual database URL (such as <samp class="xph">jdbc:as400://myISeries</samp>) you should <em>not</em> include the square shown in the format.</p>
				<p>The remote server can be located on a host other than the to which the Host On-Demand emulator session is connected. For example, a FileUpload action can specify an iSeries host, even though the FileUpload action is part of a macro that is running in a 3270 session connected to a zSeries host.</p>
				<p>If you are using a JDBC driver other than the driver provided Host On-Demand, consult the documentation provided by the driver for the proper format for the database URL.</p>
				<h5 id="ma_fu_driver_identifier">Driver Identifier and Driver Class</h5>
				<p>The JDBC driver that the FileUpload action uses to access the is a Java client package on the Host On-Demand client that communicates with a server program on a remote host. This program on the remote host provides access to the database.</p>
				<p>The Host On-Demand client already includes a JDBC driver from AS/400 Toolbox for Java. This driver is automatically downloaded part of the emulator client. This driver allows a client to DB2/400 data on a properly configured iSeries or AS/400.</p>
				<p>If you need a different JDBC driver, contact the of the remote database server to obtain the driver. You must some action to deploy the driver to your Host On-Demand client workstations.</p>
				<p>In the Driver Identifier listbox of the FileUpload action in the Macro Editor, select the driver provided with Host On-Demand, or select <samp class="xph">Other</samp> if you plan to use another driver.</p>
				<p>The Driver Class field contains the fully qualified Java name of the driver. If you select the driver provided with Host On-Demand, then the Macro Editor displays the class name for you in the Class field (<samp class="xph">com.ibm.as400.access.AS400JDBCDRIVER</samp>) does not allow you to modify the class name. In contrast, if you select <samp class="xph">Other</samp> the Driver Identifier listbox, then you must type the fully class name of the driver into the Driver Class field. If you do know the fully qualified class name, contact the provider of the driver.When you type in the name, remember that case is significant (example, <samp class="xph">com</samp> is different from <samp class="xph">COM</samp>).</p>
				<p>If you want to add a driver to the list of available drivers the Driver Identifier listbox (instead of having each time to select <samp class="xph">Other</samp> type in the class name), then you can register the driver with On-Demand (see <button href="https://scc.its.state.nc.us/hod/en/help/db_drvr.html">Registering a JDBC driver</button> the online help).</p>
				<h5 id="ma_fu_uid">User ID and Password</h5>
				<p>If the database connection requires a user id and a password, type the user id into the User ID field and the password into Password field.</p>
				<p>Host On-Demand encrypts the key sequence that you type into Password field. This encryption works exactly like the used when the Password checkbox is selected in an Input action (see <button onclick="scrollHere('ma_input_password')">Password</button>). Remember:</p>
				<ul>
					<li>When you type a password (such as <samp class="xph">mypass</samp>) into Password field, the Macro Editor displays the password using (<samp class="xph">******</samp>).</li>
					<li>When you move the input focus to another input field, the Editor:  				<ol type="1">
							<li>Generates an encrypted version of the password (such as <samp class="xph">q0eqOskTUBQ=</samp>).</li>
							<li>Displays the encrypted version of the password in the field using asterisks (<samp class="xph">************</samp>). (You can see actual characters of the encrypted version of the password in Code Editor.)</li>
						</ol>
					</li>
					<li>The password is a string. Therefore, if you are using the macro format, remember to type the password enclosed in single (for example, <samp class="xph">'mypass'</samp>). The Macro Editor encrypts entire string, including the single quotes.</li>
					<li>If you need to modify the password after the Macro Editor encrypted it, be sure to <em>completely delete the characters in the field</em> before typing in the new password.</li>
				</ul>
				<h4 id="ma_fu_sourcefile">Specifying information for the file upload</h4>
				<p>In addition to the connectivity information required for a upload (Database URL, Driver Identifier, Driver Class, User ID, Password, all described in the previous sections), you also need provide information about the particular file upload operation. information includes:</p>
				<ul>
					<li>The name of the table in the host database that you want to modify.</li>
					<li>The name of the local file containing the data that you want add to the table in the host database.</li>
					<li>The type of file upload that you want to perform: create, replace, append, or update.</li>
				</ul>
				<p class="indatacontent">Also, for two types of file upload, you have to specify information: a Field Description Table for a create operation Key Columns for an update operation. <button onclick="scrollHere('ma_fu_table_types')">Table 17</button> this information:</p>
				<table id="ma_fu_table_types" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 17. Types of file upload and information required</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq176" width="19%" align="left" valign="top">Type of file upload:</th>
							<th id="wq177" width="19%" align="left" valign="top">Requires name of host table:</th>
							<th id="wq178" width="17%" align="left" valign="top">Requires name of source file:</th>
							<th id="wq179" width="43%" align="left" valign="top">Requires other information:</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td headers="wq176">Create</td>
							<td headers="wq177">yes</td>
							<td headers="wq178">yes</td>
							<td headers="wq179">Field Description Table</td>
						</tr>
						<tr>
							<td headers="wq176">Replace</td>
							<td headers="wq177">yes</td>
							<td headers="wq178">yes</td>
							<td headers="wq179">(none)</td>
						</tr>
						<tr>
							<td headers="wq176">Append</td>
							<td headers="wq177">yes</td>
							<td headers="wq178">yes</td>
							<td headers="wq179">(none)</td>
						</tr>
						<tr>
							<td headers="wq176">Update</td>
							<td headers="wq177">yes</td>
							<td headers="wq178">yes</td>
							<td headers="wq179">Key Columns</td>
						</tr>
					</tbody>
				</table>
				<h5 id="ma_fu_source_file">File Name and File Type</h5>
				<p>In the File Name field, type the path of the local file the data that you want to add to the table in the host database. (file path is a string, so type the string using the format for your macro format, either basic or advanced). Or, click to browse for the file. NOTE: You must specify a complete file and file name in this field, including the drive letter if any (example, <samp class="xph">c:\Documents and Settings\User1\input.txt</samp>).</p>
				<p>In the File Type listbox, click the type of the file. This lists the same database file types that are supported in the On-Demand client.</p>
				<h5 id="ma_fu_tablename">Table Name</h5>
				<p>In the Table Name field, type the name of the table in the database that you want to update (such as <samp class="xph">hodtest</samp>). a schema name in addition to a table name if the host database schemas (<samp class="xph">hod.hodtest</samp>).</p>
				<h5 id="ma_fu_create">Create</h5>
				<p>To create a new table, expand the Upload Type listbox and create.</p>
				<p>In the Field Description Table field, type the name of the and table in the host database (such as <samp class="xph">hod.hodmodel</samp>) which the database server is to read the column (field) names column widths for the new table . This table should contain the number of columns as the table you want to create, and should the same column names and column widths as you want to use in new table.</p>
				<p>The file that you specify in the File Name field should contain the same number of columns and column widths as the that you want to create.</p>
				<p>When the macro runtime performs the create operation, the server creates the new table using the data from the specified and using the column names and widths from the specified Field Table.</p>
				<h5 id="ma_fu_replace">Replace</h5>
				<p>To replace the contents of an existing table, expand the Type listbox and click replace.</p>
				<p>The file that you specify in the File Name field should the same number of columns and column widths as the table whose you want to replace.</p>
				<p>When the macro runtime performs the replace operation, the server replaces the contents of the specified table using the from the specified file and using the column names and widths defined in the existing table. For example, table <samp class="xph">hodtest</samp> 8 columns and 300 rows of data before the replace operation, but contain 8 columns and 250 rows (all with brand-new data) after replace operation.</p>
				<h5 id="ma_fu_append">Append</h5>
				<p>To append rows to the end of an existing table, expand the Type listbox and click append.</p>
				<p>The file that you specify in the File Name field should the same number of columns and column widths as the table that want to append to.</p>
				<p>When the macro runtime performs the append operation, the server appends the rows of data from the specified file to the of the specified table. For example, table <samp class="xph">hodtest</samp> 8 columns and 300 rows of data before the append operation, and contain 8 columns and 320 rows of data (300 original rows plus appended rows) after the append operation.</p>
				<h5 id="ma_fu_update">Update</h5>
				<p>To selectively update a part of an existing table, expand the Type listbox and click update.</p>
				<p>In the Key Columns field, type the name or names of the or columns that you want to update.</p>
				<p>The file that you specify in the File Name field should the same number of columns of data as the number of names in the Columns field. For example, if you type three column names into Key Columns field, the table should contain three columns of data.</p>
				<p>When the macro runtime performs the update operation, the server replaces the specified columns of data with the data from specified file. For example, if table <samp class="xph">hodtest</samp> has 8 and 250 columns, you can update the first, second, and seventh of the table.</p>
				<h4 id="wq180">Preloading the database components for the Host On-Demand client</h4>
				<p>In the Deployment Wizard, you can specify which macro for database access are preloaded by the Host On-Demand client. See <button href="https://scc.its.state.nc.us/hod/en/help/dpwpreloadopts.html">Preload Options (Features1)</button> in the online help.</p>
				<h3 id="ma_input">Input action (&lt;input&gt; element)</h3>
				<p>The Input action sends a sequence of keystrokes to the window. The sequence can include keys that display a character (as a, b, c, #, &amp;, and so on) and also action keys (such as [enterreset], [copy], [paste], and others).</p>
				<p>This action simulates keyboard input from an actual user.</p>
				<h4 id="ma_inp_location">Location at which typing begins</h4>
				<p>Use the Row and Column fields to specify the row and column in the session window at which you want the input sequence to begin.For example, if you specify row 23 and column 17 in the Input action, and you specify <samp class="xph">Hello world</samp> as the String value of Input action, then (assuming that the location you have lies within an input field) the macro runtime types the key sequence <samp class="xph">world</samp> on the session window starting at row 23 and column 17.</p>
				<p>If you specify a row or column location of 0, then the macro types the key sequence beginning at the actual row and column of the text cursor on the session window when the Input action performed. You should not specify a row or column of 0 unless context is one in which the location of the text cursor does not (for example, with a [copy] action key) or unless you can where the text cursor will be located (for example, if a Mouse action has just moved the text cursor to a specific location, or the application has positioned the text cursor as part of the application screen).</p>
				<h4 id="wq181">Input errors</h4>
				<p></p>
				<p>During macro playback, the session window reacts to a key error in the same way as it would react if an actual user had the key.</p>
				<p>For example, if an Input action sends a key that displays a (such as a, b, c, #, &amp; and so on) to the session when the cursor is not located in a 3270 or 5250 input field, then the responds by inhibiting the key input and displaying an error in the Operator Information Area, just as it would with a typed by an actual user.</p>
				<h4 id="ma_input_string">Input string</h4>
				<p>The String field is an input field in which you specify the sequence that you want the action to perform.</p>
				<p>To specify a key that causes a character to be displayed (as a, b, c, #, &amp;, and so on), type the key itself.</p>
				<p>To specify a key from the Actions Keys listbox, scroll the to the key you want (such as <samp class="xph">[backspace]</samp>) and click Action Key. The name of the key enclosed by square brackets at the next input position in the String field. Please notice the keys in the Action Keys listbox are not listed throughout. You might have to keep scrolling down the list to the key you want.</p>
				<p>Another way to specify an action key is just to type the name into the String input field, surrounded by square brackets (for example, <samp class="xph">[backspace]</samp>).</p>
				<p>The following copy/paste keys occur in the Action Keys list a 3270 Display Session:</p>
				<pre class="xmp"><code>[copy]                  [mark right]
				[copyappend]            [mark up]
				[cut]                   [paste]
				[mark down]             [pastenext]
				[mark left]             [unmark]</code></pre>
				<p>For other keys see <button onclick="scrollHere('mo_mnemonic_keywords')">Mnemonic keywords for the Input action</button>.</p>
				<h4 id="ma_input_translate_host_action_keys">Translate Host Action Keys</h4>
				<p>The Translate Host Action Keys field indicates whether the runtime is to interpret action key names (such as [copy], [enterreset], [tab], and so on) in the input sequence as action keys or as sequences of characters. The default is true (interpret the key names as action keys).</p>
				<p>For example, suppose that the input key sequence is <samp class="xph">'[up][up]world'</samp> and that the text cursor is at row 4, column 10. If Translate Host Actions Keys value is true, then in performing input sequence the macro runtime moves the text cursor up two and then types <samp class="xph">Hello world</samp> beginning at row 2, column 10.In contrast, if the Translate Host Actions Keys value is false, the macro runtime types <samp class="xph">[up][up]Hello World</samp> beginning row 4, column 10.</p>
				<h4 id="ma_move_cursor">Move Cursor to End of Input</h4>
				<p>When the Translate Host Action Keys field is set to true (the default), then the Macro Editor also sets the Move Cursor to End of Input to true and disables it. Even though the listbox is disabled, value is still set to true.</p>
				<p>If you set the Translate Host Action Keys listbox to false, the Move Cursor to End of Input listbox is enabled and you can it to false, true, or an expression that is evaluated at runtime.</p>
				<p>When the value of this listbox is true (the default), then macro runtime moves the text cursor in the same way that it be moved if an actual user were entering keyboard input. For example, if the key is a text character, such as 'a', then the macro types the character on the session window and then moves the cursor to the first character position after the 'a'. Similarly, the key is [tab], then the macro runtime moves the text cursor the next tab location.</p>
				<p>In contrast, if the value of the Move Cursor to End of Input is false, then the macro runtime does not move the text cursor all. The text cursor remains in the same position as it occupied the macro runtime performed the Input action.</p>
				<h4 id="ma_input_password">Password</h4>
				<p>You can use the Password checkbox to encrypt the input key contained in the String field. When you encrypt the contents of String field, Host On-Demand stores only the encrypted version the input key sequence into the macro script (in the &lt;input&gt; element) and does not retain the plain text (unencrypted) version of the key sequence.</p>
				<p>For example, <button onclick="scrollHere('ma1_fig_unencrypted')">Figure 32</button> shows an &lt;input&gt; element with an unencrypted input key sequence (<samp class="xph">'myPassword'</samp>):</p>
				<div class="figrules" id="ma1_fig_unencrypted"><span class="figcap">Figure 32. &lt;input&gt; element with unencrypted input key sequence</span>
					<pre class="xmp"><code>input value="’myPassword’" row="20" col="16" movecursor="true"           xlatehostkeys="true" encrypted="false" /&gt;</code></pre>
				</div>
				<p class="indatacontent">In contrast, <button onclick="scrollHere('ma1_fig_encrypted')">Figure 33</button> shows the same &lt;input&gt; element with the input key sequence encrypted (<samp class="xph">I7xae6rSVlVFF6qzhWRfKw==</samp>).Notice that in this example the <strong>encrypted</strong> of the &lt;input&gt; element is set to true:</p>
				<div class="figrules" id="ma1_fig_encrypted"><span class="figcap">Figure 33. &lt;input&gt; element with encrypted input key sequence</span>
					<pre class="xmp"><code>input value="I7xae6rSVlVFF6qzhWRfKw==" row="20" col="16"           movecursor="true" xlatehostkeys="true" encrypted="true" /&gt;</code></pre>
				</div>
				<p>In the Macro Editor, an encrypted input key sequence is with asterisks (for example, the encrypted version of <samp class="xph">'myPassword'</samp> displayed in the String field as <samp class="xph">************************</samp> than as <samp class="xph">I7xae6rSVlVFF6qzhWRfKw==</samp>).</p>
				<p>Encryption allows you to include confidential data, such as a password, in an Input action without exposing the confidential data to view. An unauthorized person cannot discover the confidential by viewing the macro script with a text editor, with the Macro Editor, or with the Code Editor.</p>
				<p>After you encrypt the input key sequence, Host On-Demand does allow you or anyone else to use the Macro Editor or the Code to decrypt it. Host On-Demand does not decrypt an encrypted key sequence of an Input action until the macro runtime the Input action during macro playback. When the macro runtime the Input action, the macro runtime decrypts the encrypted input sequence and types the unencrypted version into the session beginning at the specified row and column location.</p>
				<p>Typically in a 3270 or a 5250 environment, for a confidential key sequence such as a password, the host application creates a non-input field as the destination of the input key sequence, so blanks or asterisks (*) are displayed instead of the plain text.</p>
				<p>However, a security exposure still exists if the macro script exposed to more than casual view. A clever foe who gains access a copy of the macro script can discover the original unencrypted key sequence by editing the Row and Column fields of the Input so that during macro playback the macro runtime types the input key sequence into a normal displayable field.</p>
				<p>For greater security, you can use a Prompt action instead of Input action. With a Prompt action, the input key sequence is stored in the macro script, not even in encrypted form. Instead, macro playback, when the macro runtime processes the Prompt action, the macro runtime pops up a window with an input field and a prompting the end user to type an input key sequence. When the user types the input key sequence and clicks OK, the macro removes the popup window and directs the input key sequence into session window at the specified row and column location.</p>
				<p>Using an Input action does have this advantage, that the script runs automatically during macro playback without the end having to intervene. However, if the confidential data changes (example, if a password expires and a new and different password required) then the Input action must be updated with the new key sequence.</p>
				<h5 id="wq182">Automatic encryption during macro recording</h5>
				<p>During macro recording, for 3270 Display and 5250 Display only, the Record Password option controls how Host On-Demand an input key sequence typed into a 3270 or 5250 non-display field.</p>
				<p>If Record Password is enabled (the default), then Host On-automatically records such an input key sequence as an Input with an encrypted input key sequence. If Record Password is disabled, then Host On-Demand records such an input key sequence as a action. For more information see <button onclick="scrollHere('msec_recordpassword')">Record password</button>.</p>
				<h5 id="wq183">Using the Password checkbox</h5>
				<p>If the input key sequence was automatically encrypted during recording, then when you look at the Input action in the Macro Editor, the Password checkbox is selected (checked) and the String field some number of asterisks (such as <samp class="xph">******</samp>) the encrypted input key sequence.</p>
				<p>In contrast, if the input key sequence was not automatically during macro recording (perhaps because the session was not a or 5250 display session, or perhaps because the input field was a non-display input field) then the Password checkbox is cleared (checked) and the String field contains some unencrypted input sequence.</p>
				<p>If the input key sequence was not automatically encrypted macro recording, you can encrypt it in the Macro Editor. Follow steps to encrypt the input key sequence. Before you start, clear (uncheck) the Password checkbox if it is not already cleared.</p>
				<ol type="1">
					<li>If the input key sequence that you want is not already in the String field, type the input key sequence into the String field.  				<ul>
							<li>The input key sequence appears normally in the String field (example, <samp class="xph">'myPassWord'</samp>).</li>
							<li>If you are using the advanced macro format, remember to the input key sequence in single quotes (<samp class="xph">'myPassWord'</samp>).</li>
						</ul>
					</li>
					<li>Select the Password checkbox.
						<ul>
							<li> The Macro Editor encrypts the input key sequence and it in the String field using asterisks (<samp class="xph">***********************</samp>).</li>
						</ul>
					</li>
				</ol>
				<p>If you want to create an encrypted input key sequence, but do not want the input key sequence to be displayed in form as you type it into the String field, use the following method:</p>
				<ol type="1">
					<li>Clear the String field if it is not already empty.</li>
					<li>Select the Password checkbox.</li>
					<li>Type the input key sequence into the String field.
						<ul>
							<li>If you are using the advanced macro format, remember to the input key sequence in single quotes (<samp class="xph">'myPassWord'</samp>).</li>
							<li>As you type into the String field, the Macro Editor displays characters using asterisks (<samp class="xph">'myPassword'</samp> is displayed as <samp class="xph">************</samp>).</li>
							<li>When the input focus leaves the String field (that is, when click some other field) then the Macro Editor encrypts the input sequence.</li>
						</ul>
					</li>
				</ol>
				<p>After the input key sequence is encrypted, you may decide you do not want it to be encrypted or that you want to revise it.</p>
				<p>If the input key sequence is encrypted and you decide that do not want it to be encrypted, then follow these steps: </p>
				<ol type="1">
					<li>Clear the Password checkbox.
						<ul>
							<li>The Macro Editor discards the encrypted string and clears String field.</li>
							<li>If for some reason the String field is not cleared, then the characters in it using the backspace key or the delete key.</li>
						</ul>
					</li>
					<li>Type the unencrypted input key sequence into the String field.</li>
				</ol>
				<p>If the input key sequence is encrypted and you decide that want to revise it, follow these steps:</p>
				<ol type="1">
					<li>Clear the String field using the backspace key or the delete key.  				<ul>
							<li>Delete the entire encrypted input key sequence, so that the is empty.</li>
						</ul>
					</li>
					<li>Type the revised input key sequence into the String field.
						<ul>
							<li>If you are using the advanced macro format, remember to the input key sequence in single quotes (<samp class="xph">'myPassWord'</samp>).</li>
							<li>As you type into the String field, the Macro Editor displays characters using asterisks (<samp class="xph">'myPassword'</samp> is displayed as <samp class="xph">************</samp>).</li>
							<li>When the input focus leaves the String field (that is, when click some other field) then the Macro Editor encrypts the input sequence.</li>
						</ul>
					</li>
				</ol>
				<p>Do not try to revise an encrypted input key sequence by over or inserting characters into the string of asterisks in the field (<samp class="xph">*******</samp>)! If you do, then you corrupt the input key sequence with your unencrypted revisions. Then the Editor, believing that you have typed in an unencrypted string, re-the corrupted sequence. The result is that during macro playback, when the macro runtime processes the Input action, the decrypted is not the input key sequence that you expected. (Also, if you using the advanced macro format and you do not enclose the input key sequence with single quotes, the Macro Editor an error message).</p>
				<h5 id="wq188">Using the Code Editor</h5>
				<p>The Code Editor follows the same rules for encrypting an key sequence as the Macro Editor.</p>
				<p>The Code Editor always allows you to do either of the actions:</p>
				<ul>
					<li>Type into the editable text area a new &lt;input&gt; element encrypts the input key sequence.</li>
					<li>Paste from the system clipboard into the editable text area an &lt;input&gt; element that encrypts the input key sequence.</li>
				</ul>
				<p>You can also, while using the Code Editor, change the value  the <strong>encrypted</strong> attribute (which activates deactivates encryption) from true to false, or false to true.</p>
				<p>However, if you want to use the Code Editor to modify the of the <strong>value</strong> attribute (which contains the or unencrypted input key sequence), and the <strong>encrypted</strong> is set to true, then completely delete the encrypted input key (so that it reads <samp class="xph">value=""</samp>), then type in the new key sequence that you want encrypted.</p>
				<p>Do not try to revise an encrypted input key sequence by over or inserting characters into an encrypted input key in the <strong>value</strong> attribute! If you do, then corrupt the encrypted input key sequence with your unencrypted revisions.</p>
				<h5 id="wq189">Encrypting a variable name</h5>
				<p>Although you can type a variable name (such as <samp class="xph">$var1$</samp>) into the String field in the Macro Editor (or into the value of the <strong>value </strong>attribute in the Code Editor) encrypt the name of the variable (using the same steps that you use to encrypt a normal input key sequence) this normally is not useful thing to do. The reason is that when you encrypt a name only the characters making up the variable name are encrypted.The contents of the variable itself are not encrypted.</p>
				<p>During macro playback, the macro runtime decrypts the text to get the plain text (such as <samp class="xph">$var1$</samp>), sees the plain text is a variable name, and then evaluates the in the usual way.</p>
				<h4 id="ma_input_hostid">Specifying a session</h4>
				<p>Use the Host ID field to specify the session in which you this action to be performed:</p>
				<ul>
					<li>If you want this action to be performed in the session that the macro, then leave the Host ID field blank.</li>
					<li>If you want this action to be performed in some other session, type a session reference into the Host ID field (see <button onclick="scrollHere('ms_hostid')">Specifying a Host ID</button>).</li>
				</ul>
				<p>If the referenced session is active, then you can use any editing feature with the referenced session (see <button onclick="scrollHere('ms_auto_edit')">Using automatic editing features with other sessions</button>).</p>
				<h4 id="wq190">Example</h4>
				<p>See <button onclick="scrollHere('ma_copypaste_section')">Copy and paste example</button>.</p>
				<h3 id="ma_message">Message action (&lt;message&gt; element)</h3>
				<p>The Message action displays a popup window that includes a title, a message, and an OK button. The macro runtime does not the action until the user clicks OK.</p>
				<p>You can use this message in many scenarios, such as the following:</p>
				<ul>
					<li>To display an instruction, error message, or status message the user.</li>
					<li>To suspend execution of the macro until the user has some action.</li>
					<li>To display values for debugging.</li>
				</ul>
				<h4 id="wq191">Displaying the message caption and message text</h4>
				<p>You should specify in the Message Title input field the that you want to be displayed in the caption bar of the message window.</p>
				<p>You should specify in the Message Text input field the text you want to be displayed inside the message window.</p>
				<p>Because both input fields expect a string as the input value, can specify any entity that evaluates to a string (see <button onclick="scrollHere('me_equivalents')">Equivalents</button>). If you use an arithmetic expression the expression itself can contain immediate values, variables, expressions, and calls to Java methods (see <button onclick="scrollHere('me_arithmetic')">Arithmetic operators and expressions</button>).</p>
				<p>You can also use the data type conversion rules (see <button onclick="scrollHere('me_data_type_conversion')">Automatic data type conversion</button>) and the string concatenation (see <button onclick="scrollHere('me_string_concat_operator')">String concatenation operator (+)</button>). For example, if want to display the value of an integer variable named <samp class="xph">$intResult$</samp>, then you can specify in the Message Text input field the string:</p>
				<pre class="xmp"><code>'The result is ' + $intResult$ + '.'</code></pre>
				<p class="indatacontent"> If the of $intResult$ is 204, then the macro runtime displays in the box the following text:</p>
				<pre class="xmp"><code>The result is 204.</code></pre>
				<h3 id="ma_mouseclick">Mouse click action (&lt;mouseclick&gt; element)</h3>
				<p>The Mouse click action simulates a user mouse click on the window. As with a real mouse click, the text cursor jumps to the and column position where the mouse icon was pointing when the occurred.</p>
				<h4 id="wq192">Specifying row and column</h4>
				<p>In the lower area of the Actions window, specify the row and location on the session window where you want the mouse click to occur.Or, you can click on the session window itself, and the Macro updates the values in the Row and Column fields to reflect the location of the text cursor.</p>
				<h4 id="ma_mouseclick_hostid">Specifying a session</h4>
				<p>Use the Host ID field to specify the session in which you this action to be performed:</p>
				<ul>
					<li>If you want this action to be performed in the session that the macro, then leave the Host ID field blank.</li>
					<li>If you want this action to be performed in some other session, type a session reference into the Host ID field (see <button onclick="scrollHere('ms_hostid')">Specifying a Host ID</button>).</li>
				</ul>
				<p>If the referenced session is active, then you can use any editing feature with the referenced session (see <button onclick="scrollHere('ms_auto_edit')">Using automatic editing features with other sessions</button>).</p>
				<h4 id="ma_copypaste_section">Copy and paste example</h4>
				<p>The following example shows how to mark a block of text in session window, copy it to the system clipboard, and paste it into the session window at a new location. This example uses the action elements: Box selection action, Input action, Mouse click action, and Pause action.</p>
				<p>You can copy the text of this macro script from this document the system clipboard, and then from the system clipboard into Code Editor (see <button onclick="scrollHere('mg_ce_copypaste')">Copy and paste a script from this guide into the Code Editor</button>). After you save script in the Macro Editor, you can edit it either with the Editor or with the Code Editor.</p>
				<p> You should notice the following facts about this example:</p>
				<ul>
					<li>The example consists of one entire macro script named COPY PASTE.</li>
					<li>The following actions occur in the &lt;actions&gt; element:  				<ul>
							<li>The &lt;boxselection&gt; action draws a marking rectangle.</li>
							<li>A &lt;pause&gt; action waits one-half second so that when the is played back, the user can see what is happening.</li>
							<li>An &lt;input&gt; action types a [copy] action, which copies the area to the clipboard.</li>
							<li>A &lt;mouseclick&gt; action sets the cursor to the location the paste will take place.</li>
							<li>An &lt;input&gt; action types a [paste] key, which pastes the of the clipboard to the new location on the session window.</li>
						</ul>
					</li>
					<li>This macro is written to be run from the ISPF Primary Option (see <button onclick="scrollHere('mx_fig_ispf_pom')">Figure 5</button>). The macro copies the text <samp class="xph">Display and Search Facility</samp> from row 18 to the system clipboard, and then pastes the text from the clipboard to the <samp class="xph">Option ===&gt;</samp> field in line 4.</li>
					<li>If this example does not paste properly when you run it, sure that the target area that you have specified lies within a or 5250 input field. The Host On-Demand client does not let you text into a protected field in the application screen.</li>
				</ul>
				<div class="figrules" id="mc1_fig_copypaste01"><span class="figcap">Figure 34. Sample code COPY PASTE</span>
					<pre class="xmp"><code>&lt;HAScript name="COPY PASTE" description=" " timeout="60000" pausetime="300"             promptall="true" author="" creationdate="" supressclearevents="false"             usevars="false" &gt;     &lt;screen name="Screen1" entryscreen="true" exitscreen="true"             transient="false"&gt;       &lt;description&gt;          &lt;oia status="NOTINHIBITED" optional="false" invertmatch="false" /&gt;       &lt;/description&gt;       &lt;actions&gt;          &lt;boxselection type="SELECT" srow="18" scol="19"                  erow="18" ecol="51" /&gt;          &lt;pause value="500" /&gt;          &lt;input value="[copy]" row="0" col="0" movecursor="true"                  xlatehostkeys="true" encrypted="false" /&gt;          &lt;mouseclick row="4" col="15" /&gt;          &lt;input value="[paste]" row="0" col="0" movecursor="true"                  xlatehostkeys="true" encrypted="false" /&gt;       &lt;/actions&gt;       &lt;nextscreens timeout="0" &gt;       &lt;/nextscreens&gt;    &lt;/screen&gt;  &lt;/HAScript&gt;</code></pre>
				</div>
				<h3 id="ma_pause">Pause action (&lt;pause&gt; element)</h3>
				<p>The Pause action waits for a specified number of milliseconds then terminates.</p>
				<p>More specifically, the macro runtime finds the &lt;pause&gt; element, reads the duration value, and waits for the specified number of milliseconds.Then the macro runtime goes on to perform the next item.</p>
				<p>Uses for this action are:</p>
				<ul>
					<li>Any situation in which you want to insert a wait.</li>
					<li>Waiting for the host to update the session window. For more see <button onclick="scrollHere('mt_screen_completion')">Screen completion</button>.</li>
					<li>To add delay for debugging purposes.</li>
				</ul>
				<p>You should type the number of milliseconds in the Duration field. The default is 10000 milliseconds (10 seconds).</p>
				<h3 id="ma_perform">Perform action (&lt;perform&gt; element)</h3>
				<p>The Perform action invokes a method belonging to a Java class you have imported (see <button onclick="scrollHere('mv_variables_imported')">Creating an imported type for a Java class</button>).</p>
				<p>You can invoke a method in many other contexts besides the action. However, the Perform action is useful in certain scenarios, for example, when you want to invoke a method that does not a value.</p>
				<p>Some of the contexts, other than the Perform action, in which can invoke a method are as follows:</p>
				<ul>
					<li>You can invoke a method and assign the return value to a by using the Update variable action. The variable that receives return value can be either a variable belonging to a standard (boolean, integer, string, double) or a variable belonging to an type (for example, a variable named $objTmp$ that belongs to the type Object, based on the Java class Object).</li>
					<li>You can invoke a method and use the return value as a in a macro action by specifying the method call in the field for parameter. For example, in the Row parameter of an Extract you can use a method call that returns an integer value. The runtime sees that the parameter is a method call , invokes the method, and uses the integer return value as the value of the Row parameter.</li>
					<li>You can invoke a method as part of any expression by using method call as a term in the expression. When the macro runtime the expression, it sees that the term is a method call, invokes method, and uses the value of the method (for example, a string) the value of the term.</li>
					<li>You can invoke a method and use the return value as the value of a variable that you have just declared.</li>
				</ul>
				<p class="indatacontent">In general, outside the Perform action, you can invoke a in any context in which the value returned by the method is valid.</p>
				<h4 id="wq193">Invoking the method</h4>
				<p>Type the method call into the Action to Perform field. You enclose a method call in dollar signs ($), just as you would a (see <button onclick="scrollHere('mv_syntax_of_method_calls')">Syntax of a method call</button>). The macro invokes the method. See also <button onclick="scrollHere('mv_how_search_for_method')">How the macro runtime searches for a called method</button>.</p>
				<h4 id="wq194">Examples</h4>
				<p>The following examples show how to invoke a method using the action. You should notice the following facts about these examples:</p>
				<ul>
					<li>In Example 1, the Perform action calls the update() method the variable $importedVar$. Notice that:  				<ul>
							<li>The entire method call is enclosed in dollar signs ($).</li>
							<li>In the context of a method call, the variable name itself (<samp class="xph">importedVar</samp>) is not enclosed in dollar signs ($).</li>
							<li>A variable passed as a parameter to a method must be in dollar signs ($) as usual (<samp class="xph">$str$</samp>).</li>
							<li>A string passed as a parameter to a method must be enclosed single quotes as usual (<samp class="xph">'Application'</samp>).</li>
						</ul>
					</li>
					<li>In Example 2, the Perform action calls a static method.</li>
					<li>In Example 3, the Perform action calls the close() method to the class to which the variable belongs, such as java.io.FileInputStream.</li>
					<li>In Example 4, the Perform action calls the createZipEntry() belonging to the class to which the variable belongs, such as java.util.zip.ZipInputStream.</li>
					<li>In Example 5, the Perform action calls the clear() method to the class to which the variable belongs, such as java.util.Hashtable.</li>
				</ul>
				<div class="figrules" id="wq195"><span class="figcap">Figure 35. Examples of the Perform action</span>
					<pre class="xmp"><code>   &lt;actions&gt;       &lt;!-- Example 1 --&gt;       &lt;perform value="$importedVar.update( 5, 'Application', $str$)$" /&gt;        &lt;!-- Example 2 --&gt;       &lt;perform value="$MyClass.myInit('all')$" /&gt;        &lt;!-- Example 3 --&gt;       &lt;perform value="$fip.close()$" /&gt;        &lt;!-- Example 4 --&gt;       &lt;perform value="$zis.createZipEntry( $name$ )$" /&gt;        &lt;!-- Example 5 --&gt;       &lt;perform value="$ht.clear()$" /&gt;    &lt;/actions&gt;</code></pre>
				</div>
				<h3 id="ma_playmacro">PlayMacro action (&lt;playmacro&gt; element)</h3>
				<p>The PlayMacro action launches another macro.</p>
				<p>When the macro runtime performs a PlayMacro action, it the current macro (the one in which the PlayMacro action occurs) begins to process the specified macro screen of the target macro.This process is called chaining. The calling macro is said to "to" the target macro. There is no return to the calling macro.</p>
				<p>You must specify in the PlayMacro action the name of the macro and, optionally, the name of the macro screen in the macro that you want the macro runtime to process first.</p>
				<p>You can have the macro runtime transfer all of the variables their contents from the calling macro to the target macro.</p>
				<h4 id="ma_pm_adding_a_playmacro_action">Adding a PlayMacro action</h4>
				<p>Outside of a Condition element:</p>
				<ul>
					<li>You can add only one PlayMacro action to a macro script, and PlayMacro action must be the last action in the Actions list (&lt;actions&gt; element) of the macro script.</li>
				</ul>
				<p>Inside a Condition element:</p>
				<ul>
					<li>You can add one PlayMacro action to the Condition is True (&lt;if&gt; element), and that PlayMacro action must be the last in the branch (&lt;if&gt; element).</li>
					<li>You can also add one PlayMacro action to the Condition is branch (&lt;else&gt; element), and that PlayMacro action must be last action in the branch (&lt;else&gt; element).</li>
				</ul>
				<p>You can have as many Condition elements in the macro as you like, with each Condition element containing one PlayMacro action in Condition is True branch and one PlayMacro action in its is False branch.</p>
				<p>The Macro Editor and the Code Editor enforce these rules.</p>
				<h4 id="ma_pm_name_and_starting_screen">Target macro file name and starting screen</h4>
				<p>Use the Macro Name field to specify the name of the target macro.If you are chaining macros in a Server Library, you must specify name of the macro file rather than the name of the macro. that macro names are case-sensitive! For example, <samp class="xph">mymacro1</samp> a different name than <samp class="xph">myMacro, myMACRO, MyMacro</samp>, and on.</p>
				<p>You cannot call a macro that resides in a different location the calling macro. Specifically:</p>
				<ul>
					<li>A macro in the Current Session can call only macros that are the Current Session.</li>
					<li>A macro in the Personal Library can call only macros that in the Personal Library.</li>
					<li>A macro in a Server Library can call only macros that are in Server Library.</li>
					<li>A macro in a User Library can call only macros that are in same User Library (same directory).</li>
				</ul>
				<p>Use the Start Screen Name listbox to select the macro screen the target macro that you want the macro runtime to process first:</p>
				<ul>
					<li>If you want to start the target macro at its usual start screen, then select the *DEFAULT* entry in the Start Screen Name listbox, or provide an expression that evaluates to the value *DEFAULT*.</li>
					<li>If you want to start the target macro at some other screen, select the name of that screen in the Start Screen Name listbox.</li>
				</ul>
				<h4 id="ma_transferring_variables">Transferring variables</h4>
				<p>You can have the macro runtime transfer to the target macro the variables that belong to the calling macro, including the of those variables, by setting the Variable Transfer listbox to (the default is No Transfer).</p>
				<p>This transferring of variables and their contents allows you use variables to pass parameters from the calling macro to the macro.</p>
				<p>After the target macro gets control, it can read from and to the transferred variables in the same way that it reads from writes to variables that it has declared itself.</p>
				<p>For example, if MacroA currently has two integer variables StartRow and StartCol, with values of 12 and 2, and then MacroA MacroB with a PlayMacro action, then MacroB starts out having StartRow and StartCol with values of 12 and 2.</p>
				<p>Even if the transferred variable belongs to an imported type contains a Java object, the target macro can still refer to the variable and call methods on the Java object, or can write some object into that transferred variable.</p>
				<h5 id="wq196">Requirements for transferring variables</h5>
				<p>The target macro must have selected the advanced macro format (see <button onclick="scrollHere('me_choosing_a_format')">Choosing a macro format</button>).</p>
				<h5 id="wq197">Restriction</h5>
				<p>Please notice the following restriction on all types of variables:</p>
				<ul>
					<li>You cannot use the transferred variable in the Initial Value of the Variables tab of the target macro.</li>
				</ul>
				<h5 id="wq198">Additional information</h5>
				<p>If the target macro creates a variable with the same name and as a transferred variable, then the macro runtime uses the variable rather than the transferred variable.</p>
				<h5 id="wq199">When the target macro needs to import a type</h5>
				<p>In the target macro, if you want to use a transferred that belongs to an imported type, then you do not need to import same type in the target macro. Examples of operations where you not need to import the type are as follows:</p>
				<ul>
					<li>Using the transferred variable as the value of an attribute.</li>
					<li>Calling a method on the transferred variable.</li>
				</ul>
				<p>However, in the target macro, if you want to use the name of imported type, then you must import that type. Examples of where you must import the type:</p>
				<ul>
					<li>Declaring a new variable of the imported type.</li>
					<li>Creating a new instance of the imported type.</li>
					<li>Calling a static method of the imported type.</li>
				</ul>
				<h4 id="wq200">Examples</h4>
				<p>The following example shows a PlayMacro action:</p>
				<div class="figrules" id="wq201"><span class="figcap">Figure 36. Example of the PlayMacro action</span>
					<pre class="xmp"><code>&lt;actions&gt;    &lt;playmacro name="TargetMacro" startscreen="*DEFAULT*"             transfervars="Transfer" /&gt; &lt;/actions&gt;  </code></pre>
				</div>
				<h3 id="ma_print">Print actions (&lt;print&gt; element)</h3>
				<p>The Print actions allow you to print text from the session of a 3270 Display session. You can print the entire application screen, or you can print a rectangular area of text from the application screen.You can use the same printer setup options and most of the same setup options that are available for a 3270 Printer session.</p>
				<p>You can use the Print actions only with a 3270 Display session.</p>
				<p>The Print actions do not create a host print session. Rather, Print actions print data that is displayed in the 3270 Display window (screen print).</p>
				<p>The Print actions are:</p>
				<ul>
					<li>Print Start</li>
					<li>Print Extract</li>
					<li>Print End</li>
				</ul>
				<p class="indatacontent">The Print Start action instantiates a print bean object for current macro and sets the Printer Setup options and the Page options for the bean. The Print Extract action sends text to the bean. The Print End action terminates the print bean.</p>
				<p>Although the Macro Editor presents Print Start, Print Extract, and Print End as separate types of action, in fact the Macro stores all three using the &lt;print&gt; element.</p>
				<h4 id="ma_pr_print_start">Print Start</h4>
				<p>The Print Start action instantiates a print bean object for current macro using the Printer Setup options and the Page Setup that you specify.</p>
				<p> Before performing a Print Start action, the macro runtime to see if a print bean already exists for the current macro. If so, then the macro runtime terminates the existing print bean and performs the Print Start action to instantiate a new print bean.</p>
				<h5 id="ma_pr_printer_setup_and_page_setup">Printer Setup and Page Setup</h5>
				<p>Click Printer Setup to set the printer setup options for the print bean. You can control the same printer setup options as available for a 3270 Printer session, including Printer (Windows Printer, Other Printer, or File), Printer Definition Tables, and Adobe PDF output for the File destination.</p>
				<p>Click Page Setup to set the page setup options for the new bean. You can control the same page setup options that are for a 3270 Printer session and that also are appropriate for the Display datastream (LU2), including Font, treatment of nulls (0x00), and Printer-Font Code Page.</p>
				<p>The Printer Setup options and the Page Setup options that you for a print bean for the current macro do not affect the printer options and page setup options for:</p>
				<ul>
					<li>A print bean in a macro running on another 3270 Display session.</li>
					<li>Any ZipPrint in any 3270 Display session.</li>
					<li>Any File &gt; Print Screen operation in any 3270 Display session.</li>
					<li>A 3270 Printer session.</li>
				</ul>
				<p> However, if your print destination is a Windows printer, and use the Microsoft Windows Print Setup dialog to make changes to that Windows printer, such as an orientation of rather than Portrait, then those particular configuration affect any Host On-Demand printing activity that uses that printer, including:</p>
				<ul>
					<li>A print bean in a macro running on any 3270 Display session.</li>
					<li>ZipPrint in any 3270 Display session.</li>
					<li>Printing from any 3270 Printer session.</li>
				</ul>
				<h5 id="wq202">Assign Return Code to a Variable</h5>
				<p>If you want to verify that the Print Start action is successful, then click Assign Return Code to a Variable and select a to hold the return code from the Print Start action.</p>
				<div>
					<div class="notetitle" id="wq203">Note: </div>
					<div class="notebody">return code will be either 0 for success or -1 for failure. Also, there are some printer errors that can end the macro with errors.
					</div>
				</div>
				<h4 id="ma_pr_print_extract">Print Extract</h4>
				<p>The Print Extract action copies the text from a rectangular of the 3270 Display session window that you specify and prints text using the current print bean.</p>
				<p> Before performing a Print Extract action, the macro runtime to see if a print bean has been started for the current macro. not, then the macro runtime performs a Print Start action with default printer setup options and the default page setup options, and then performs the Print Extract action.</p>
				<h5 id="ma_pr_rect_area">Specifying the area to be printed</h5>
				<p>To specify the area of the session window that you want to print, you can either use the marking rectangle to gather the row and coordinates, or else you can type the row and column coordinates the text area into the Row and Column fields on the Extract window.</p>
				<p>If you are using the marking rectangle (see <button onclick="scrollHere('mg_bounding_rectangle')">Using the marking rectangle</button>) then the macro runtime writes row and column coordinates of the upper left corner of the rectangle into the first pair of Row and Column values (labeled Corner on the Extract action window) and the row and column of the lower right corner into the second pair of Row and Column (labeled Bottom Corner).</p>
				<p>If you enter the Row and Column values yourself, then type first set of row and column coordinates into the first pair of and Column values (labeled Top Corner on the Extract action window) and type the second set of coordinates into the second pair of and Column values (labeled Bottom Corner). You can use the text on the session window as an aid to determine the coordinates you want (see <button onclick="scrollHere('mg_using_text_cursor')">Using the session window's text cursor</button>).</p>
				<p>In the Row (Bottom Corner) input field you can enter <samp class="xph">-1</samp> signify the last row of the data area on the session window. feature is helpful if your users work with session windows of heights (such as 25, 43, 50) and you want to capture data down the last row. Similarly for the Column (Bottom Corner) input you can enter <samp class="xph">-1</samp> to signify the last column of the on the session window (see <button onclick="scrollHere('me1_negative_row_or_col')">Significance of a negative value for a row or column</button>).</p>
				<h5 id="wq204">Assign Return Code to a Variable</h5>
				<p>If you want to verify that the Print Extract action is successful, then click Assign Return Code to a Variable and select a to hold the return code from the Print Extract action.</p>
				<div>
					<div class="notetitle" id="wq205">Note: </div>
					<div class="notebody">return code will be either 0 for success or -1 for failure. Also, there are some printer errors that can end the macro with errors.</div>
				</div>
				<h5 id="ma_pr_print_extract_hostid">Specifying a session</h5>
				<p>Use the Host ID field to specify the session in which you this action to be performed:</p>
				<ul>
					<li>If you want this action to be performed in the session that the macro, then leave the Host ID field blank.</li>
					<li>If you want this action to be performed in some other session, type a session reference into the Host ID field (see <button onclick="scrollHere('ms_hostid')">Specifying a Host ID</button>).</li>
				</ul>
				<p>If the referenced session is active, then you can use any editing feature with the referenced session (see <button onclick="scrollHere('ms_auto_edit')">Using automatic editing features with other sessions</button>).</p>
				<h4 id="ma_pr_print_end">Print End</h4>
				<p>The Print End action terminates the current print bean if one exists.If a current print bean does not exist then the action has no effect.</p>
				<h5 id="ma_pr_assign_rc">Assign Return Code to a Variable</h5>
				<p>If you want to verify that the Print End action is successful, then click Assign Return Code to a Variable and select a to hold the return code from the Print End action.</p>
				<div>
					<div class="notetitle" id="wq206">Note: </div>
					<div class="notebody">return code will be either 0 for success or -1 for failure. Also, there are some printer errors that can end the macro with errors.</div>
				</div>
				<h3 id="ma_prompt">Prompt action (&lt;prompt&gt; element)</h3>
				<p>The Prompt action provides a powerful way to send immediate keyboard input into the 3270 or 5250 application or into a variable.</p>
				<p>The Prompt action displays on top of the session window a window that contains a message, an input field, and three (OK, Cancel, Help). After the user types text into the input and clicks OK, the Prompt action uses the input in one or both the following ways:</p>
				<ul>
					<li>The Prompt action types the input into an input field of the window.</li>
					<li>The Prompt action interprets the input as a string and the input into a variable.</li>
				</ul>
				<p>A typical use of this action, but by no means the only use, to permit the user to provide a password. Many scenarios require a macro log on to a host or start an application that requires a for access. Because a password is sensitive data and also changes from time to time, you probably do not want to code the as an immediate value into the macro.</p>
				<p>With the Prompt action, you can display a message that the user for a password and that lets the user type the password the input field. After the user clicks OK, the macro runtime the input into the session window at the row and column location you specify. The input sequence can include action keys such as [enterreset], so that if the user types <samp class="xph">MyPassword[enterreset]</samp> the runtime not only can type the password into the password field also can type the key that completes the logon or access action. (Or, you can put the action key into an Input action that immediately the Prompt action.)</p>
				<h4 id="wq207">Displaying the prompt window</h4>
				<h5 id="ma_prompt_parts">Parts of the prompt window</h5>
				<p>You should type the prompt text (such as <samp class="xph">'Please type password:</samp>') into the Prompt Name field, not into the Text field. (The Prompt Text field is an optional field than you use to store a note containing details about the particular action.)</p>
				<p>The macro runtime displays a prompt window with the following characteristics:</p>
				<ul>
					<li>The prompt window appears on top of the session window and located in the center of the system's desktop window.</li>
					<li>The title of the prompt window is the value of the Prompt field unless that field is blank or there are multiple prompts the macro and the macro is configured to show all prompts at the of the macro. In those two instances, the title of the prompt will be "Prompt".</li>
					<li>The message that you typed into the Prompt Name field is in the center of the prompt window, followed by an input field.</li>
					<li>A button row across the bottom of the prompt window contains buttons:  				<ul>
							<li>The OK button causes the macro runtime to process the of the input field.</li>
							<li>The Cancel button halts the macro.</li>
							<li>The Help button displays help text explaining how to use the window.</li>
						</ul>
					</li>
				</ul>
				<h5 id="ma_prompt_default_response">Default Response</h5>
				<p>In the Default Response field, which is optional, you can the text of a default response that you want to appear in the field of the prompt window when the prompt window is displayed. the user does not type any keyboard input into the input field the prompt window, but rather just clicks OK to indicate that is complete, then the macro runtime processes the default that is contained in the input field.</p>
				<p>For example, if the user normally uses ApplicationA but uses ApplicationB, you could type <samp class="xph">ApplicationA</samp> into Default Response field. When the macro runtime performs the action, the prompt window appears with the text <samp class="xph">ApplicationA</samp> displayed in the input field. The user either can click OK (in case the macro processes <samp class="xph">ApplicationA</samp> as the contents the input field) or else can type <samp class="xph">ApplicationB</samp> into input field and then click OK (in which case the macro processes <samp class="xph">ApplicationB</samp> the contents of the input field).</p>
				<h5 id="ma_prompt_password_response">Password Response</h5>
				<p>If you select true in the Password Response listbox (the is false) then when the user types each key into the input field the prompt window, the macro runtime displays an asterisk (*) of the character associated with the key.</p>
				<p>For example, with the Password Response listbox set to true (resolving to true at runtime) then if the user types 'Romeo' the runtime displays <samp class="xph">*****</samp> in the input field.</p>
				<h5 id="ma_prompt_require_response">Require Response</h5>
				<p>If you select true in the Require Response listbox (the is false) then:</p>
				<ul>
					<li>The macro runtime displays the text string <samp class="xph">(required)</samp> the right of the input field, to indicate to the end user that is required for this input field.</li>
					<li>The macro runtime disables the OK button of the prompt until the input field of the prompt window contains text.  				<ul>
							<li>The input field can contain text either because you have a Default Response or because the user has typed text into the field.</li>
							<li>When OK is enabled, the end user can click either OK or Cancel, as usual:  						<ul>
									<li>Clicking OK causes the macro to process the Prompt action continue processing the macro.</li>
									<li>Clicking Cancel terminates the macro playback.</li>
								</ul>
							</li>
							<li>When OK is not enabled, the end user can click Cancel.
								<ul>
									<li>Clicking Cancel terminates the macro playback.</li>
								</ul>
							</li>
						</ul>
					</li>
				</ul>
				<p class="indatacontent">Thus, setting Require Response to true has the effects of the end user  (by displaying <samp class="xph">(required)</samp> to the right the input field) that a response is required before proceeding, of requiring the end user to enter text in the input field clicking OK (by disabling OK until the input field contains text).However, if the Prompt action contains a Default Response, then is enabled and the default response is displayed in the input field.</p>
				<p>If you select false in the Require Response listbox then:</p>
				<ul>
					<li>The macro runtime does not display  the text string <samp class="xph">(required)</samp>the right of the input field.</li>
					<li>The macro runtime enables the OK button on the prompt window as soon as the prompt window is displayed, whether or not the field contains text.
						<ul>
							<li>The user can click OK or Cancel, as usual:  						<ul>
									<li>Clicking OK causes the macro runtime to process the Prompt and then to continue processing the macro. In the Prompt action, the input field is blank, the macro runtime does not send an key sequence to session window.</li>
									<li>Clicking Cancel terminates the macro playback.</li>
								</ul>
							</li>
						</ul>
					</li>
				</ul>
				<p class="indatacontent">Thus, setting Require Response to false has the effect of the user to continue processing the macro by clicking OK, even the input field of the prompt is blank.</p>
				<p>If the<strong> promptall</strong> attribute of the &lt;HAScript&gt; element (or of the &lt;actions&gt; element) is set to true, and you several prompt actions in the macro (or in the macro screen) Require Response set to true, then at the start of macro (or at the start of the playback of the macro screen),  when the runtime displays all the prompt input fields in a single prompt window, the macro runtime does not enable the OK button in the prompt until all required input fields contain text (see <button onclick="scrollHere('ma_prompt_promptall')">The promptall attributes</button> ).</p>
				<h4 id="wq208">Processing the contents of the input field</h4>
				<h5 id="ma_prompt_response_length">Response Length</h5>
				<p>The value in the Response Length field specifies not the size the input field, but the number of characters that the macro allows the user to type into the input field.</p>
				<p>For example, if you set the Response Length field to 10, then macro runtime allows the user to type only 10 characters into input field.</p>
				<h5 id="ma_prompt_translate_action_keys">Action keys and Translate Host Action Keys</h5>
				<p>Both you (in the Default Response input field) and the user (the input field of the Prompt window) can use action keys (such [enterreset], [copy], and so on) as you would in the String of an Input action (see <button onclick="scrollHere('ma_input_string')">Input string</button>).</p>
				<p>The Translate Host Action Keys listbox and its effect are like the Translate Host Action Keys listbox in the Input action (see <button onclick="scrollHere('ma_input_translate_host_action_keys')">Translate Host Action Keys</button>). If you set this to true, which is the default value, then the macro runtime an action key string (such as [copy]) as an action key rather as a literal string.</p>
				<h4 id="ma_prompt_handling_input_sequence">Handling the input sequence in the session window</h4>
				<p>Use the Row and Column fields to specify the row and column on the session window at which you want the macro runtime to typing the input sequence. To have the macro runtime start the input sequence at the current position of the text cursor, can set either or both of the Row and Column fields to 0. As the Input action, the row and column position must lie within a or 5250 input field at runtime, or else the session window by inhibiting the input and displaying an error symbol in the Information Area, just as it responds to keyboard input from an user.</p>
				<p>You can have the macro runtime clear the contents of the field before typing begins, by setting the Clear Host Field to true.</p>
				<p>The Move Cursor to End of Input field has the same function effects as the button of the same name in the Input action (see <button onclick="scrollHere('ma_move_cursor')">Move Cursor to End of Input</button>).</p>
				<p>You can have the macro runtime not display the input sequence the input field by setting the Don't Write to Screen listbox to true.This field is enabled only when the Assign to a Variable is selected.</p>
				<h4 id="ma_prompt_assigning_seq_to_var">Assigning the input sequence to a variable</h4>
				<p>You can have macro runtime store the input sequence into a by checking the Assign to a Variable checkbox.</p>
				<p>Create a new variable by clicking the <samp class="xph">&lt;New Variable&gt;</samp> in the listbox. In the popup window for specifying a new variable, you can specify the name of a variable that the current macro from another macro, or you can specify the name of a new that you want to create in the current macro. If you want to a new variable in the current macro, select the <samp class="xph">Create in this macro</samp> checkbox and select the type of the new variable.</p>
				<p>The macro runtime stores the input sequence as a string, and you could specify a string variable as the variable to receive input. However, if the variable is of some other type than string, then the macro runtime tries to convert the input to the data of the target variable according to the usual rules (see <button onclick="scrollHere('me_data_type_conversion')">Automatic data type conversion</button>).</p>
				<h4 id="ma_prompt_promptall">The promptall attributes</h4>
				<p>You can have the macro runtime combine the popup windows from all &lt;prompt&gt; elements into one large prompt window and display this large window at the beginning of the macro playback, by setting the <strong>promptall</strong> attribute of the &lt;HAScript&gt; to true (see <button onclick="scrollHere('mr_hascript')">&lt;HAScript&gt; element</button>).</p>
				<p>The <strong>promptall</strong> attribute in the &lt;actions&gt; element works similarly (see <button onclick="scrollHere('mr_actions')">&lt;actions&gt; element</button>).</p>
				<h4 id="ma_prompt_hostid">Specifying a session</h4>
				<p>Use the Host ID field to specify the session in which you this action to be performed:</p>
				<ul>
					<li>If you want this action to be performed in the session that the macro, then leave the Host ID field blank.</li>
					<li>If you want this action to be performed in some other session, type a session reference into the Host ID field (see <button onclick="scrollHere('ms_hostid')">Specifying a Host ID</button>).</li>
				</ul>
				<p>If the referenced session is active, then you can use any editing feature with the referenced session (see <button onclick="scrollHere('ms_auto_edit')">Using automatic editing features with other sessions</button>).</p>
				<h3 id="ma_runprogram">Run program action (&lt;runprogram&gt; element)</h3>
				<p>The Run program action launches a native application and waits for it to terminate. You can provide input parameters for application and store the return code in a variable.</p>
				<p>You can launch any application that can be run by the system runtime.</p>
				<p>The Run program action has many uses, such as the following: </p>
				<ul>
					<li>Launching a native application that prepares data that the needs, or that uses data that the macro has prepared.</li>
					<li>Launching a native application that prepares the workstation (example, by making a network connection) for an action that the is about to initiate.</li>
					<li>Launching a native application that detects the status of a condition and then reports the status back to the macro.</li>
				</ul>
				<h4 id="ma_rp_launching">Launching the native application</h4>
				<p>You should specify in the Program input field the complete and name of the file that launches the native application, for example:</p>
				<pre class="xmp"><code>'c:\\Program Files\\MyApp\\bin\\myapp.exe'</code></pre>
				<p class="indatacontent">should notice in the example above that a single backslash (\)is represented by two backslash characters (\\). The reason that in the advanced macro format the backslash is a special and therefore must be represented by a backslash + the character (see <button onclick="scrollHere('me_advanced_format_rules')">In the advanced macro format, rules for representation of strings, etc.</button>).</p>
				<p>You should specify in the Parameters field any parameters should be passed to the native application.</p>
				<h4 id="wq209">Waiting for the native application to terminate</h4>
				<p>If you want the macro runtime to wait until the native has terminated, set the Wait for Program listbox to true. The is false (the macro runtime does not wait).</p>
				<h4 id="wq210">Capturing the return code</h4>
				<p>You can capture the status code returned by the native in a variable by selecting the Assign Exit Code to Variable and specifying the name of a variable.</p>
				<h4 id="wq211">Example of launching a native application</h4>
				<p>The following example launches a native application, waits it to terminate, and then displays the return code from the in a message window. This example uses the following action elements: Run program action, Message action.</p>
				<p>You can copy the text of this macro script from this document the system clipboard, and then from the system clipboard into Code Editor (see <button onclick="scrollHere('mg_ce_copypaste')">Copy and paste a script from this guide into the Code Editor</button>). After you save script in the Macro Editor, you can edit it either with the Editor or with the Code Editor.</p>
				<p>You should notice the following facts about this example:</p>
				<ul>
					<li>The example consists of one entire macro script named RUN PROGRAM.</li>
					<li>The following actions occur in the &lt;actions&gt; element:  				<ul>
							<li>The &lt;runprogram&gt; element launches a native application, for it to return, and stores the return code into $intReturn$.</li>
							<li>A message action displays the value in $intReturn$ in a window.</li>
						</ul>
					</li>
				</ul>
				<div class="figrules" id="ma_fig_runprogram"><span class="figcap">Figure 37. Sample code RUN PROGRAM</span>
					<pre class="xmp"><code>&lt;HAScript name="g1" description=" " timeout="60000" pausetime="300"             promptall="true" author="" creationdate="" supressclearevents="false"             usevars="true" ignorepauseforenhancedtn="false"             delayifnotenhancedtn="0"&gt;    &lt;vars&gt;       &lt;create name="$intReturn$" type="integer" value="0" /&gt;    &lt;/vars&gt;    &lt;screen name="Screen1" entryscreen="true" exitscreen="true" transient="false"&gt;       &lt;description&gt;          &lt;oia status="NOTINHIBITED" optional="false" invertmatch="false" /&gt;       &lt;/description&gt;       &lt;actions&gt;          &lt;runprogram exe=
        		          "%ProgramFiles%\Windows NT\Accessories\wordpad.exe"                   param="’c:\\tm\\new_file.doc’" wait="true"                   assignexitvalue="$intReturn$" /&gt;          &lt;message title="" value="’Return value is ’+$intReturn$" /&gt;       &lt;/actions&gt;       &lt;nextscreens timeout="0" &gt;       &lt;/nextscreens&gt;    &lt;/screen&gt; &lt;/HAScript&gt;</code></pre>
				</div>
				<h3 id="ma_sqlquery">SQLQuery action (&lt;sqlquery&gt; element)</h3>
				<p>The SQLQuery action is a very useful and powerful action that you to send an SQL statement to a host database, retrieve any resulting from the SQL statement, and then either write the data a global variable, write the data into a file, or display the data.(A companion action, FileUpload, allows you to send a File command to a host database. See <button onclick="scrollHere('ma_fileupload')">FileUpload action (&lt;fileupload&gt; element)</button>.)</p>
				<p>You can use the SQLQuery action in any type of Host On-Demand that supports macros (3270 Display, 5250 Display, VT Display, or Gateway).</p>
				<p>The database server to which you connect can be on a host than the host running your emulator session.</p>
				<p>You can create an SQL statement manually, compose and test an statement using the SQL Wizard, or import an SQL statement from the current session or from a library of SQL statements.</p>
				<p>The SQLQuery action supports only SQL statements of type Select.It does not support SQL statements of type Insert, Update, or Delete.</p>
				<h4 id="wq212">Two sections: statement and results</h4>
				<p>The SQLQuery action window has two main sections: a statement and a result section.</p>
				<p>The statement section occupies the upper area of the window includes the following fields: Database URL, Driver Identifier, Class, User ID, Password, and Statement. You can modify the in this section in three ways:</p>
				<ul>
					<li>By creating an SQL statement in the SQL Wizard.</li>
					<li>By importing an SQL statement.</li>
					<li>By typing the information into the fields.</li>
				</ul>
				<p class="indatacontent">You can also edit any of the fields at any time by typing the field.</p>
				<p>The result section occupies the lower area of the window and the remaining fields: Output Result To, File Name, Show in Web browser, File Type, Hold on output dialog, Overwrite, and Append.</p>
				<h4 id="ma_sqlquery_using_sql_wizard">Using the SQL Wizard</h4>
				<p>You can use the SQL Wizard to create an SQL statement and it. The graphical user interface of the SQL Wizard makes it much to create an SQL statement, compared to typing in the entire of the SQL statement into the Statement field of the Macro Editor.Also, in the SQL Wizard you can run an SQL statement that you working on and view the results.</p>
				<ol type="1">
					<li>Click SQL Wizard to start the SQL Wizard.
						<ul>
							<li>If there is any information already in the fields of the section, then Host On-Demand uses this information to initialize corresponding fields in the SQL Wizard.</li>
						</ul>
					</li>
					<li>Use the SQL Wizard to create an SQL statement and test it.</li>
					<li>To close the SQL Wizard without changing your macro, click Cancel.</li>
					<li>To save the SQL statement to your macro, do one of the actions:  				<ul>
							<li>On the Review tab of the SQL Wizard, click Save; or</li>
							<li>On the Results tab of the SQL Wizard, click Save SQL.</li>
						</ul>
						The Macro Editor writes the information that you created in SQL Wizard into the appropriate fields of the statement section. already existing information in the fields of the statement is overwritten. If the information that the Macro Editor writes a field is a string (for example, the information written into Database URL field), then the Macro Editor also automatically formats the string depending on the underlying macro type (see <button onclick="scrollHere('me_basic_vs_advanced')">The basic macro format versus the advanced macro format</button>). The following fields are updated:  				<ul>
							<li>Fields in the statement section:  						<ul>
									<li>Database URL</li>
									<li>Driver Identifier</li>
									<li>Driver Class</li>
									<li>User ID</li>
									<li>Password</li>
									<li>Statement</li>
								</ul>
							</li>
							<li>Fields in the results section:  						<ul>
									<li>If, on the Output tab of the SQL Wizard, you selected to the query results to the Display, then the Macro Editor:  								<ul>
											<li>Sets the Output Result To field to Dialog.</li>
										</ul>
									</li>
									<li>If, on the Output tab of the SQL Wizard, you selected to the query results to a File, then the Macro Editor:  								<ul>
											<li>Sets the Output Result To field to File.</li>
											<li>Sets the File Name field to the file name that you specified the SQL Wizard.</li>
											<li>Sets the File Type field to the file type that you specified the SQL Wizard.</li>
											<li>Selects the Overwrite radio button or the Append radio button, depending on whether you selected overwrite or append in the SQL Wizard.</li>
											<li>If the file type is HTML or XML, saves the HTML settings or XML settings. The Macro Editor does not display these settings, you can see them, using the Code Editor, in the <strong>mlprops</strong> of the &lt;sqlquery&gt; element (see <button onclick="scrollHere('mr_sqlquery')">&lt;sqlquery&gt; element</button>).</li>
										</ul>
									</li>
								</ul>
							</li>
						</ul>
					</li>
					<li>Click Cancel to close the SQL Wizad.</li>
				</ol>
				<h4 id="wq214">Importing an SQL statement</h4>
				<p>Click Import Query to import an SQL statement. You can import SQL statement either from the current session or from a personal on the client workstation.</p>
				<p>To save an SQL statement so that someone can later import it, the SQL Wizard, create or open an SQL statement, run the SQL statement, go to the Results tab, and then click Save SQL. Use the Saved dialog to save the SQL statement to the current session or to a library.</p>
				<p>When you import an SQL statement, the Macro Editor writes the of the imported SQL statement into the fields of the statement section.The Macro Editor also automatically formats the new information for the underlying macro type (see <button onclick="scrollHere('me_basic_vs_advanced')">The basic macro format versus the advanced macro format</button>).Any already existing information in the fields of the statement is overwritten.</p>
				<h4 id="wq215">Using the fields in the statement section</h4>
				<p>Instead of creating an SQL statement with the SQL Wizard or an SQL statement, you can type the information directly into the of the statement section. You can also type into any of the after you have created or imported an SQL statement.</p>
				<h5 id="ma_sql_database_url">Database URL</h5>
				<p>In the Database URL field, type the database URL of the server that provides access to the database. The format of the URL depends on the type of Java Database Connectivity (JDBC) that you use to access the database (for more information on see <button onclick="scrollHere('ma_sql_driver_identifier')">Driver Identifier and Driver Class</button>). <button onclick="scrollHere('ma_sql_table_dburl')">Table 18</button> shows the format of the database URL the driver included with Host On-Demand.</p>
				<table id="ma_sql_table_dburl" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 18. Formats for database URL</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq216" align="left" valign="top">Driver provided with Host On-Demand:</th>
							<th id="wq217" align="left" valign="top">Format for database URL:</th>
							<th id="wq218" align="left" valign="top">Examples:</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td headers="wq216">AS/400 Toolbox for Java</td>
							<td headers="wq217"><samp class="xph">jdbc:as400://<em>[host]</em></samp></td>
							<td headers="wq218">
								<ul>
									<li><samp class="xph">jdbc:as400://myISeries</samp></li>
									<li><samp class="xph">jdbc:as400://9.88.24.163</samp></li>
								</ul>
							</td>
						</tr>
					</tbody>
				</table>
				<p class="indatacontent">Notice that in the actual database URL (such as <samp class="xph">jdbc:as400://myISeries</samp>) you should <em>not</em> include the square shown in the format.</p>
				<p>The remote server can be located on a host other than the to which the Host On-Demand emulator session is connected. For example, a SQLQuery action can specify an iSeries host, even though the SQLQuery action is part of a macro that is running in a 3270 session connected to a zSeries host.</p>
				<p>If you are using a JDBC driver other than the driver provided Host On-Demand, consult the documentation provided by the driver for the proper format for the database URL.</p>
				<h5 id="ma_sql_driver_identifier">Driver Identifier and Driver Class</h5>
				<p>The JDBC driver that the SLQQuery action uses to access the is a Java client package on the Host On-Demand client that communicates with a server program on a remote host. This program on the remote host provides access to the database.</p>
				<p>The Host On-Demand client already includes a JDBC driver from AS/400 Toolbox for Java. This driver is automatically downloaded part of the emulator client. This driver allows a client to DB2/400 data on a properly configured iSeries or AS/400.</p>
				<p>If you need a different JDBC driver, contact the of the remote database server to obtain the driver. You must some action to deploy the driver to your Host On-Demand client workstations.</p>
				<p>In the Driver Identifier listbox of the SQLQuery action in the Macro Editor, select the driver provided with Host On-Demand, or select <samp class="xph">Other</samp> if you plan to use another driver.</p>
				<p>The Driver Class field contains the fully qualified Java name of the driver. If you select the driver provided with Host On-Demand, then the Macro Editor displays the class name for you in the Class field (<samp class="xph">com.ibm.as400.access.AS400JDBCDRIVER</samp>) does not allow you to modify the class name. In contrast, if you select <samp class="xph">Other</samp> the Driver Identifier listbox, then you must type the fully class name of the driver into the Driver Class field. If you do know the fully qualified class name, contact the provider of the driver.When you type in the name, remember that case is significant (example, <samp class="xph">com</samp> is different from <samp class="xph">COM</samp>).</p>
				<p>If you want to add a driver to the list of available drivers the Driver Identifier listbox (instead of having each time to select <samp class="xph">Other</samp> type in the class name), then you can register the driver with On-Demand (see <button href="https://scc.its.state.nc.us/hod/en/help/db_drvr.html">Registering a JDBC driver</button> the online help).</p>
				<h5 id="ma_sql_uid">User ID and Password</h5>
				<p>If the database connection requires a user id and a password, type the user id into the User ID field and the password into Password field.</p>
				<p>Host On-Demand encrypts the key sequence that you type into Password field. This encryption works exactly like the used when the Password checkbox is selected in an Input action (see <button onclick="scrollHere('ma_input_password')">Password</button>). Remember:</p>
				<ul>
					<li>When you type a password (such as <samp class="xph">mypass</samp>) into Password field, the Macro Editor displays the password using (<samp class="xph">******</samp>).</li>
					<li>When you move the input focus to another input field, the Editor:  				<ol type="1">
							<li>Generates an encrypted version of the password (such as <samp class="xph">q0eqOskTUBQ=</samp>).</li>
							<li>Displays the encrypted version of the password in the field using asterisks (<samp class="xph">************</samp>). (You can see actual characters of the encrypted version of the password in Code Editor.)</li>
						</ol>
					</li>
					<li>The password is a string. Therefore, if you are using the macro format, remember to type the password enclosed in single (for example, <samp class="xph">'mypass'</samp>). The Macro Editor encrypts entire string, including the single quotes.</li>
					<li>If you need to modify the password after the Macro Editor encrypted it, be sure to <em>completely delete the characters in the field</em> before typing in the new password.</li>
				</ul>
				<h5 id="ma_sql_statement">Statement</h5>
				<p>Type or paste an SQL statement into the Statement field. If Statement field already contains an SQL statement, you can edit (even if the SQL statement was imported or was created using the Wizard).</p>
				<p>The Macro Editor does not check the format of the SQL for validity. If the format is invalid, a run-time error occurs the macro runtime processes the SQLQuery action.</p>
				<p>If you are unfamiliar with SQL statements, it is a very good to build the statement and test it in a Database On-Demand session, and then copy and paste the statement into the Statement field. you can be sure that the syntax and content of your SQL are correct.</p>
				<p>You can spread the SQL statement over several lines (as it on the Review tab of a Database On-Demand session) or write it on one line. <button onclick="scrollHere('ma_fig_multiline_fmt')">Figure 38</button> and <button onclick="scrollHere('ma_fig_oneline_fmt')">Figure 39</button> show the same SQL statement written several lines and written as one line. Either way is correct.</p>
				<div class="figrules" id="ma_fig_multiline_fmt"><span class="figcap">Figure 38. SQL statement written on several lines</span>
					<pre class="xmp"><code>   *
				   HODTEST.   (
				      ( HODTESET.EX01.DESCRIPT is not null )    )</code></pre>
				</div>
				<div class="figrules" id="ma_fig_oneline_fmt"><span class="figcap">Figure 39. Same SQL statement written on one line</span>
					<pre class="xmp"><code>SELECT * FROM HODTEST.EX01 WHERE((HODTESET.EX01.DESCRIPT is not null))</code></pre>
				</div>
				<p>Remember that if you are using the advanced macro format you enclose the SQL statement in single quotes and follow the rules special characters (see <button onclick="scrollHere('me_basic_vs_advanced')">The basic macro format versus the advanced macro format</button>). Below, <button onclick="scrollHere('ma_fig_basic_fmt')">Figure 40</button> and <button onclick="scrollHere('ma_fig_adv_fmt')">Figure 41</button> show same SQL statement written for the basic macro format and for advanced macro format:</p>
				<div class="figrules" id="ma_fig_basic_fmt"><span class="figcap">Figure 40. SQL statement written for the basic macro format</span>
					<pre class="xmp"><code>select * from hodtest.ex01       ((hodtest.ex01.descript='Edit Products'))</code></pre>
				</div>
				<div class="figrules" id="ma_fig_adv_fmt"><span class="figcap">Figure 41. Same SQL statement written for the advanced macro format</span>
					<pre class="xmp"><code>'select * from hodtest.ex01       ((hodtest.ex01.descript=\'Edit Products\'))'</code></pre>
				</div>
				<p>You can use either upper case or lower case for reserved (such as <samp class="xph">select</samp>) and database names and fields (such as <samp class="xph">hodtest.ex01.descript</samp>), but you must use exact case for matching strings (such as <samp class="xph">'Products'</samp>). Thus the two SQL statements in <button onclick="scrollHere('ma_fig_upper_lower_case')">Figure 42</button> are equivalent:</p>
				<div class="figrules" id="ma_fig_upper_lower_case"><span class="figcap">Figure 42. Example of equivalent upper case and lower case</span>
					<pre class="xmp"><code>select * from hodtest.ex01       ((hodtest.ex01.descript='Edit Products')) SELECT * FROM HODTEST.EX01       ((HODTEST.EX01.DESCRIPT='Edit Products'))</code></pre>
				</div>
				<h4 id="ma_sql_composing_query">Using the result section</h4>
				<p>The fields in the result section control how the SQLQuery uses the data resulting from the SQL statement. You can write data into a global variable, write the data into a file, or it.</p>
				<button id="ma_sql_dest_globalvar"></button>
				<h5 id="wq220">Storing the data into a global ($HMLSQLUtil$)</h5>
				<p>The default destination for the data resulting from an action is the global variable $HMLSQLUtil$. The Host On-Demand always updates this variable with the results of a successful action, even when you specify a destination of File or Display the Output Result To listbox. For example, when you specify a of File, then Host On-Demand:</p>
				<ul>
					<li>Writes the data resulting from the SQLQuery action into the you specify; and also,</li>
					<li>Writes the data into $HMLSQLUtil$.</li>
				</ul>
				<p class="indatacontent">Consequently, you can both write the data to a file (or it) and also use the data in the macro, without having to make same database query twice.</p>
				<p>To store data <em>only</em> into $HMLSQLUtil$, the Output Result To listbox and click $HMLSQLUtil$.</p>
				<p>To use the data stored in $HMLSQLUtil$ in a subsequent macro action, you must invoke methods from the Host On-Demand Macro Utility (HML library) associated with $HMLSQLUtil$. See <button onclick="scrollHere('mv1_hmlsqlutil')">$HMLSQLUtil$</button>.</p>
				<h5 id="ma_sql_dest_file">Writing the data into a file</h5>
				<p>To write the data to a file, expand the Output Result To and click File.</p>
				<p>Type the file path into the File Name listbox. (The file path a string, so type the string using the format appropriate for macro format, either basic or advanced). Or, click Browse to for the file. NOTE: You must specify a complete file path and name in this field, including the drive letter if any (for example, <samp class="xph">c:\and Settings\User1\output.txt</samp>).</p>
				<p>In the File Type listbox, click the type of file in which you to store the data. This listbox lists the same database file that are available in the Database On-Demand client.</p>
				<ul>
					<li>When the file type is HTML, Host On-Demand has additional options (such as table border, cell spacing, column headings, so on) that you cannot directly access in the Macro Editor. However, you can include these options in your macro by launching the SQL Wizard, changing the HTML options (by clicking Settings on the Output of the SQL Wizard), and saving the SQL statement to the macro (see <button onclick="scrollHere('ma_sqlquery_using_sql_wizard')">Using the SQL Wizard</button>).</li>
					<li>When the file type is XML, Host On-Demand has an additional (character encoding) that you cannot directly access in the Editor. However, you can include this option in your macro by the SQL Wizard, changing the XML options (by clicking Settings the Output tab of the SQL Wizard), and saving the SQL statement the macro (see <button onclick="scrollHere('ma_sqlquery_using_sql_wizard')">Using the SQL Wizard</button>).</li>
				</ul>
				<p>Click Overwrite to overwrite the contents of an existing file, or click Append to append the data to an existing file. If the does not exist, then either Overwrite or Append creates the new file.</p>
				<p>If you select the <samp class="xph">Show in Web browser</samp> checkbox, On-Demand first writes the data into the file and closes the file, and then displays the file in the default browser. The browser have the plug-in (for example, an Excel plug-in) for the file (such as Microsoft Excel BIFF3 or BIFF4). For some browsers, you configure the security settings of the browser to allow a Java or application to launch an instance of the browser to display a file (see <button href="https://scc.its.state.nc.us/hod/en/help/ptr_browser.html">Configuring a browser to display a file</button> in the online help).</p>
				<h5 id="ma_sql_dest_display">Displaying the data</h5>
				<p>To display the data, expand the Output Result To listbox and Display. This option causes the macro runtime to display the inside a Query Results dialog.</p>
				<p>The <samp class="xph">Hold on output dialog</samp> checkbox controls the macro runtime immediately goes on to process the next macro after displaying the Query Results dialog:</p>
				<ul>
					<li>If the checkbox is selected, then the macro runtime:  				<ol type="1">
							<li>Displays the Query Results dialog with three buttons:  						<ul>
									<li>Save Results</li>
									<li>Continue</li>
									<li>Close and Continue</li>
								</ul>
							</li>
							<li>Does not go on to process the next macro action until the user clicks the second button (Continue) or the third button (and Continue).</li>
						</ol>
					</li>
					<li>If the checkbox is cleared, then the macro runtime:  				<ol type="1">
							<li>Displays the Query Results dialog with two buttons:  						<ul>
									<li>Save Results</li>
									<li>Close</li>
								</ul>
							</li>
							<li>Immediately goes on to process the next macro action.</li>
						</ol>
					</li>
				</ul>
				<p class="indatacontent">In either case, the Query Results dialog remains open until end user closes it (by clicking either Close or else Close and Continue).</p>
				<p><button onclick="scrollHere('ma_sql_table_displaydata')">Table 19</button> shows for each of the its name, its function, and the setting of the <samp class="xph">Hold on dialog</samp> checkbox that causes it to appear:</p>
				<table id="ma_sql_table_displaydata" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 19. Buttons on the Query Results dialog</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq223" align="left" valign="top">Button name:</th>
							<th id="wq224" align="left" valign="top">Function:</th>
							<th id="wq225" align="left" valign="top">Setting of the <samp class="xph">Hold on dialog</samp> checkbox:</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td headers="wq223">Save Results</td>
							<td headers="wq224">
								<ul>
									<li>Saves the data into a file in ASCII format</li>
								</ul>
							</td>
							<td headers="wq225">Selected or cleared</td>
						</tr>
						<tr>
							<td headers="wq223">Close</td>
							<td headers="wq224">
								<ul>
									<li>Closes the dialog.</li>
								</ul>
							</td>
							<td headers="wq225">Cleared</td>
						</tr>
						<tr>
							<td headers="wq223">Continue</td>
							<td headers="wq224">
								<ul>
									<li>Causes the macro runtime to start processing the next macro action.</li>
								</ul>
							</td>
							<td headers="wq225">Selected</td>
						</tr>
						<tr>
							<td headers="wq223">Close &amp; Continue</td>
							<td headers="wq224">
								<ul>
									<li>Closes the dialog.</li>
									<li>Causes the macro runtime to start processing the next macro action.</li>
								</ul>
							</td>
							<td headers="wq225">Selected</td>
						</tr>
					</tbody>
				</table>
				<h4 id="wq226">Preloading the database components for the Host On-Demand client</h4>
				<p>In the Deployment Wizard, you can specify which macro for database access are preloaded by the Host On-Demand client. See <button href="https://scc.its.state.nc.us/hod/en/help/dpwpreloadopts.html">Preload Options (Features1)</button> in the online help.</p>
				<h3 id="ma_trace">Trace action (&lt;trace&gt; element)</h3>
				<p>The Trace action sends a trace message to a trace destination you specify, such as the Java console.</p>
				<p>Use the Trace Handler listbox to specify the trace to which you want the trace message sent:</p>
				<ul>
					<li>Select Host On-Demand trace facility to send the trace to the Host On-Demand Trace Facility.</li>
					<li>Select User trace event to send the trace message to a user handler.</li>
					<li>Select Command line to send the trace message to the Java console.</li>
				</ul>
				<p>Use the Trace Text input field to specify the string that you to send to the trace destination.</p>
				<h4 id="wq227">Example</h4>
				<p>The following example shows how to send trace messages to the console. This example uses the following action elements: Trace Variable update.</p>
				<p>You can copy the text of this macro script from this document the system clipboard, and then from the system clipboard into Code Editor (see <button onclick="scrollHere('mg_ce_copypaste')">Copy and paste a script from this guide into the Code Editor</button>). After you save script in the Macro Editor, you can edit it either with the Editor or with the Code Editor.</p>
				<p> You should notice the following facts about this example:</p>
				<ul>
					<li>The example consists of one entire macro script named TRACE.</li>
					<li>The &lt;create&gt; element creates a string variable named <samp class="xph">$strData$</samp> initializes it to an original value of <samp class="xph">'Original value'</samp>.</li>
					<li>The first action is a Trace action with the Trace Text set to <samp class="xph">'value is' + $strData$</samp>.</li>
					<li>The second action is a Variable update action that sets the $strData$ to a new value of <samp class="xph">'Updated value</samp>'.</li>
					<li>The third action is another Trace action identical with the Trace action.</li>
				</ul>
				<div class="figrules" id="ma_fig_trace"><span class="figcap">Figure 43. Sample code TRACE</span>
					<pre class="xmp"><code>&lt;HAScript name="TRACE" description=" " timeout="60000" pausetime="300"             promptall="true" author="" creationdate="" supressclearevents="false"              usevars="true" ignorepauseforenhancedtn="false"              delayifnotenhancedtn="0"&gt;    &lt;vars&gt;       &lt;create name="$strData$" type="string" value="’Original value’" /&gt;    &lt;/vars&gt;    &lt;screen name="Screen1" entryscreen="true" exitscreen="false" transient="false"&gt;       &lt;description&gt;           &lt;oia status="NOTINHIBITED" optional="false" invertmatch="false" /&gt;       &lt;/description&gt;       &lt;actions&gt;          &lt;trace type="SYSOUT" value="’The value is ’+$strData$"  /&gt;          &lt;varupdate name="$strData$" value="’Updated value’" /&gt;          &lt;trace type="SYSOUT" value="’The value is ’+$strData$"  /&gt;       &lt;/actions&gt;       &lt;nextscreens timeout="0" &gt;       &lt;/nextscreens&gt;   &lt;/screen&gt;</code></pre>
				</div>
				<p class="indatacontent">This script causes the macro runtime to send the following to the Java console:</p>
				<pre class="xmp"><code>The value is +{$strData$ = Original value}
				The value is +{$strData$ = Updated value}</code></pre>
				<p class="indatacontent">In the trace above you should notice that instead of just displaying the of $strData$, the Debug action displays both the variable's name its value inside curly braces {}.</p>
				<h4 id="wq228">User trace event</h4>
				<p>To take advantage of the User trace event setting, you need separate Host Access Toolkit product. You should implement the interface. The macro runtime sends an event to for the following types of occurrences:</p>
				<ul>
					<li>Macro error</li>
					<li>Macro state change</li>
					<li>Trace action. The event is a MacroTraceEvent.</li>
					<li>Prompt action.</li>
					<li>Message action.</li>
					<li>Extract action.</li>
				</ul>
				<h3 id="ma_varupdate">Variable update action (&lt;varupdate&gt; element)</h3>
				<p>The &lt;varupdate&gt; element stores a value into a variable. must specify:</p>
				<ul>
					<li>The name of a variable</li>
					<li>The value that you want to store into the variable.</li>
				</ul>
				<p class="indatacontent">During macro playback the macro runtime performs the update action by storing the specified value into the specified variable.</p>
				<p>You can also use the Variable update action in a &lt;description&gt; element (see <button onclick="scrollHere('md1_vu_process')">Processing a Variable update action in a description</button>).</p>
				<p>The value can be an arithmetic expression and can contain and calls to imported methods. If the value is an expression, during macro playback the macro runtime evaluates the expression stores the resulting value into the specified variable.</p>
				<p>The Variable update action works like an assignment statement a programming language. In a Java program you could write statements such as:</p>
				<pre class="xmp"><code>boolVisitedThisScreen = true; intVisitCount = intVisitCount + 1; dblLength = 32.4; strAddress ="123 Hampton Court";</code></pre>
				<p class="indatacontent">With the Variable update you type the left side of the equation (the variable) into the field on the Variable Update window and type the right side of equation (the value) into the Value field on the same window. To the equivalents of the Java assignment statements above, you write:</p>
				<table id="wq229" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 20. Examples of variable names and values</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq230" align="left" valign="top">In the Name input field:</th>
							<th id="wq231" align="left" valign="top">In the Value input field:</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td headers="wq230">$boolVisitedThisScreen$</td>
							<td headers="wq231">true</td>
						</tr>
						<tr>
							<td headers="wq230">$intVisitCount$</td>
							<td headers="wq231">$intVisitCount$+1</td>
						</tr>
						<tr>
							<td headers="wq230">$dblLength$</td>
							<td headers="wq231">32.4</td>
						</tr>
						<tr>
							<td headers="wq230">$strAddress$</td>
							<td headers="wq231">'123 Hampton Court'</td>
						</tr>
					</tbody>
				</table>
				<p>The value that you provide must belong to the correct data for the context or be convertible to that type (see <button onclick="scrollHere('me_data_type_conversion')">Automatic data type conversion</button>).</p>
				<p>The great usefulness of the Variable update action is due to facts that:</p>
				<ul>
					<li>The entity in the Value field can be an expression, and</li>
					<li>Expressions are not evaluated until the action is performed.</li>
				</ul>
				<p class="indatacontent">For more information on expressions see <button onclick="scrollHere('me_expressions')">Data types, operators, and expressions</button>.</p>
				<h4 id="ma_variable_update_field">Variable update action with a field variable</h4>
				<p>Using a Variable update action to update a field variable is convenient way of reading the contents of a 3270 or 5250 field the session window and storing the field's contents as a string a variable.</p>
				<p>A field variable is a type of string variable. A field contains a string, just as a string variable does, and you can a field variable in any context in which a string variable is valid.However, a field variable differs from a string variable in the in which a string is stored into the field variable. The string a field variable contains is always a string that the macro has read from a 3270 or 5250 field in the current session window.</p>
				<p>When you use the Variable update action to update a string variable, you specify the following information in the Variable update window:</p>
				<ul>
					<li>The name of the field variable, such as $fldTmp$.</li>
					<li>A location string, such as '5,11'. (A location string is a containing two integers separated by a comma that represent a and column location on the session window.)</li>
				</ul>
				<p>When the macro runtime performs the Variable update action, macro runtime:</p>
				<ol type="1">
					<li>Recognizes that the variable is a field variable.</li>
					<li>Looks at the location string that is to be used to update field variable.</li>
					<li>Finds in the current session window the row and column specified by the location string.</li>
					<li>Finds in the current session window the 3270 or 5250 field which the row and column location occurs.</li>
					<li>Reads the entire contents of the 3270 or 5250 field, any leading and trailing blanks.</li>
					<li>Stores the entire contents of the field as a string into the variable.</li>
				</ol>
				<p>You can then use the field variable in any context in which a is valid. For example, you can concatenate the field variable another string, as in the following:</p>
				<pre class="xmp"><code>'The field\'s contents are'+ $fldPrintOption$</code></pre>
				<p>As an example, suppose that the session window contains a or 5250 field with the following characteristics:</p>
				<ul>
					<li>It begins at row 5, column 8.</li>
					<li>It ends at row 5, column 32.</li>
					<li>It contains the string  <samp class="xph">'Print VTOC information'</samp>.</li>
				</ul>
				<p class="indatacontent"> You set up a Variable update action with the following values:</p>
				<ul>
					<li>In the Name field of the Variable update window you type the of a field variable that you have just created,<samp class="xph"> $fldData$</samp>.</li>
					<li>In the Value field you type a location string, <samp class="xph">'5,11'</samp>.Notice that you have to specify only one row and column location, and that it can be any row and column location that lies within field.</li>
				</ul>
				<p class="indatacontent">When the macro runtime performs this Variable update action, the macro runtime reads the entire contents of the field and the contents as a string into $fldData$. The field variable $fldData$ now contains the string <samp class="xph">'Print VTOC information'</samp>.</p>
				<h5 id="wq233">Reading part of a field</h5>
				<p>When you are using a field variable in a Variable update action, you can specify a location string that contains two locations. this feature if you want to read only part of the contents of a field.</p>
				<p>Type the first and second locations into the Value field with colon (:) between them. For example, if the first location is 5,and the second location is 5,17, then you would type <samp class="xph">'5,14:5,17'</samp>.</p>
				<p>When you specify two locations:</p>
				<ul>
					<li>The first location specifies the first position in the field read from.</li>
					<li>The second location specifies the last position in the field read from.</li>
				</ul>
				<p>As an example, suppose that the session window contains a or 5250 field with the following characteristics:</p>
				<ul>
					<li>It begins at row 5, column 8.</li>
					<li>It ends at row 5, column 32.</li>
					<li>It contains the string  <samp class="xph">'Print VTOC information'</samp>.</li>
				</ul>
				<p class="indatacontent">and suppose that you set up a Variable update action with following values:</p>
				<ul>
					<li>In the Name field of the Variable update window you type the of a field variable that you have just created,<samp class="xph"> $fldData$</samp>.</li>
					<li>In the Value field you type a location string, <samp class="xph">'5,14:5,17'</samp>.Here you are specifying both a beginning location and an ending within the field.</li>
				</ul>
				<p class="indatacontent">When the macro runtime performs this Variable update action, the macro runtime reads the string <samp class="xph">'VTOC'</samp> from the (beginning at the position specified by the first location and continuing until the position specified by the second string) and stores the string <samp class="xph">'VTOC'</samp> into $fldData$.</p>
				<p>If the second location lies beyond the end of the field, the runtime reads the string beginning at the first location and until the end of the field. The macro runtime then stores this into the field variable.</p>
				<h3 id="ma_xfer">Xfer action (&lt;filexfer&gt; element)</h3>
				<p>The Xfer action (pronounced "transfer action" or "file action") transfers a file from the workstation to the host or the host to the workstation.</p>
				<h4 id="ma_xf_basic_parameters">Basic parameters</h4>
				<p>In the Tranfer Direction listbox you must specify whether you the file to go from the workstation to the host (Send) or from host to the workstation (Receive). If you select Expression, you must specify an expression (for example, a variable named <samp class="xph">$strDirection$)</samp> at runtime resolves to either <samp class="xph">Send</samp> or <samp class="xph">Receive</samp>.</p>
				<p><button onclick="scrollHere('ma_table_file_names')">Table 21</button> shows the values that you use in the Host-File Name field and the Local-File Name field:</p>
				<table id="ma_table_file_names" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 21. Host-File Name field and Local-File Name field</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq234" align="left" valign="top">Transfer Direction:</th>
							<th id="wq235" align="left" valign="top">Host-File Name field:</th>
							<th id="wq236" align="left" valign="top">Local-File Name field:</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td headers="wq234">Send</td>
							<td headers="wq235">The name that you want assigned to the when it reaches the host. For example, in a 3270 Display session,<samp class="xph"> 'txt a'</samp></td>
							<td headers="wq236">The name of the file that you want to send the host. For example, <samp class="xph">'e:\\tm\\trace1.txt'</samp>.</td>
						</tr>
						<tr>
							<td headers="wq234">Receive</td>
							<td headers="wq235">The name of the file that you want to at the workstation. For example, <samp class="xph">'january archive a'</samp></td>
							<td headers="wq236">The name that you want assigned to the after it reaches the client. For example, <samp class="xph">'d:\\MyData\\january.arc'</samp></td>
						</tr>
					</tbody>
				</table>
				<p class="indatacontent">Remember that if you are using the advanced macro format backslash \ is a special character that must be written <samp class="xph">'\\'</samp>(see <button onclick="scrollHere('me_advanced_format_rules')">In the advanced macro format, rules for representation of strings, etc.</button>).</p>
				<h4 id="ma_xf_advanced_parameters">Advanced parameters</h4>
				<p>In the Clear Before Transfer field, in most cases you should use <samp class="xph">true</samp> 3270 Display sessions and <samp class="xph">false</samp> for 5250 Display sessions.</p>
				<p>You should set the Timeout field to the number of that you want the macro runtime to wait before terminating the transfer.The default is 10000 milliseconds (10 seconds). This Timeout saves the user from the situation in which the macro hangs it is trying to transfer a file over a session that has suddenly disconnected. You might need to use a greater value for very files or if your connection is slow.</p>
				<p>You should use the Options field for any additional that your host requires. These parameters are different for each of host system. If the host is an iSeries, you should add the parameters to the Options field:</p>
				<pre class="xmp"><code>USERID(myuserid) PASSWORD(mypassword)</code></pre>
				<p>You should use the Local Code-page field to select the code (mapping table) that you want the macro runtime to use in characters from the workstation's character set to the host's set and vice versa. You should select the same code-page number (as 437) that is specified in the session configuration.</p>
				<h4 id="wq237">Parameters for BIDI sessions (Arabic or Hebrew)</h4>
				<p>There are additional parameters for BIDI sessions (Arabic or Hebrew) that you can set with the Code Editor (<button onclick="scrollHere('mr_filexfer_attributes')">Attributes</button> ).</p>
				<h4 id="ma_xfer_hostid">Specifying a session</h4>
				<p>Use the Host ID field to specify the session in which you this action to be performed:</p>
				<ul>
					<li>If you want this action to be performed in the session that the macro, then leave the Host ID field blank.</li>
					<li>If you want this action to be performed in some other session, type a session reference into the Host ID field (see <button onclick="scrollHere('ms_hostid')">Specifying a Host ID</button>).</li>
				</ul>
				<p>If the referenced session is active, then you can use any editing feature with the referenced session (see <button onclick="scrollHere('ms_auto_edit')">Using automatic editing features with other sessions</button>).</p>
				<h4 id="wq238">Examples</h4>
				<p>The following example shows an Xfer action:</p>
				<div class="figrules" id="wq239"><span class="figcap">Figure 44. Example of the Xfer action</span>
					<pre class="xmp"><code>&lt;actions&gt;    &lt;filexfer direction="send" pcfile="'c:\\myfile.txt'" hostfile="'myfile text A0'"             clear="true" timeout="10000" pccodepage="437"  /&gt; &lt;/actions&gt;  </code></pre>
				</div>
			</div>
		</div>

		<button id="mn_links" class="accordian">Screen Recognition, Part 2</button>
		<div class="panel" style="display:none">


			<button id="ms1_valid_next_screens" class="accordian">Valid next screens</button>
			<div class="panel" style="display:none">
				<p>As you may remember from <button onclick="scrollHere('mc3_processing_macro_screen')">How the macro runtime processes a macro screen</button>, the macro runtime typically finds the names of macro screens are candidates for becoming the next macro screen to be by looking in the &lt;nextscreens&gt; element of the current macro screen.That is, the macro screen contains within itself a list of the screens that can validly be processed next. (Entry screens and screens are exceptions, see <button onclick="scrollHere('mn_entry_exit_transient')">Entry screens, exit screens, and transient screens</button>.)</p>
				<p>In the Macro Editor, the Links tab provides the user for storing the names of candidate macro screens into the &lt;nextscreens&gt; element of a macro screen. <button onclick="scrollHere('mn_fig_links_tab')">Figure 45</button> show sample Links tab:</p>
				<div class="fignone" id="mn_fig_links_tab"><span class="figcap">Figure 45. Sample Links tab</span>
					<div class="mmobj">
						<img src="./mb_hame_links_tab.gif" alt="">
					</div>
				</div>
				<p class="indatacontent">In the figure above, the Screen Name listbox at the top of tab contains a list of all the macro screens in the entire macro.The currently selected macro screen is Screen1. On the right, Valid Next Screens listbox contains a list of candidate macro for Screen1 (Do not confuse this listbox, which contains the in the &lt;nextscreens&gt; element of Screen1, with the list of next screens that the macro runtime uses when a macro is played back).On the left, the Available Screens listbox contains a list of names of all other macro screens .</p>
				<p>Although the figure above shows only one screen in the Screens list, that is because this figure is from a macro with two macro screens in it, Screen1 and Screen2. Instead, imagine a of twenty screens, and suppose that you want to add macro to the &lt;nextscreens&gt; list of a new macro screen, ScreenR. You follow these steps:</p>
				<ol type="1">
					<li>On the Links tab, expand the Screen Name listbox and scroll until you find ScreenR.</li>
					<li>Select ScreenR.</li>
					<li>Because ScreenR is a new screen, there are no macro screen listed in the Valid Next Screens list on the right.</li>
					<li>On the left, the Available Next Screens listbox contains the of all the macro screens in the macro.</li>
					<li>Select a screen that you want to add to the list for ScreenR.Suppose that you select ScreenS.</li>
					<li>After selecting ScreenS, click the right arrowhead button the two listboxes. ScreenS is added to the listbox on the right, removed from the listbox on the left.</li>
					<li>In the same way, move the names of any other macro screens you want to the Valid Next Screens listbox for ScreenR.</li>
					<li>Suppose that you move a total of three screen names: ScreenS, ScreenG, and ScreenY.</li>
				</ol>
				<p class="indatacontent">When you are done, ScreenR, the currently selected macro screen, has the names of three macro screens in its list of valid next screens.</p>
				<p>In the Code Editor, you would see the names of the valid next screens, ScreenS, ScreenG, ScreenY, stored inside ScreenR as in <button onclick="scrollHere('mn_fig_nextscreens')">Figure 46</button>:</p>
				<div class="figrules" id="mn_fig_nextscreens"><span class="figcap">Figure 46. Macro screen ScreenR with &lt;nextscreens&gt; element</span>
					<pre class="xmp"><code>&lt;screen name="ScreenR" entryscreen="true" exitscreen="false" transient="false"&gt;    &lt;description&gt;       ...   &lt;/description&gt;    &lt;actions&gt;       ...   &lt;/actions&gt;    &lt;nextscreens&gt;       &lt;nextscreen name="ScreenS"/&gt;       &lt;nextscreen name="ScreenG"/&gt;       &lt;nextscreen name="ScreenY"/&gt;    &lt;/nextscreens&gt; &lt;/screen&gt;</code></pre>
				</div>
				<p class="indatacontent">The figure above shows the &lt;screen&gt; element for ScreenR, with the <strong>name</strong> attribute set to <samp class="xph">"ScreenR"</samp>.Inside are the three primary structural elements of a &lt;screen&gt; element: the &lt;description&gt; element, the &lt;actions&gt; element, the &lt;nextscreens&gt; element. The contents of the &lt;description&gt; element and the &lt;actions&gt; element are not shown but are with an ellipsis (...). The &lt;nextscreens&gt; element contains three &lt;nextscreen&gt; elements, and each &lt;nextscreen&gt; element contains the name of of the valid next screens: <samp class="xph">ScreenS</samp>, <samp class="xph">ScreenG</samp>, and <samp class="xph">ScreenY</samp>.</p>
				<p>For more information about runtime processing see <button onclick="scrollHere('mc3_processing_macro_screen')">How the macro runtime processes a macro screen</button>.</p>
			</div>

			<button id="mn_entry_exit_transient" class="accordian">Entry screens, exit screens, and transient screens</button>
			<div class="panel" style="display:none">
				<p>You can use the entry screen, exit screen, and transient settings to mark macro screens that you want the macro runtime treat in a special way. In the Macro Editor, you make these on the General tab of the Screens tab. At the top of the tab, the Screen Name field, are listboxes for Entry Screen, Exit Screen, and Transient Screen. For each of these listboxes, you must a boolean value (the default is false) or an expression that to a boolean value.</p>
				<p>In the Code Editor, these settings appear as attributes of the &lt;screen&gt; element. In <button onclick="scrollHere('mn_fig_nextscreens')">Figure 46</button>, above, you can these three attributes in the &lt;screen&gt; element for ScreenR: <strong>entryscreen</strong>, <strong>exitscreen</strong>, and <strong>transient</strong>.</p>
				<h3 id="mn_entry_screen">Entry screens</h3>
				<p>Set Entry Screen to true if you want the macro screen to be as one of the first macro screens to be processed when the macro played back. You might have only one macro screen that you mark a entry screen, or you might have several.</p>
				<p>When the macro playback begins, the macro runtime searches the macro script and finds all the macro screens that are as entry screens. Then the macro runtime adds the names of these macro screens to the runtime list of valid next screens. Finally macro runtime tries in the usual way to match one of the screens the list to the current session window.</p>
				<p>When the macro runtime has matched one of the entry macro to the session window, that macro screen becomes the first macro to be processed. Before performing the actions in the first screen, the macro runtime removes the names of the entry macro from the runtime list of valid next screens.</p>
				<h4 id="mn_several_entry_screens">Macro with several entry screens</h4>
				<p>One of the situations in which you might have several entry in the same macro is when a host application begins with a of application screens one after another, such as application A, followed by application screen B, followed by application C. For instance, screen A might be a logon screen, screen B a that starts several supporting processes, and screen C the first screen of the application.</p>
				<p>In this situation, you might want the user to be able to run macro whether the user was at application screen A, B, or C.</p>
				<h4 id="mn_entry_screen_can_be_normal">Entry screen can also be a normal screen</h4>
				<p>If you mark a screen as an entry screen, it can still in the macro as a normal screen and be listed in the &lt;nextscreens&gt; lists of other macro screens.</p>
				<p>For example, you might have a host application that has a application screen with a set of menu selections, so that each you make a menu selection the application goes through several screens of processing and then returns to the original central screen.</p>
				<p>In this situation, suppose that macro ScreenA is the macro corresponding to the central application screen. Therefore:</p>
				<ul>
					<li>ScreenA could be an entry screen, because the macro could at the central application screen.</li>
					<li>ScreenA could also appear in the &lt;nextscreens&gt; element of macro screens, because after each task the application returns the central application screen.</li>
				</ul>
				<h3 id="mn_exit_screen">Exit screens</h3>
				<p>Setting Exit Screen to true for a macro screen causes the runtime to terminate the macro after it has performed the for that macro screen. That is, after the macro runtime performs actions, and before going on to screen recognition, the macro looks to see if the current macro screen has the exit screen set to true. If so, then the macro runtime terminates the macro. (macro runtime ignores the &lt;nextscreens&gt; element of an exit screen.)</p>
				<p>Therefore you would set Exit Screen to true for a macro if you wanted the macro screen to be a termination point for the macro.</p>
				<p>You can have any number of exit screens for a macro. Here are examples of situations in which there could be several exit screens.</p>
				<ul>
					<li>A macro might have one normal termination point and several termination points, which could be reached if an error occurred.</li>
					<li>A macro might allow you to stop at a certain point in the processing, or to keep going, so that there would be several normal points.</li>
				</ul>
				<h3 id="mn_transient_screen">Transient screens</h3>
				<p>A transient macro screen is used to process an application that has the following characteristics:</p>
				<ul>
					<li>The application screen occurs unpredictably during the flow the application. It might occur at several points or it might occur at all.</li>
					<li>The only action that needs to occur for the application is that it needs to be cleared.</li>
				</ul>
				<p class="indatacontent">An example of such an application screen is an error screen the application displays when the user enters invalid data. This screen appears at unpredictable times (whenever the user enters data) and as a macro developer the only action that you want to for this error screen is to clear it and to get the macro back track.</p>
				<p>When the macro runtime prepares to play back a macro, at the where the macro runtime adds the names of entry screens to the list of valid next screens, the macro runtime also adds the of all macro screens marked as transient screens (if any) to the of the list.</p>
				<p>The names of these transient screens remain on the runtime of valid next screens throughout the entire macro playback. the macro runtime adds the names of new candidate macro screens (the &lt;nextscreens&gt; element of the current macro screen) to the list, the macro runtime adds these new candidate names ahead of the of the transient screens, so that the names of the transient are always at the end of the list.</p>
				<p>Whenever the macro runtime performs screen recognition, it the macro screens of all the names on the list in the usual way. the macro runtime does not find a match to the application among the candidate macro screens whose names are on the list, the macro runtime goes on down the list trying to match one of transient macro screens named on the list to the application screen.</p>
				<p>If the macro runtime matches one of the transient macro to the current application screen, then the macro runtime does remove any names from the list. Instead, the macro runtime the actions in the transient macro screen (which should clear unexpected application screen) and then goes back to the screen process that it was pursuing when the unexpected application occurred.</p>
				<h4 id="wq241">Example of handling of transient screen</h4>
				<p>Suppose that the macro runtime is doing screen recognition that it has the names of three macro screens on the list of next screens: ScreenB and ScreenD, which are the names of screens, and ScreenR, which is the name of a transient screen. macro runtime performs the following steps:</p>
				<ol type="1">
					<li>When the session window's presentation space is updated, the runtime evaluates the names on the list of valid next screens in usual way.</li>
					<li>Suppose that an unexpected application screen has occurred, that neither ScreenB nor ScreenD matches the current application screen, but that ScreenR does match the current application screen.</li>
					<li>Because a transient screen has been recognized, the macro does not remove any names from the list of valid next screens.</li>
					<li>The macro runtime makes ScreenR the current macro screen to processed.</li>
					<li>The macro runtime performs the actions in ScreenR. These clear the unexpected application screen.</li>
					<li>The macro runtime ignores the &lt;nextscreens&gt; element, if any, in ScreenR.</li>
					<li>The macro runtime returns to the previous task of screen in step 1 above. The list of valid next screens has not changed. time, suppose that an expected application screen is displayed that the macro runtime finds that ScreenD matches it. Therefore:  				<ol type="a">
							<li>The macro runtime makes ScreenD the next macro screen to be processed.</li>
							<li>The macro runtime removes the names ScreenB and ScreenD from list of valid next screens. The name ScreenR remains on the list.</li>
							<li>The macro runtime begins processing the actions in ScreenD.</li>
						</ol>
					</li>
				</ol>
			</div>

			<button id="mt_screen_recog_timeout" class="accordian">Timeout settings for screen recognition</button>
			<div class="panel" style="display:none">
				<p>This section discusses the scenario in which the macro cannot advance because it cannot match a screen on the list of next screens to the current application screen. There are two that let you set a timeout value that terminates the macro if recognition does not succeed before the timeout expires:</p>
				<ul>
					<li>Timeout Between Screens field on the Macro tab.</li>
					<li>Timeout field on the Links tab.</li>
				</ul>
				<h3 id="wq244">Screen recognition</h3>
				<p>As you know, after the macro runtime has performed all the in the &lt;actions&gt; element of a macro screen, then the macro attempts to match one of the screens on the list of valid next to the new application screen (see <button onclick="scrollHere('mc3_processing_macro_screen')">How the macro runtime processes a macro screen</button>).</p>
				<p>Sometimes, unforeseen circumstances make it impossible for macro runtime to match any of the macro screens on the list of next screens to the application screen. For example, a user type an input sequence that takes him to an application screen by the macro developer. Or, a systems programmer might have the application screen so that it no longer matches the in the &lt;description&gt; element of the corresponding macro screen.</p>
				<p>When such a scenario occurs, the result is that the macro to hang while the macro runtime continually and unsuccessfully to find a match.</p>
				<h3 id="mt_timeout_between_screens">Timeout Between Screens (Macro tab)</h3>
				<p>The Timeout Between Screens checkbox and input field are on the Macro tab and specify a timeout value for screen recognition.By default, if the checkbox is enabled, this value applies to and every macro screen in the macro. However, you can change the for a particular macro screen by using the Timeout field on the tab (see the next section).</p>
				<p>Whenever the macro runtime starts to perform screen recognition, it checks to determine whether the Timeout Between Screens value set for the entire macro and whether a Timeout value is set for macro screen. If a timeout value is set, then the macro runtime a timer to the number of milliseconds specified by the timeout value.If the timer expires before the macro runtime has completed recognition, then the macro runtime terminates the macro and a message such as the following:</p>
				<div class="figrules" id="mt_fig_screen_reco_timeout"><span class="figcap">Figure 47.  Error message for screen recognition timeout</span>
					<pre class="xmp"><code>Macro timed out: (Macro=ispf_ex2, Screen=screen_address_type)</code></pre>
				</div>
				<p class="indatacontent">Please notice that this message displays the name of the and the name of the screen that was being processed when the occurred. For example, if the screen specified in this message ScreenA, then the macro runtime had already performed all the in ScreenA and was trying to match a macro screen in the Valid Screens list for ScreenA to the application screen.</p>
				<p>To use the Timeout Between Screens field, select the checkbox type a value for the number of milliseconds to wait before the macro. By default the checkbox is checked and the timeout is set to 60000 milliseconds (60 seconds).</p>
				<h3 id="wq245">Timeout (Links tab)</h3>
				<p>The Timeout input field on the Links tab specifies a timeout for screen recognition for a particular macro screen. If this is non-0, then the macro runtime uses this value as a timeout (in milliseconds) for screen recognition for this macro screen, of using the value set in the Timeout Between Screens field on Macro tab.</p>
				<p>If the timer expires before the macro runtime has completed recognition, then the macro runtime displays the message in <button onclick="scrollHere('mt_fig_screen_reco_timeout')">Figure 47</button>.</p>
			</div>

			<button id="mn_recolimit" class="accordian">Recognition limit (General tab of the Screens tab)</button>
			<div class="panel" style="display:none">
				<p>The recognition limit is not an attribute in the begin tag of the &lt;screen&gt; element but rather a separate element (the &lt;recolimit&gt; element) that optionally can occur inside a &lt;screen&gt; element, on the level as the &lt;description&gt;, &lt;actions&gt;, and &lt;nextscreens&gt; elements.</p>
				<p>The Set Recognition Limit checkbox and the Screens Before input field are located on the General tab of the Screens tab (see <button onclick="scrollHere('mc2_hame_screens_tab')">Figure 15</button>). By default the Set Recognition checkbox is cleared and the input field is disabled. If you the checkbox, then the Macro Editor sets the default value of Screens Before Error input field to 100. You can set the value a larger or smaller quantity.</p>
				<p>The recognition limit allows you to take some sort of action the macro runtime processes a particular macro screen too many times.If the macro runtime does process the same macro screen a large of times (such as 100), then the reason is probably that an has occurred in the macro and that the macro is stuck in an loop.</p>
				<p>When the recognition limit is reached, the macro runtime terminates the macro with an error message (this is the default action) or starts processing another macro screen that you specify.</p>
				<p>You should notice that the recognition limit applies to one screen and that by default it is absent. You can specify a limit for any macro screen, and you can specify the same or a recognition limit value for each macro screen in which you it.</p>
				<h3 id="wq246">Determining when the recognition limit is reached</h3>
				<p>The macro runtime keeps a recognition count for every macro that includes a &lt;recolimit&gt; element. When macro playback the recognition count is 0 for all macro screens.</p>
				<p>Suppose that a macro includes a macro screen named ScreenB that ScreenB contains a &lt;recolimit&gt; element with a limit of 100. Each time the macro runtime recognizes ScreenB (is, each time the macro runtime selects ScreenB as the next screen to be processed), the macro runtime performs the steps: </p>
				<ol type="1">
					<li>The macro runtime detects the presence of the &lt;recolimit&gt; inside ScreenB.</li>
					<li>The macro runtime increments the recognition count for ScreenB.</li>
					<li>The macro runtime compares the recognition count with the limit.</li>
					<li>If the recognition count is less than the recognition limit, the macro runtime starts performing the action elements of as usual.</li>
					<li>However, if the recognition count is greater than or equal the recognition limit, then the macro runtime performs the specified by the &lt;recolimit&gt; element. In this case macro does not process any of the action elements in ScreenB.</li>
				</ol>
				<h3 id="wq248">Action when the Recognition limit is reached</h3>
				<p>The default action when the recognition limit is reached is the macro runtime displays an error message such as the and then terminates the macro:</p>
				<pre class="xmp"><code>Recolimit reached, but goto screen not provided, macro terminating.</code></pre>
				<p class="indatacontent">you want the macro runtime, as a recognition limit action, to go another macro screen, then you must use the Code Editor to add a <strong>goto</strong> attribute to the &lt;recolimit&gt; element specify the name of the target macro screen as the value of the (see <button onclick="scrollHere('mr_recolimit')">&lt;recolimit&gt; element</button>).</p>
				<p>If you use the <strong>goto</strong> attribute, the runtime does not terminate the macro but instead starts the macro screen specified in the attribute.</p>
				<p>You can use the target macro screen for any purpose. Some uses are:</p>
				<ul>
					<li>For debugging.</li>
					<li>To display an informative message to the user before the macro.</li>
					<li>To continue processing the macro.</li>
				</ul>
			</div>
		</div>

		<button id="mt_timing" class="accordian">Actions, Part 2: Timing issues</button>
		<div class="panel" style="display:none">
			<p>This chapter describes several timing issues involved in processing and the resources available for dealing with these issues.</p>
			
			<button id="mt_delay_after_action" class="accordian">Pause after an action</button>
			<div class="panel" style="display:none">
				<p>This section discusses the scenario in which an action does not as expected because a previous action has side effects that have not completed.</p>
				<p>There are two settings that let you add a pause after actions during runtime:</p>
				<ul>
					<li>Pause Between Actions on the Macro tab</li>
					<li>Set Pause Time on the General tab of the Screens tab</li>
				</ul>
				<h3 id="wq249">Speed of processing actions</h3>
				<p>Because the macro runtime executes actions much more quickly than a user does, unforeseen problems can occur during macro playback that an action not to perform as expected, because of a dependency on a action.</p>
				<p>One example is a keystroke that causes the application screen to change.If a subsequent action expects the application screen to have already changed, but in fact the application screen is still in the process of being updated, then the subsequent action can fail.</p>
				<p>Timing-dependent errors between actions can occur in other situations, if the macro runtime performs each action immediately after the action.</p>
				<h3 id="mt_pause_between_actions">Pause Between Actions (Macro tab)</h3>
				<p>The Pause Between Actions field on the Macro tab specifies a time for the macro runtime to wait:</p>
				<ul>
					<li>After performing an Input action or a Prompt action, to allow all possible side effects of either of these two actions to complete; and</li>
					<li>After performing the last action in a macro screen, to allow any side effects of action-processing to complete.</li>
				</ul>
				<p>Originally the Pause Between Actions was implemented as a pause after <em>every</em> type of action, not just after Input and actions. It is now implemented as follows:</p>
				<ul>
					<li>The macro runtime waits:  				<ul>
							<li>For an interval equal to 50% of the pause time,  after every Input or Prompt action except the last one in a macro screen.</li>
							<li>For an interval equal to 100% of the pause time, after the last in a macro screen.</li>
						</ul>
					</li>
					<li>The macro runtime does not wait:  				<ul>
							<li>After the last Input action or Prompt action in a macro screen (it is the last action in the macro screen).</li>
							<li>After any other type of action.</li>
						</ul>
					</li>
				</ul>
				<p>By default the Pause Between Actions checkbox is enabled and the value is set to 300 milliseconds. Therefore by default the macro runtime: </p>
				<ul>
					<li>Waits 150 milliseconds after every Input action or Prompt action the last one in a macro screen.</li>
					<li>Waits 300 milliseconds after the last action in a macro screen.</li>
				</ul>
				<p></p>
				<p>Notice that Pause Between Actions affects every macro screen. this one setting allows you avoid timing errors throughout the macro, having to change each macro screen that might have a problem.</p>
				<h3 id="mt_set_pause_time">Set Pause Time (General tab of the Screens tab)</h3>
				<p>If you want a longer or shorter "pause between actions" for a macro screen, or if you have only a few macro screens in which a "pause actions" is important, then you can use the Set Pause Time setting on General tab of the Screens tab.</p>
				<p>By default this checkbox is disabled.</p>
				<p>If you enable this setting for a macro screen, then the macro runtime the specified number of milliseconds for the "pause between actions" for particular macro screen.</p>
				<p>For example, if for ScreenA you select the Set Pause Time checkbox set the value to 500 milliseconds, then the macro runtime waits 250 after each Input action and Prompt action in ScreenA except the last one, and waits 500 milliseconds after the last action in ScreenA..</p>
				<p>When the macro runtime processes a macro screen with Set Pause Time enabled, it ignores the setting of the Pause Between Actions option on the macro tab, and uses only the value in the Set Pause Time setting.</p>
				<h3 id="wq250">Adding a pause after a particular action</h3>
				<p>If you need an additional pause after one particular action in a screen, you can add a Pause action after the action. The wait that you in the Pause action is in addition to any wait that occurs because of a Between Actions or a Set Pause Time.</p>
			</div>

			<button id="mt_screen_completion" class="accordian">Screen completion</button>
			<div class="panel" style="display:none">
				<h3 id="mt_sc_too_soon">Recognizing the next macro screen too soon</h3>
				<p>Suppose that you have a macro screen, ScreenB, with the following bug: the macro runtime starts processing the actions in ScreenB before the has completely finished displaying the new application screen. Although timing peculiarity might not pose a problem for you in most situations, that in this instance the first action in ScreenB is an Extract action causes the macro runtime to read data from rows 15 and 16 of the screen. Unfortunately the macro runtime performs this action before the has had time to write all the new data into rows 15-16.</p>
				<p>Analyzing this problem, you verify that:</p>
				<ul>
					<li>The session is a 3270 Display session using the default connectivity, TN3270.</li>
					<li>The following sequence of actions occurs:  				<ol type="1">
							<li>In processing the previous macro screen, the macro runtime performs Input action that causes an enter key to be sent to the host.</li>
							<li>The host receives the enter key and sends the first block of and data for the new application screen.</li>
							<li>The client receives the first block and processes it, thereby some parts but not all of the host application screen. In particular, 15 and 16 of the application screen have not yet been updated.</li>
							<li>Meanwhile the macro runtime has started trying to recognize a valid macro screen that matches the new application screen.</li>
							<li>As a result of the changes in the application screen from the first of commands and data, the macro runtime recognizes macro ScreenB as the macro screen to be processed.</li>
							<li>The macro runtime performs the first action element in ScreenB, is an Extract action that reads data from rows 15 and 16 of the screen.</li>
							<li>The client receives a second block of commands and data from the and processes it, thereby updating other parts of the application screen, including rows 15 and 16.</li>
						</ol>
					</li>
				</ul>
				<p>In short, as a result of this timing problem the macro runtime has rows 15 and 16 of the new application screen before the host could update them.</p>
				<h3 id="wq252">The ordinary TN3270 protocol</h3>
				<p>The reason for this problem is that the unenhanced TN3270 protocol not include a way for a host to inform a client that the host screen is complete. (TN3270 implements a screen-oriented protocol, 3270 Stream, over a character-oriented connection, Telnet). Therefore, the cannot send several blocks of data to the client and then say, "OK, the screen is now complete - you can let the user enter data now." Instead, each block arrives without any indication about whether it is the last for this application screen. From the client's point of view, something the following events occur:</p>
				<ol type="1">
					<li>A block of commands and data arrives. The client sets the input indicator, processes the block, and displays the new data on the parts of the session window. The client then clears the input inhibit and waits.</li>
					<li>30 milliseconds pass.</li>
					<li>Another block of commands and data arrives. The client processes the as in step 1 above. This block causes a different part of the screen to updated. The client waits.</li>
					<li>50 milliseconds pass.</li>
				</ol>
				<p class="indatacontent">This process continues until the host has completely displayed a host application data screen. The client still waits, not knowing that host application screen is complete. (For more information, see <button onclick="scrollHere('mc3_processing_macro_screen')">How the macro runtime processes a macro screen</button>).</p>
				<p>This process does not present problems for a human operator, for reasons that are not important here.</p>
				<p>However, this process does present problems for the macro runtime screen recognition. Recall that during screen recognition the macro tries to match the application screen to one of the valid next macro every time the screen is updated and every time an OIA event occurs (see <button onclick="scrollHere('mc3_again_tries_to_match')">Re-doing the evaluation</button>). Therefore the macro runtime might a match before the screen is completely updated. For example, a String might state that recognition occurs if row 3 of the application screen the characters "ISPF Primary Option Menu". When the host has updated row to contain these characters, then the macro runtime determines that a has occurred, regardless of whether the host has finished updating the of the application screen.</p>
				<h3 id="wq254">Solutions</h3>
				<p>There are three approaches to solving this problem:</p>
				<ul>
					<li>Add more descriptors to the description.</li>
					<li>Insert a delay after the Input action that sends an enter key (see 1 in <button onclick="scrollHere('mt_sc_too_soon')">Recognizing the next macro screen too soon</button>).</li>
					<li>Use the contention-resolution feature of TN3270E.</li>
				</ul>
				<p class="indatacontent">The following subsections describe these solutions.</p>
				<h4 id="wq255">Add more descriptors</h4>
				<p>This approach works sometimes but can be awkward and unreliable. You enough descriptors to the description part of ScreenB so that the macro will not recognize the ScreenB until the critical portion of the screen has been updated.</p>
				<h4 id="wq256">Insert a delay after the input action</h4>
				<p>Inserting a delay is the best solution if the session is an ordinary session or if the session is a TN3270E session without contention-resolution.That is, after the Input action (in ScreenA in our example) that causes host to send a new application screen, insert a pause of several hundred or longer. This delay allows enough time for the host to update the screen before the macro runtime starts processing the actions in the macro screen (ScreenB).</p>
				<p>In this scenario there are several ways to insert a pause after the action:</p>
				<ul>
					<li>Increase the Pause Between Actions delay.</li>
					<li>Increase the Set Pause Time for ScreenA. This method is a good one. are increasing the pause time only for ScreenA, so that only ScreenA is affected.</li>
					<li>Add a Pause action to ScreenA immediately after the Input action. method is also good. You are inserting a pause exactly where it is needed.</li>
					<li>Add a Pause action as the first action of ScreenB. You might prefer method in certain scenarios. However, using this method, if there are macro screens that can occur after ScreenA (such as ScreenB, ScreenC, ScreenD), and if the screen completion problem occurs for each of these following screens, then you must to insert a Pause as the first action for each of following macro screens. It is easier to use the method in the previous and insert a Pause Action in one macro screen, ScreenA.</li>
				</ul>
				<p>If your macro has to run both on ordinary TN3270 sessions and also on sessions with contention-resolution enabled, the XML macro language has attributes that can help you. See <button onclick="scrollHere('mt_attributes_screen_completion')">Attributes that deal with screen completion</button>.</p>
				<h4 id="mt_use_contention_resolution">Use the contention-resolution feature of TN3270E</h4>
				<p>TN3270E (Enhanced) is an enhanced form of the TN3270 protocol that users to specify an LU or LU pool to which the session will connect and also supports the Network Virtual Terminal (NVT) protocol for connecting servers in ASCII mode (for example, in order to log on to a firewall).</p>
				<p>Contention-resolution mode is an optional feature of TN3270E, by some but not all TN3270E servers, that solves the client's problem of knowing when the host has finished updating the application screen. If client is running a TN3270E session and is connected to a server that contention-resolution, then the macro runtime does not recognize a new screen until the host has finished updating the application screen.</p>
				<p>In Host On-Demand you can set a 3270 Display session to use TN3270E than TN3270 by clicking the appropriate radio button on the Connection window of the 3270 Display session configuration panel.</p>
				<p>Normally Host On-Demand automatically communicates in contention-mode with a TN3270E server, if the server supports it. However, you can contention-resolution mode with an HTML parameter (see <button href="https://scc.its.state.nc.us/hod/en/help/htmlparameters.html">NegotiateCResolution</button> in the online help).</p>
				<h3 id="mt_attributes_screen_completion">Attributes that deal with screen completion</h3>
				<p>Host On-Demand has three element attributes that address problems the macro developer encounters when trying to support a single version a macro to run on both the following environments:</p>
				<ul>
					<li>A non-contention-resolution environment (the macro is being run by connected to a TN3270 server or to a TN3270E server without contention resolution; consequently some macro screens might require a Pause action to allow for the host to update the application screen).</li>
					<li>A content-resolution enviroment (the macro is being run by clients to a TN3270E server with contention resolution; consequently no macro requires a Pause action to allow time for for the host to update the screen).</li>
				</ul>
				<p class="indatacontent">You will have to add these attributes using the Code Editor.</p>
				<h4 id="mt_ignorepauseforenhancedtn">ignorepauseforenhancedtn=true/false</h4>
				<p>The <strong>ignorepauseforenhancedtn</strong> parameter of the &lt;HAScript&gt; element, when set to true, causes the macro runtime to skip Pause (&lt;pause&gt; elements) during macro playback if the session is running in contention-resolution environment. You can use this attribute if you a macro to run in a non-contention-resolution environment (you inserted actions) and you now want the macro to also run in a contention-environment without unnecessary delays (you want the Pause actions to be ignored).</p>
				<p>With this attribute set to true, the macro runtime processes Pause (waits the specified number of milliseconds) in a non-contention-environment but ignores Pause actions in a contention-resolution environment.</p>
				<p>Notice, however, that setting this attribute to true causes the macro to skip all Pause actions (&lt;pause&gt; elements) in the macro, not just pauses that have been inserted in order to time for the application to be updated. The next subsection addresses this secondary problem.</p>
				<h4 id="mt_ignorepauseoverrideforenhancedtn">ignorepauseoverride=true/false</h4>
				<p>The <strong>ignorepauseoverride</strong> parameter the &lt;pause&gt; element, when set to true in a particular &lt;pause&gt; element, causes the macro runtime to process that &lt;pause&gt; element (wait for specified number of milliseconds) even if the<strong> ignorepauseforenhancedtn</strong> attribute is set to true in the &lt;HAScript&gt; element.</p>
				<p>Set this attribute to true in a &lt;pause&gt; element if you want the &lt;pause&gt; element always to be performed, not skipped, even in a contention-environment with the <strong> ignorepauseforenhancedtn</strong> set to true in the &lt;HAScript&gt; element.</p>
				<h4 id="mt_delayifnotenhancedtn">delayifnotenhancedtn=(milliseconds)</h4>
				<p>The <strong>delayifnotenhancedtn</strong> parameter of the &lt;HAScript&gt; element, when set to a non-zero value, causes the macro runtime to pause the specified number of milliseconds whenever the macro runtime a notification that the OIA (Operator Information Area) has changed.</p>
				<p>You can use this attribute if you developed a macro in a contention-environment (you did not need to insert Pause actions) but you now want macro to run also in a non-contention-resolution environment (some macro might need a Pause action to allow time for the application screen to be completed).</p>
				<p>With this attribute set to true, then when the macro is run in a non-contention-environment the macro runtime inserts a pause for the specified number milliseconds each time it receives a notification that the OIA has changed.For example, if you specify a pause of 200 milliseconds then the macro waits for 200 milliseconds every time the OIA changes.</p>
				<p>The cumlative effect of the macro runtime pausing briefly after each of a change to the OIA is that the application screen is completed the macro runtime begins processing the actions of the new macro screen. macro runtime inserts these extra pauses only when it detects that the is running in a non-contention-resolution environment.</p>
				<p>A limitation of this attribute is that the macro runtime adds these pauses during every screen, not just during screens in which screen is a problem. However, the additional time spent waiting is small. And importantly, this attribute lets you quickly adapt the macro to a non-resolution environment, without having to test individual screens and a pause action in each screen with a screen update problem.</p>
			</div>
		</div>


		<button id="mv_variables" class="accordian">Variables and imported Java classes</button>
		<div class="panel" style="display:none">

			<button id="wq257" class="accordian">Introduction to variables and imported types</button>
			<div class="panel" style="display:none">
				<p>Variables help you to add programming intelligence to macros. a variable you can store a value, save a result, keep a count, a text string, remember an outcome, or do any number of other essentials.</p>
				<p>You can create a variable that belongs to any of the standard types (string, integer, double, boolean, and field).</p>
				<p> You can also create a variable that belongs to an imported representing a Java class. You can then create an instance of class and call a method on the instance. This capability opens door to the abundant variety of functionality available through class libraries, including libraries in the Java Runtime (JRE) libraries, libraries in the Host Access Toolkit product, or libraries that you yourself implement, or Java classes and from other sources.</p>
				<h3 id="wq258">Advanced macro format required</h3>
				<p>Using variables requires that you use the advanced macro for your macro (see <button onclick="scrollHere('me_choosing_a_format')">Choosing a macro format</button>). Therefore, if you want to add variables to a macro that is in the basic format, you must decide whether to convert the macro to the macro format. If you have an old macro in the basic macro format many users rely on and that works perfectly, you might want to the macro as it is.</p>
				<p>However, remember that all recorded macros are recorded in basic macro format. So, if you have recently recorded a macro are beginning to develop it further, then you might simply not gotten around to switching to the advanced macro format.</p>
				<p>The Macro Editor addresses both these situations by popping a window with the following message when you start to define a in a macro that is still in the basic macro format:</p>
				<div class="figrules" id="mv_fig_reminder"><span class="figcap">Figure 48. Reminder message</span>
					<pre class="xmp"><code>You are attempting to use an advanced macro feature. If you choose to continue, your macro will automatically be converted to advanced macro format. Would like to continue?</code></pre>
				</div>
				<p class="indatacontent">Click Yes if you are building a macro in which you plan to variables, or No if you have a macro in the basic macro format you do not want to convert.</p>
				<h3 id="wq259">Scope of variables</h3>
				<p>The scope of every variable is global with respect to the in which the variable is created. That is, every variable in a is accessible from any macro screen in the macro. All that an or a descriptor in a macro screen has to do to access the is just to use the variable name.</p>
				<p>For example, suppose that you have a variable named $intPartsComplete$ 		that you initialize to 0. You might use the variable in the ways as the macro proceeds:</p>
				<ol type="1">
					<li>ScreenC completes Part 1 of a task and increments $intPartsComplete$ 		using a Variable update action.</li>
					<li>ScreenG completes Part 2 of a task and increments $intPartsComplete$ 		using a Variable update action.</li>
					<li>ScreenM has a Conditional action that tests whether 1 or 2 have been completed so far. Depending on the result, the macro either ScreenR or ScreenS as the next macro screen to be processed.</li>
					<li>ScreenS completes Part 3 of a task and increments $intPartsComplete$ 		using a Variable update action.</li>
					<li>ScreenZ displays the value of $intPartsComplete$ using a action.</li>
				</ol>
				<p class="indatacontent">In the example above, actions in several different macro are able to read from or write to the variable $intPartsComplete$.</p>
				<h3 id="mv1_intro_to_vars_tab">Introduction to the Variables tab</h3>
				<p>Because a variable belongs to the entire macro, and not to one screen, it seems appropriate that there is a separate high-tab for Variables. The Variables tab allows you to:</p>
				<ul>
					<li>Create a variable</li>
					<li>Remove a variable</li>
					<li>Import a Java class as a new variable type</li>
				</ul>
				<p class="indatacontent"> To create a variable belonging to a standard data type, the Variables tab in the Macro Editor. <button onclick="scrollHere('md1_hame_vars_tab')">Figure 49</button> a sample Variables tab:</p>
				<div class="fignone" id="md1_hame_vars_tab"><span class="figcap">Figure 49. Variables tab</span>
					<div class="mmobj">
						<img src="./mb_hame_vars_tab.gif" alt="">
					</div>
				</div>
				<p class="indatacontent">In the figure above, the Variables tab of Macro Editor is selected. The name of the currently selected variable, <samp class="xph">$strUserName$</samp>, is displayed in the Variables listbox. Three other fields information that the macro runtime needs to create this variable: the Name input field, the Type listbox, and the Initial Value field.</p>
				<p>The Variables listbox contains the names of all the variables have been created for this macro. It allows you to select a to edit or to remove, and it also contains a <samp class="xph">&lt;new variable&gt;</samp> for creating new variables.</p>
				<p> Notice that the entry of the currently selected variable is in parentheses after another string:</p>
				<pre class="xmp"><code>Variable1($strUserName$)</code></pre>
				<p class="indatacontent">string <samp class="xph">Variable1</samp> is a setting that shows how many you have created. It is not saved in the macro script. The real of the variable is <samp class="xph">$strUserName$</samp>, and you should use name alone throughout the macro wherever you use the variable.</p>
				<p>You have probably noticed that the variable name <samp class="xph">$strUserName$</samp> enclosed in dollar signs ($). This is a requirement. You must the variable name in dollar signs ($) wherever you use it in the macro.</p>
				<p>The Name input field displays the name of the currently variable, <samp class="xph">$strUserName$</samp>. You can change the name of variable by typing over the old name. Mostly you should use this only for assigning a name to a newly created variable. Although can come back later at any time and change the name of this (for example to <samp class="xph">$strUserFirstName$</samp>), remember that might have already used the variable's old name elsewhere in the macro, in some action or descriptor. If you change the name here in the tab, then you must also go back to every place in the macro you have you used the variable  and change the old variable name the new variable name.</p>
				<p>You can choose any variable name you like, although there are few restrictions on the characters you can choose (see <button onclick="scrollHere('mv_var_and_type_names')">Variable names and type names</button>). You do not have to choose names begin with an abbreviated form of the data type (such as the <samp class="xph">str</samp> the string variable <samp class="xph">$strUserName$</samp>), as this book does.</p>
				<p>The Type listbox lists the available types for variables and you select the type that you want to use for a new variable. The types are string, integer, double, boolean, and field. Also, you import a Java class, such as <samp class="xph">java.util.Hashtable</samp>, an imported type, the Type listbox picks up this imported type adds it to the list of available types, as shown in <button onclick="scrollHere('mv_fig_types_listbox')">Figure 50</button>:</p>
				<div class="figrules" id="mv_fig_types_listbox"><span class="figcap">Figure 50. Contents of the Type listbox after an imported type has been declared</span>
					<pre class="xmp"><code>java.util.Hashtable</code></pre>
				</div>
				<pre class="xmp"><code></code></pre>
				<p class="indatacontent">You should use this listbox for assigning a to a newly created variable. You can come back later and change variable's type to another type, but, as with variable names, that you might have already used the variable throughout the in contexts that require the type that you initially selected. so, you must go to each of those places and make sure that the in which you are using the variable is appropriate for its new type.</p>
				<p>The Initial Value input field allows you to specify an value for the variable. The Macro Editor provides the following values, depending on the type:</p>
				<table id="mv_table_default_initial_values" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 22. Default initial values for variables</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq261" align="left" valign="top">Type of variable:</th>
							<th id="wq262" align="left" valign="top">Default initial value:</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td headers="wq261">string</td>
							<td headers="wq262">No string</td>
						</tr>
						<tr>
							<td headers="wq261">integer</td>
							<td headers="wq262">0</td>
						</tr>
						<tr>
							<td headers="wq261">double</td>
							<td headers="wq262">0.0</td>
						</tr>
						<tr>
							<td headers="wq261">boolean</td>
							<td headers="wq262">false</td>
						</tr>
						<tr>
							<td headers="wq261">field</td>
							<td headers="wq262">(No initial value)</td>
						</tr>
						<tr>
							<td headers="wq261">(any imported type)</td>
							<td headers="wq262">null</td>
						</tr>
					</tbody>
				</table>
				<p class="indatacontent"> To specify a new initial value just type over the value.</p>
				<p>The Remove button removes the currently selected variable.</p>
				<p>The Import button and the Import popup window are discussed in <button onclick="scrollHere('mv_variables_imported')">Creating an imported type for a Java class</button>.</p>
				<h4 id="mv_creating_new_variable">Creating a new variable</h4>
				<p>To create a new variable in the Macro Editor, first click the <samp class="xph">&lt;variable&gt;</samp> entry at the end of the Variable listbox. The Editor creates a new variable and assigns to it some initial that you should modify to fit your needs. The initial values are:</p>
				<ol type="1">
					<li>An initial name (such as <samp class="xph">$a1$</samp>).</li>
					<li>An initial type (<samp class="xph">string</samp>).</li>
					<li>An initial value, which depends on the type (see <button onclick="scrollHere('mv_table_default_initial_values')">Table 22</button>).</li>
				</ol>
				<p class="indatacontent">Now you should set the values that you want for the new variable.For example, if you are creating an integer variable that is for screens and that should have an initial value of 1, then you set the initial values as follows:</p>
				<ol type="1">
					<li>In the Name input field, type the name <samp class="xph">$intScreenCount$</samp>.</li>
					<li>In the Type listbox, select the <samp class="xph">integer</samp> data type.</li>
					<li>In the Initial Value field, type 1.</li>
				</ol>
				<p>Besides the Variables tab, the Macro Editor provides access, several convenient locations, to a popup window for creating new variables.For example, in the Variable update action, the Name listbox not only all the names of variables that you have already but also a <samp class="xph">&lt;New Variable&gt;</samp> entry. Click this entry bring up the popup window for creating a new variable. Variables using this popup window are equivalent to variables created in Variables tab.</p>
				<p>In the Code Editor, you create a new variable using a &lt;create&gt; element. There is a containing element called &lt;vars&gt; that all the variables in the macro script, and there is a &lt;create&gt; element for each variable. <button onclick="scrollHere('mv_fig_sample_vars_and_create')">Figure 51</button> a &lt;vars&gt; element that contains five &lt;create&gt; elements:</p>
				<div class="figrules" id="mv_fig_sample_vars_and_create"><span class="figcap">Figure 51. Sample &lt;vars&gt; element</span>
					<pre class="xmp"><code>&lt;vars&gt;    &lt;create name="$strAccountName$" type="string" value="" /&gt;    &lt;create name="$intAmount$" type="integer" value="0" /&gt;    &lt;create name="$dblDistance$" type="double" value="0.0" /&gt;    &lt;create name="$boolSignedUp$" type="boolean" value="false" /&gt;    &lt;create name="$fldFunction$" type="field" /&gt; &lt;/vars&gt;</code></pre>
				</div>
				<p class="indatacontent">In the figure above the <samp class="xph">&lt;vars&gt;</samp> element one variable from each of the standard data types (string, integer, double, boolean, and field). You should notice that the of each &lt;create&gt; element match the fields on the Variables tab: the <strong>name </strong>attribute contains the variable name, the <strong>type</strong> attribute contains the type, and the <strong>value</strong> field contains the initial value.</p>
				<p>You must put all variable creations (&lt;create&gt; elements) the &lt;vars&gt; element. The &lt;vars&gt; element itself must appear the &lt;import&gt; element, if any (see the next section), and the first macro screen (&lt;screen&gt; element).</p>
				<h4 id="mv_variables_imported">Creating an imported type for a Java class</h4>
				<p>The way that a Host On-Demand macro imports a Java class is an imported type. That is, you must first create an imported and associate it with a particular Java class. You have to do only once per Java class per macro. Follow these steps to create imported type:</p>
				<ol type="1">
					<li>On the Variables tab, click the Import button. The Import window appears.</li>
					<li>In the Imported Types listbox, select the entry <samp class="xph">&lt;new type&gt;</samp>.</li>
					<li>Type the Class name for the type, such as <samp class="xph">java.util.Hashtable</samp>.You must type the fully qualified class name, including the name if any.</li>
					<li>Type a Short Name, such as <samp class="xph">Hashtable</samp>. If you do specify a short name then the Macro Editor uses the fully class name as the short name. If you do specify a short name you can use either the short name or the fully qualified class when you refer to the imported type.</li>
					<li>Click OK.</li>
				</ol>
				<p class="indatacontent">To create a variable belonging to this imported type, the variable in the normal way, but select the imported type as type of the variable. Follow these steps to create a variable of imported type:</p>
				<ol type="1">
					<li>In the Variables listbox, click the <samp class="xph">&lt;new variable&gt;</samp> at the end. The Macro Editor displays the default initial values the usual way, including a name (such as <samp class="xph">$a1$</samp>), a (<samp class="xph">string</samp>), and an initial value (blank).</li>
					<li>In the Name input field, type the name that you want, such as <samp class="xph">$ht$</samp>.</li>
					<li>In the Type listbox, select the imported type, such as <samp class="xph">Hashtable</samp> (you specified a short name when you imported the type) or <samp class="xph">java.util.Hashtable</samp> (you accepted the default short name, which is the same as the qualified class name).</li>
					<li>In the Initial Value field, you can either leave the field (which results in an initial value of <samp class="xph">null</samp>) or a method that returns an instance of the class, such as <samp class="xph">$Hashtable()$</samp> (using the short name) or <samp class="xph">$new java.util.Hashtable()$</samp> (the fully qualified class name).</li>
				</ol>
				<p class="indatacontent">Notice that the constructors are enclosed in dollar signs ($).You must use dollar signs around every call to a Java method, as you must use dollar signs around the name of a variable. (The is that the enclosing dollar signs tell the macro runtime that needs to evaluate the item.)</p>
				<p>Going back to the Import popup window, the Imported Types allows you to create new types and to edit or delete the types you have already created. To create a new type, click the <samp class="xph">&lt;imported type&gt;</samp> entry at the end of the list. To edit a type, select the type in the Imported Types listbox and modify the in the Class and Short Name input fields. To remove a type, the type and click Remove.</p>
				<p>When you specify a short name, you can use any name, with restrictions (see <button onclick="scrollHere('mv_var_and_type_names')">Variable names and type names</button>).</p>
				<p>In the Code Editor, you create an imported type using a &lt;type&gt; element. There is a containing element called &lt;import&gt; that all the imported types in the macro script, and there is a &lt;type&gt; element for each imported type. <button onclick="scrollHere('mv_fig_import_and_vars')">Figure 52</button> an &lt;import&gt; element that declares an imported type, followed a &lt;vars&gt; element that creates and initializes a variable to the imported type:</p>
				<div class="figrules" id="mv_fig_import_and_vars"><span class="figcap">Figure 52. Imported type and variable of that type</span>
					<pre class="xmp"><code>&lt;import&gt;    &lt;type class="java.util.Hashtable" name="Hashtable" /&gt; &lt;/import&gt;  &lt;vars&gt;    &lt;create name=$ht$ type="Hashtable" value="$new Hashtable(40)$" /&gt;  &lt;/vars&gt;</code></pre>
				</div>
				<p class="indatacontent">In the figure above the &lt;import&gt; element contains one &lt;type&gt; element, which has a <strong>class </strong> attribute (the fully qualified class name, <samp class="xph">java.util.Hashtable</samp>) a <strong>name</strong> attribute (containing the short name, <samp class="xph">Hashtable</samp>).The &lt;vars&gt; element contains one &lt;create&gt; element, which as specifies a name (<samp class="xph">$ht$</samp>), a type (<samp class="xph">Hashtable</samp>), and an initial value (which here is not <samp class="xph">null</samp> but is a call to a constructor that returns an instance of the class, $<samp class="xph">new Hashtable(40)$</samp>).</p>
				<p>If you are using the Code Editor, you must put all imported (&lt;type&gt; elements) inside the &lt;import&gt; element. The &lt;import&gt; element itself must appear inside the &lt;HAScript&gt; element (see <button onclick="scrollHere('mr_hascript')">&lt;HAScript&gt; element</button>) and before the &lt;vars&gt; element.</p>
			</div>

			<button id="wq267" class="accordian">Issues you should be aware of</button>
			<div class="panel" style="display:none">
				<h3 id="wq268">Deploying Java libraries or classes</h3>
				<p>During macro playback, when the macro runtime processes a to a Java method, the macro runtime searches all the available library files and class files for the class to which the method belongs, until it finds the class.</p>
				<p>Deploying a Java library or class consists of placing the file or class file containing the class in a location where the runtime can find it during macro playback.</p>
				<p>You do not have to deploy the following types of Java classes:</p>
				<ul>
					<li>Classes in the Java API (the Java archive files are already on the client workstation and their locations are listed in the that is specified when the Host On-Demand client is launched).</li>
					<li>Classes in the Host On-Demand Macro Utility Libraries (HML libraries) are stored with the Host On-Demand client code (see <button onclick="scrollHere('mv1_hml_libraries')">The Macro Utility Libraries (HML libraries)</button>).</li>
				</ul>
				<p>All other Java classes containing methods invoked by a macro must be deployed by you to a location where the macro runtime find them. Depending on the environment, you can deploy the Java as class files or as libraries containing Java classes.</p>
				<p>For more information on deploying Java libraries and classes, "Deploying customer-supplied Java archives and classes" in <em>Planning, Installing, and Configuring Host On-Demand</em>.</p>
				<h3 id="mv_var_and_type_names">Variable names and type names</h3>
				<p>The rules for variable names are as follows:</p>
				<ul>
					<li>A variable name can contain only alphanumeric characters (a-z, A-Z, 0-9), underscore (_), or hyphen (-).</li>
					<li>Case is significant (for example,<samp class="xph"> strTmp</samp> and <samp class="xph">strtmp</samp> two different names).</li>
					<li>A variable name cannot be the same as the short name or the qualified class name of an imported type.</li>
				</ul>
				<p>The rules for type names are as follows:</p>
				<ul>
					<li>A type name can contain only the alphanumeric characters, (_), hyphen (-), or period (.).</li>
					<li>Case is significant.</li>
				</ul>
				<h3 id="wq269">Transferring variables from one macro to another</h3>
				<p>The PlayMacro action, in which one macro "chains to" another (a call without return), allows you to transfer all the and their values belonging to the calling macro to the target macro.The target macro has access both to its own variables and to the variables (see <button onclick="scrollHere('ma_playmacro')">PlayMacro action (&lt;playmacro&gt; element)</button>).</p>
				<h3 id="mv_field_vars">Field variables</h3>
				<p>A field variable is a type of string variable. It holds a string, just as a string variable does, and you can use it in any in which a string variable is valid.</p>
				<p>However, a field variable differs from a string variable in way in which a string is stored into the field variable. The that a field variable contains is always a string that the macro reads from a 3270 or 5250 field in the current session window. get the macro runtime to read this string from the 3270 or 5250 field, you have to create a Variable update action that specifies:</p>
				<ol type="1">
					<li>The name of the field variable (such as $fldFilename$).</li>
					<li>A location string (a string containing a pair of integers by a comma, such as <samp class="xph">'5,11')</samp>.</li>
				</ol>
				<p class="indatacontent">When the macro runtime performs the Variable update action takes the following steps:</p>
				<ol type="1">
					<li>Looks in the session window at the row and column value by the location string.</li>
					<li>Finds the 3270 or 5250 field in which the row and column is located.</li>
					<li>Reads the entire contents of the field.</li>
					<li>Stores the entire contents of the field as a string into the variable.</li>
				</ol>
				<p>For more information, see <button onclick="scrollHere('ma_variable_update_field')">Variable update action with a field variable</button>.</p>
			</div>

			<button id="wq272" class="accordian">Using variables</button>
			<div class="panel" style="display:none">
				<h3 id="wq273">When variables are initialized</h3>
				<p>The macro runtime assigns initial values to variables at the of the macro playback, before processing any macro screen.</p>
				<h3 id="me_using_vars_in_general">Using variables belonging to a standard type</h3>
				<h4 id="mv_where_use_variables">Using the value that the variable holds</h4>
				<p>A variable that belongs to a standard type (string, integer, double, boolean) can be used in much the same way as an immediate value the same type (such as <samp class="xph">'Elm Street', 10, 4.6e-2, true</samp>):</p>
				<ul>
					<li>Except for the restrictions listed later in this subsection, variable of standard type can be used in any input field (in the Editor) or attribute (in the Code Editor) in which an immediate of the same data type can be used. For example, if an input (such as the Message Text field on the Message action window) a string value, then the field likewise accepts a string variable.See <button onclick="scrollHere('me_equivalents')">Equivalents</button>.</li>
					<li>Variables can be used with operators and expressions in the ways that immediate values of the same types are used. See <button onclick="scrollHere('me_operators_and_expressions')">Operators and expressions</button>.</li>
					<li>The value of a variable occurring in a context different the type of the variable is converted, if possible, to a value the correct type, in the same way that an immediate value of the type is converted. See <button onclick="scrollHere('me_data_type_conversion')">Automatic data type conversion</button>.</li>
				</ul>
				<p>However, you cannot use a variable in certain contexts. In Macro Editor, you cannot use a variable in the following contexts:</p>
				<ul>
					<li>Any field on the General tab.</li>
					<li>The Screen Name field on the Screens tab.</li>
					<li>The value of any field in the PlayMacro action window.</li>
				</ul>
				<p>In the Code Editor, you cannot use a variable in the contexts:</p>
				<ul>
					<li>The name of an attribute of any element.</li>
					<li>The value of any attribute of an &lt;HAScript&gt; element.</li>
					<li>The value of the <strong> name </strong> attribute of a &lt;screen&gt; element.</li>
					<li>The value of the <strong>uselogic</strong> attribute of the &lt;description&gt; element.</li>
					<li>The name of a macro screen in a &lt;nextscreen&gt; element.</li>
					<li>The value of any attribute of a &lt;playmacro&gt; element.</li>
				</ul>
				<h4 id="wq274">Writing a value into a variable belonging to a standard type</h4>
				<p>You can write a value into a variable belonging to a standard in the following ways:</p>
				<ul>
					<li>Assign an initial value when you create the variable.</li>
					<li>Use a Variable update action to assign a value to the variable.</li>
					<li>Use the Prompt action to get user input and assign it to the variable.</li>
					<li>Use the Extract action to read data from the session window assign it to the variable.</li>
					<li>Use an action that writes a return code value into a (such as the Run program action and the Print actions).</li>
				</ul>
				<h5 id="wq275">Restrictions</h5>
				<p>You cannot assign one of the following values to a variable standard type: </p>
				<ul>
					<li>The value <samp class="xph">null</samp>. (Exception: If you assign the value <samp class="xph">null</samp> a string variable, it is converted to the string 'null').</li>
					<li>A call to a void method.</li>
					<li>A call to a method that returns an array.</li>
				</ul>
				<h5 id="wq276">Writing a Java object into a variable of standard type</h5>
				<p>If you write a Java object into a variable of standard type, the macro runtime calls the toString() method of the imported and then attempts to assign the resulting string to the variable.</p>
				<h3 id="wq277">Using variables belonging to an imported type</h3>
				<h4 id="wq278">Using the value that the variable holds</h4>
				<p>You can use the value contained in a variable belonging to an type in the following ways:</p>
				<ul>
					<li>You can assign the variable to another variable of the same using the Variable update action.</li>
					<li>You can call a Java method on the variable (see <button onclick="scrollHere('mv_calling_a_method')">Calling Java methods</button>). If the Java method returns a belonging to a standard type (string, integer, double, boolean), you can use the result as you would use any value of that type.</li>
				</ul>
				<h4 id="wq279">Restrictions</h4>
				<p>You cannot assign the following types of data to a variable imported type: </p>
				<ul>
					<li>A value or variable belonging to a standard type (string, integer, double, boolean, field).</li>
					<li>A instance of, or a variable belonging to, a different type (unless it is a superclass of the imported type).</li>
					<li>An array of instances of objects returned by a method called a variable of imported type.</li>
				</ul>
				<p>If your macro attempts to assign one of these invalid types values to a  variable of imported type, then the Macro runtime a runtime error and halts the macro</p>
				<h4 id="wq280">Writing into the variable belonging to an imported type</h4>
				<p>You can write a value into a variable of imported type in the ways:</p>
				<ul>
					<li>You can assign a value to the variable when you create it.</li>
					<li>You can assign a value to the variable using the Variable action.</li>
				</ul>
				<p class="indatacontent">You can assign the following types of values to a variable to an imported type:</p>
				<ul>
					<li>An instance of the same type. This instance can be either in variable of the same type, or from a call to a method that an instance of the same type.</li>
					<li>The value null. To signify the value null, you can use one the following: 
						<ul>
							<li>The keyword <samp class="xph">null.</samp></li>
							<li>A blank input field (if you are using the Macro Editor), as the Initial Value field on the Variables tab, or the Value on the Variable update window.</li>
							<li>An empty attribute (if you are using the Code Editor), as in the <samp class="xph">value</samp> of the following &lt;create&gt; element: <pre class="xmp"><code>&lt;create name=$ht$ type="Hashtable" value="" /&gt;</code></pre></li>
						</ul>
					</li>
				</ul>
				<h3 id="wq281">Comparing variables of the same imported type</h3>
				<p>In any conditional expression (for example, in the Condition of a conditional action) in which you are comparing two of the same imported type, you should implement a comparison (such as <samp class="xph">equals()</samp>) in the underlying class rather using the variables themselves. For example,</p>
				<pre class="xmp"><code>$htUserData.equals($htPortData$)$</code></pre>
				<p class="indatacontent">instead, you compare the variables themselves (for example <samp class="xph">$htUserData$ == $htPortData$</samp>), then:</p>
				<ol type="1">
					<li>The macro runtime, for each variable, calls the toString() of the underlying Java class and gets a string result</li>
					<li>The macro runtime compares the two string results and gets a result.</li>
					<li>The macro runtime sets the result of the condition to the result obtained in step 2.</li>
				</ol>
				<p class="indatacontent"> This will probably not yield the outcome that you expect comparing the two variables.</p>
			</div>

			<button id="mv1_passing_a_parameter_list" class="accordian">Passing a parameter list to a macro</button>
			<div class="panel" style="display:none">
				<p>In everyday language, a parameter list is a set of values direct a program in its work and that an end user specifies when or she launches the program. For example, if <samp class="xph">copy</samp> is name of a program that copies a file from the current directory another directory, then the following command line invocation:</p>
				<pre class="xmp"><code>copy MyFile.txt c:\temp</code></pre>
				<p class="indatacontent">the copy program by name (<samp class="xph">copy</samp>) and specifies a list (<samp class="xph">MyFile.txt c:\temp</samp>) that includes the name of file to be copied (<samp class="xph">MyFile.txt</samp>) and the destination (<samp class="xph">c:\temp</samp>).</p>
				<p>Host On-Demand has a macro feature that works similarly to a parameter list to a program when the program is invoked. launching a macro, or at the same time as launching a macro, an user can specify a list of name-value pairs, each pair of a variable defined inside the macro and an initial value that macro runtime should assign to the variable.</p>
				<p>For example, if the macro <samp class="xph">FileDownload</samp> downloads a from a remote host to the local workstation, and this macro the variables <samp class="xph">strRemoteFile</samp> and <samp class="xph">strLocalFile</samp>, then the end user can specify the following parameter list:</p>
				<pre class="xmp"><code>strRemoteFile="NewData.123", strLocalFile="MyData.123"</code></pre>
				<p class="indatacontent">the end user plays the macro, the macro runtime initializes each the variables named in the parameter list to the value specified the parameter list. The macro then downloads the file <samp class="xph">NewData.123 </samp>the remote host and renames the downloaded file to <samp class="xph">MyData.123</samp>.</p>
				<p>Of course, for the above scenario to work, the macro writer have coded the macro so that it looks in the variables <samp class="xph">strRemoteFile</samp> and <samp class="xph">strLocalFile</samp> the required information.</p>
				<p>In general, the macro writer is responsible for:</p>
				<ul>
					<li>Creating any variables that are to be used in a parameter list.</li>
					<li>Having the macro look in these variables for the required when the macro is launched.</li>
				</ul>
				<p class="indatacontent">Also, as a part of good programming practice, the macro should consider the following actions:</p>
				<ul>
					<li>Describing the parameter list in the macro description (that is, in the Description input field on the Macro tab of the Macro Editor).</li>
					<li>Displaying a message to the end user if a variable is initialized.</li>
				</ul>
				<p class="indatacontent">For more information see <button onclick="scrollHere('mv1_macro_writer_considerations')">Considerations for the macro writer</button>.</p>
				<p>The end user is responsible for:</p>
				<ul>
					<li>Specifying the parameter list correctly.</li>
				</ul>
				<p>However, the system administrator can handle the task of the parameter list by pre-defining a parameter list, either:</p>
				<ul>
					<li>In the session configuration (if the macro starts when the session starts); or</li>
					<li>In a customized button (created in the main toolbar) that clicked plays the macro with parameter list.</li>
				</ul>
				<p class="indatacontent">For more information see <button onclick="scrollHere('mv1_specifying_parm_list')">Specifying the parameter list</button>.</p>
				<h3 id="wq283">How the Host On-Demand processes a parameter list</h3>
				<p>Every variable in a macro has an initial value, whether or the variable is used in a parameter list. The initial value may either a default initial value (see <button onclick="scrollHere('mv_table_default_initial_values')">Table 22</button>) or an initial value by the macro writer.</p>
				<p>A parameter list exists outside the macro to which it pertains.It is not stored in the macro itself, but rather is passed to macro runtime when macro playback begins.</p>
				<p>When the macro runtime prepares to play a macro, the macro first initializes each variable in the macro to the initial defined in the macro itself for that variable.</p>
				<p>The macro runtime then looks for a parameter list. If a list is provided, then the macro runtime processes each name-pair in the parameter list, re-initializing each named variable the value specified in the list.</p>
				<p>The macro runtime then continues with macro playback in the way.</p>
				<h3 id="mv1_specifying_parm_list">Specifying the parameter list</h3>
				<h4 id="wq284">Where to specify a parameter list</h4>
				<p><button onclick="scrollHere('mv1_table_parameter_list')">Table 23</button> shows the locations the Host On-Demand user interface where you can specify a list for a macro:</p>
				<table id="mv1_table_parameter_list" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 23. Specifying the parameter list for a macro</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq285" align="left" valign="top">Area of the user interface:</th>
							<th id="wq286" align="left" valign="top">How to navigate to the input that contains the parameter list:</th>
							<th id="wq287" align="left" valign="top">Does Host On-Demand save the list?</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td headers="wq285"><p>Session configuration</p></td>
							<td headers="wq286"><p>Start Options window</p>
								<ul>
									<li>Auto-Start Options 
										<ul>
											<li>Parameters input field</li>
										</ul>
									</li>
								</ul>
							</td>
							<td headers="wq287"><p>Yes.</p><p>The input list is saved as of the session configuration.</p></td>
						</tr>
						<tr>
							<td headers="wq285"><p>Main toolbar</p><p>Please notice: The toolbar can be saved as a toolbar object and then imported into session configurations.</p></td>
							<td headers="wq286"><p>Edit &gt; Preferences &gt; Toolbar &gt; Add Button</p>
								<ul>
									<li>Macro 
										<ul>
											<li>Parameters input field</li>
										</ul>
									</li>
								</ul>
							</td>
							<td headers="wq287"><p>Yes.</p><p>The parameter list is saved part of the main toolbar.</p></td>
						</tr>
						<tr>
							<td headers="wq285"><p>Play macro dialog</p></td>
							<td headers="wq286"><p>Actions &gt; Play Macro</p>
								<ul>
									<li>Parameters input field</li>
								</ul>
							</td>
							<td headers="wq287"><p>No.</p><p>The parameter list is saved in the Parameters input field until another selection is in either:</p>
								<ul>
									<li>The Play macro dialog; or</li>
									<li>The Available macros dialog.</li>
								</ul>
							</td>
						</tr>
						<tr>
							<td headers="wq285"><p>Available macros dialog</p></td>
							<td headers="wq286"><p><samp class="xph">Select a macro</samp> icon on the Manager toolbar</p>
								<ul>
									<li>Parameters input field</li>
								</ul>
							</td>
							<td headers="wq287"><p>No.</p><p>The parameter list is saved in the Parameters input field until another selection is in either:</p>
								<ul>
									<li>The Play macro dialog; or</li>
									<li>The Available macros dialog.</li>
								</ul>
							</td>
						</tr>
						<tr>
							<td headers="wq285"><p>Customize popup keypad dialog</p></td>
							<td headers="wq286"><p>  Edit &gt; Preferences &gt; Popup Keypad &gt; in the main window, or Edit &gt; Customize in the popup keypad window</p></td>
							<td headers="wq287"><p>Yes.</p><p>The parameter list is saved part of the popup keypad.</p></td>
						</tr>
					</tbody>
				</table>
				<p>However, you cannot specify a parameter list when you play currently selected macro using the Play Macro icon in the Macro toolbar. Instead, specify a parameter list in the Available dialog (as shown in row 4 of the table above) and then play the selected macro.</p>
				<p>In the table above, notice that Host On-Demand saves the list only for the locations specified in the first two rows of table (in the Auto-Start section of the session configuration, in a customized button added to the main toolbar).</p>
				<p>Also, notice that Host On-Demand saves the parameter list the macro (as a part of the session configuration or as a part the main toolbar) rather than as a part of the macro itself.</p>
				<h4 id="mv1_format_of_a_parm_list">Format of a parameter list</h4>
				<p>When you specify a parameter list (for example, in the input field of the Macro window of the Add Button dialog, as in row 2 of <button onclick="scrollHere('mv1_table_parameter_list')">Table 23</button>) you must it in the following format:</p>
				<pre class="xmp"><code>name1="value1", name2="value2", name3="value3", ...</code></pre>
				<p class="indatacontent">example,</p>
				<pre class="xmp"><code>strRemoteFile="NewData.123", strLocalFile="MyData.123"</code></pre>
				<p class="indatacontent">are the format rules:</p>
				<ul>
					<li><strong>Parameter list</strong>
						<p>The parameter list is series of name-value pairs. You can specify any number of pairs, long as each pair refers to a variable that is defined in the macro.</p>
						<p>either a blank space (<samp class="xph">' '</samp>), a comma (<samp class="xph">','</samp>), both (<samp class="xph">", "</samp>) to separate one name-value pair from the next.</p>
					</li>
					<li><strong>Name-value pair</strong>
						<p>In the name-value pair, specify the variable name, followed by an equals sign (<samp class="xph">'='</samp>), followed by the value enclosed in double quotes (<samp class="xph">""</samp>). example,</p>
						<pre class="xmp"><code>strLocalFile="MyData.123"</code></pre>
					</li>
					<li><strong>Variable name</strong>
						<p>Spell the variable exactly as it is spelled in the macro. Letter case is significant! For example, <samp class="xph">strLocalFile</samp> is different from <samp class="xph">strLocalfile</samp>.</p>
						<p>can specify the variable name with or without the enclosing signs ($). Right: <samp class="xph">$strLocalFile$</samp>. Also right: <samp class="xph">strLocalFile</samp>.</p>
						<p>variable must be a primitive variable, that is, a variable to a standard type (integer, double, string, or boolean). You specify a variable belonging to an imported type (that is, based an imported Java class).</p>
					</li>
					<li><strong>Equals sign (<samp class="xph">'='</samp>)</strong>
						<p>An sign is required between the variable name and the value.</p>
					</li>
					<li><strong>Variable value</strong>
						<p>The variable value be enclosed in double quotes (<samp class="xph">""</samp>).</p>
						<p>The value be a simple value, not an expression.</p>
						<p>If the value belongs a different standard data type than the variable, then Host On-automatically attempts to convert the value to the correct data in the usual way (see <button onclick="scrollHere('me_data_type_conversion')">Automatic data type conversion</button>).</p>
						<p>for string variables:</p>
						<ul>
							<li>Do <em>not</em> also enclose the string in quotes. Wrong: <samp class="xph">strAddress="'123 Elm Street'"</samp>. Right: <samp class="xph">strAddress="Elm Street"</samp>.</li>
							<li>To specify an empty string, use two double quotes with between. Empty string: <samp class="xph">""</samp>.</li>
							<li>Use escape sequences for the single quote (<samp class="xph">'</samp>) and backslash (<samp class="xph">\</samp>).
								<ul>
									<li>To specify a single quote, use <samp class="xph">\'</samp>. Example:<samp class="xph"> "John\'Business Plan"</samp>.</li>
									<li>To specify a backslash, use <samp class="xph">\\</samp>. Example: <samp class="xph">"c:\\and Settings"</samp>.</li>
								</ul>
							</li>
						</ul>
						<p>Rules for doubles, integers, and booleans:</p>
						<ul>
							<li>You can include extra spaces around the value. Host On-will discard the extra spaces. Examples: <samp class="xph">" 10"</samp>, <samp class="xph">" 423.25 "</samp>, <samp class="xph">"true "</samp>.</li>
						</ul>
						<p></p>
						<p>Examples of each primitive variable type:</p>
						<pre class="xmp"><code>intLineCount="24", dblLength="1441.25", strName="John Smith", boolComplete="true"</code></pre>
					</li>
				</ul>
				<h4 id="mv1_checking_parm_list">Checking the parameter list for errors</h4>
				<p>Host On-Demand does not check the parameter list for errors the end user plays the macro. When the end user plays the macro, Host On-Demand finds an error in the parameter list, then Host On-Demand:</p>
				<ul>
					<li>Terminates the macro playback.</li>
					<li>Generates an error message, either by displaying an error box for the end user or by writing a message to the Java console.</li>
				</ul>
				<p>Host On-Demand checks for three types of error situations:</p>
				<ul>
					<li><strong>The specified variable does not exist in macro.</strong>
						<p>In this type of error the parameter list includes variable name that does not exist in the macro or that is incorrectly (for example, <samp class="xph">strLocalfile</samp> instead of <samp class="xph">strLocalFile</samp>).</p>
						<p>that you can take to avoid this type of problem are as follows:</p>
							<ul>
								<li>Warn end users that variable names must be spelled correctly; or</li>
								<li>In the main toolbar, create a customized button that plays macro with the correct parameter list.</li>
							</ul>
						<p></p>
					</li>
					<li><strong>A syntax error exists in the parameter list.</strong>
						<p>this type of error the parameter list contains a syntax error (example, the value is not enclosed in double quotes).</p>
						<p>that you can take to avoid this type of problem are as follows:</p>
						<ul>
							<li>Warn end users that syntax rules must be observed; or</li>
							<li>In the main toolbar, create a customized button that plays macro with the correct parameter list.</li>
						</ul>
						<p><button onclick="scrollHere('mv1_fig_syntax_errors')">Figure 53</button> gives examples syntax errors and describes how Host On-Demand processes the errors:</p>
						<div class="figrules" id="mv1_fig_syntax_errors"><span class="figcap">Figure 53. Examples of syntax errors</span>
							<pre class="xmp"><code><strong>strRemoteFile="NewData.123 intLength="14622"</strong> Host On-Demand: 1) Sets the variable strRemoteFile to <strong>"NewData.123 intLength="</strong>.2) Tries to process <strong>14622"</strong> but    (Host On-Demand is  looking for a variable    but instead finds an integer followed by a double quote).3) Terminates the macro playback and generates an error message.
							<strong>strRemoteFile="NewData.123"98 strLocalFile="MyData.123"</strong> Host On-Demand: 1) Sets the variable strRemoteFile to <strong>"NewData.123"</strong>.2) Tries to process <strong>98</strong> but    (Host On-Demand is looking for a variable name but finds an integer).3) Terminates the macro playback and generates an error message.
							<strong>strRemoteFile=NewData.123 strLocalFile=MyData.123</strong> Host On-Demand: 1) Does not find a double quote after the first equals sign (<strong>=</strong>).2) Terminates the macro playback and generates an error message.</code></pre>
						</div>
						<p></p>
					</li>
					<li><strong>A run-time error occurs.</strong>
						<p>An example a problem in a parameter list that causes a run-time error is following:</p>
						<pre class="xmp"><code>intLength="abc"</code></pre>
						<p class="indatacontent">In the example above the variable <samp class="xph">intLength</samp> of type integer. Host On-Demand tries to convert the string <samp class="xph">abc</samp> a decimal integer and fails.</p>
						<p>When a run-time error occurs, Host On-Demand:</p>
							<ul>
								<li>Terminates the macro playback.</li>
								<li>Displays an error dialog box containing the error message.</li>
							</ul>
						<p>In the above example of a run-time error, Host On-displays an error dialog box containing a message such as the following: <samp class="xph">type mismatch occurred while updating variable $intLength$</samp>.</p>
					</li>
				</ul>
				<h4 id="wq288">Specifying the parameter list from a program</h4>
				<p>The Host Access Toolkit (included on the Host On-Demand CD-ROM) provides two Java methods for managing parameter lists:</p>
				<ul>
					<li>public Properties getPrimitiveMacroVariables() <p>Returns, each primitive variable in the macro, the variable name and the value to which the macro sets the variable. Use this method to a list of the all variables in the macro that you could include a parameter list.</p></li>
					<li>public void setVariableParameters (Properties p) <p>Specifies input parameter list for the macro, consisting of a variable and a value for each parameter.</p></li>
				</ul>
				<p class="indatacontent">For more information see the documentation included with Host Access Toolkit.</p>
				<h3 id="mv1_macro_writer_considerations">Considerations for the macro writer</h3>
				<p>When you code a macro to use a parameter list, remember that:</p>
				<ul>
					<li>The macro writer need not and cannot set any switches, the macro, to indicate that a particular variable is to be by means of a parameter list. (Of course, the macro writer can a comment to this effect.) Information about a parameter list is stored inside the macro.</li>
					<li>Even without a parameter list, each variable has an initial value, which is either a default initial value (see <button onclick="scrollHere('mv_table_default_initial_values')">Table 22</button>) or an initial value by the macro writer.</li>
				</ul>
				<p>As a general principle, remember that the end user must be specify the parameter list correctly, without syntax errors or errors. To help end users, consider the following actions:</p>
				<ul>
					<li>Describe the parameter list in the Description field on the tab of the Macro Editor. An end user can view the contents of Description field by displaying the Properties dialog for the from either: 
						<ul>
							<li>The Available macros dialog (click the Select a macro icon the Macro Manager toolbar).</li>
							<li>The Play macros dialog (click Actions &gt; Play macro).</li>
						</ul>
					</li>
					<li>Code the macro to check for improperly initialized variables post a warning message if a variable is not initialized properly.</li>
					<li>Create a customized button in the main toolbar that plays macro with the correct parameters.</li>
				</ul>
				<h3 id="wq289">A parameter list does not initialize variables in a chained-macro</h3>
				<p>A parameter list initializes variables only in the macro that end user launches with the parameter list. A parameter list does initialize variables of the same name that occur in a subsequent that the original macro chains to. (For more information on chained-macros see <button onclick="scrollHere('ma_playmacro')">PlayMacro action (&lt;playmacro&gt; element)</button>.)</p>
				<p>For example, consider the following situation:</p>
				<ul>
					<li>The end user starts macro <samp class="xph">FileDownload</samp> with the list <samp class="xph">strRemoteFile="NewData.123"</samp>.</li>
					<li>Macro <samp class="xph">FileDownload</samp> later chains to macro <samp class="xph">Download01</samp>.</li>
					<li>Macro <samp class="xph">Download01</samp> also contains a variable named <samp class="xph">strRemoteFile</samp>.</li>
				</ul>
				<p class="indatacontent">In this situation, when Host On-Demand prepares to play the chained-macro, Host On-Demand does<em>not</em> initialize variable <samp class="xph">strRemoteFile</samp> in the chained-to macro to <samp class="xph">NewData.123</samp>.Instead, as usual, Host On-Demand initializes the variable in chained-to macro is whatever initial value is specified in the chained-macro (either a default initial value or an initial value by the macro writer).</p>
				<p>Do not confuse the above situation with the transferring of that can occur when one macro chains to another. If macro A to macro B, macro A can pass all its variables and their current to B (see <button onclick="scrollHere('ma_transferring_variables')">Transferring variables</button>). Use this to pass values from the calling macro to the chained-to macro.</p>
			</div>

			<button id="mv_calling_a_method" class="accordian">Calling Java methods</button>
			<div class="panel" style="display:none">
				<h3 id="wq290">Where method calls can be used</h3>
				<p>You can call a method in any context in which the value by the method is valid. For example, in an Input action you can the Row value to the integer value returned by a method, such as:</p>
				<pre class="xmp"><code>$importedVar.calculateRow()$</code></pre>
				<p>Also, you can use the Perform action to call a method when do not need the return variable of the method or when the method no return value (void) (see <button onclick="scrollHere('ma_perform')">Perform action (&lt;perform&gt; element)</button>).</p>
				<h3 id="mv_syntax_of_method_calls">Syntax of a method call</h3>
				<p>To call a method belonging to an imported class, use the same that you would use in Java. However, in addition, you must also a method call in dollar signs ($), just as you would a variable. Examples:</p>
				<pre class="xmp"><code>$new FileInputStream('myFileName')$ $fis.read()$ </code></pre>
				<p class="indatacontent">An immediate string value (such as <samp class="xph">'Elm Street'</samp>, or <samp class="xph">'myFileName'</samp> in the first example above) passed as parameter to a method must be enclosed in single quotes, as (see <button onclick="scrollHere('me_advanced_format_rules')">In the advanced macro format, rules for representation of strings, etc.</button>).</p>
				<h3 id="mv_how_search_for_method">How the macro runtime searches for a called method</h3>
				<p>When you add a method call (such as <samp class="xph">$prp.get('Group Name')$</samp>) to a macro script, the Macro Editor does not verify that a method or constructor exists in the class to which the variable belongs.That check is done by the macro runtime when the call occurs.</p>
				<p>The method must be a <em>public </em> method the underlying Java class.</p>
				<p>When the macro runtime searches in the Java class for a to match the method that you have called, the macro runtime maps data types (boolean, integer, string, field, double, imported type) to Java data types as shown in <button onclick="scrollHere('mv_table_mapping_parameter_types')">Table 24</button>:</p>
				<table id="mv_table_mapping_parameter_types" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 24. How the macro runtime maps macro data types to Java data types</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq291" align="left" valign="top">If the method parameter to this macro data type:</th>
							<th id="wq292" align="left" valign="top">Then the macro runtime looks a Java method with a parameter of this Java data type:</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td headers="wq291">boolean</td>
							<td headers="wq292">boolean</td>
						</tr>
						<tr>
							<td headers="wq291">integer</td>
							<td headers="wq292">int</td>
						</tr>
						<tr>
							<td headers="wq291">string</td>
							<td headers="wq292">String</td>
						</tr>
						<tr>
							<td headers="wq291">field</td>
							<td headers="wq292">String</td>
						</tr>
						<tr>
							<td headers="wq291">double</td>
							<td headers="wq292">double</td>
						</tr>
						<tr>
							<td headers="wq291">imported type</td>
							<td headers="wq292">underlying class of the imported type</td>
						</tr>
					</tbody>
				</table>
				<p>The macro runtime searches for a called method as follows:</p>
				<ol type="1">
					<li>The macro runtime searches for the class specified in the type definition (such as <samp class="xph">java.util.Properties</samp>).</li>
					<li>The macro runtime searches in the class for a method with same method signature (name, number of parameters, and types of parameters) as the called method.</li>
					<li>If the search succeeds, then the macro runtime calls the method.</li>
					<li>If the search fails, then the macro runtime searches in the for a method with the same name and number of parameters (the types of the parameters) as the called method.
						<ol type="a">
							<li>If the macro runtime finds such a method, it calls the with the specified parameters.</li>
							<li>If the call returns without an error, the macro runtime that it has called the right method.</li>
							<li>If the call returns with an error, the macro runtime for another method.</li>
							<li>The search continues until all methods with the same name number of parameters have been tried. If none was successful, the macro runtime generates a runtime error.</li>
						</ol>
					</li>
				</ol>
			</div>

			<button id="mv1_hml_libraries" class="accordian">The Macro Utility Libraries (HML libraries)</button>
			<div class="panel" style="display:none">
				<p>The Host On-Demand Macro Utility Libraries (HML libraries) utility libraries that are packaged with the Host On-Demand code. You can invoke a method from one of these libraries without:</p>
				<ul>
					<li>Importing the underlying class; or</li>
					<li>Creating a variable to contain an instance of the class; or</li>
					<li>Creating an instance of the class.</li>
				</ul>
				<p class="indatacontent">In fact, you are not allowed to import a class contained in HML Java library, or to create a variable belonging to an HML class, or to create an instance of an HML object.</p>
				<p>The reason is that the macro runtime, during the initializing goes on when macro playback is started:</p>
				<ul>
					<li>Imports all the HML classes.</li>
					<li>Creates one variable for each HML class to contain an of the class.</li>
					<li>Creates one instance of each HML class and stores it in the variable.</li>
				</ul>
				<p>The following table shows for each HML variable the variable and the types of methods in the underlying class.</p>
				<table id="wq295" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 25. HML variables</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq296" width="35%" align="left" valign="top">HML variable:</th>
							<th id="wq297" width="64%" align="left" valign="top">Description of methods:</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td headers="wq296">$HMLFormatUtil$</td>
							<td headers="wq297">Methods for formatting strings.</td>
						</tr>
						<tr>
							<td headers="wq296">$HMLPSUtil$</td>
							<td headers="wq297">Methods that access the presentation space the session window.</td>
						</tr>
						<tr>
							<td headers="wq296">$HMLSessionUtil$</td>
							<td headers="wq297">Methods that return session values.</td>
						</tr>
						<tr>
							<td headers="wq296">$HMLSQLUtil$</td>
							<td headers="wq297">Methods that return information about the of the most recent SQLQuery action.</td>
						</tr>
						<tr>
							<td headers="wq296">$HMLSystemUtil$</td>
							<td headers="wq297">Methods that return information about applet, Java properties and OS environments.</td>
						</tr>
					</tbody>
				</table>
				<h3 id="wq298">Invoking an method belonging to an HML library</h3>
				<p>To invoke a method belonging to an HML library, specify the name, method name, and input parameters in the usual way:</p>
				<div class="figrules" id="mv1_fig_invoking_hml_method"><span class="figcap">Figure 54. Examples of invoking HML methods</span>
					<pre class="xmp"><code>$HMLFormatUtil.numberToString(1.44)$ $HMLPSUtil.getCursorPos()$ $HMLSessionUtil.getHost()$</code></pre>
				</div>
				<h3 id="wq299">Variables names beginning with HML are reserved</h3>
				<p>To prevent confusion between normal variables and HML variables, variable names beginning with <samp class="xph">HML</samp> are reserved. If try to create a variable beginning with <samp class="xph">HML</samp>, Host On-generates an error message.</p>
				<h3 id="wq300">$HMLFormatUtil$</h3>
				<p>The methods invoked with $HMLFormatUtil$ are formatting methods. <button onclick="scrollHere('mv1_table_hmlformatutil')">Table 26</button> summarizes these methods:</p>
				<table id="mv1_table_hmlformatutil" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 26. Method summary for $HMLFormatUtil()$</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq301" colspan="2" align="left" valign="top">METHOD SUMMARY: $HMLFormatUtil$</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td width="15%" headers="wq301"><samp class="xph">String</samp></td>
							<td width="84%" headers="wq301">
								<dl>
									<dt class="bold"><samp class="xph">numberToString(Object obj)</samp></dt>
									<dd>Converts a number to a string formatted according to the configured locale. The input parameter can be of type integer or type double.</dd>
								</dl>
							</td>
						</tr>
						<tr>
							<td headers="wq301"><samp class="xph">int  or double</samp></td>
							<td headers="wq301">
								<dl>
									<dt class="bold"><samp class="xph">stringToNumber(String str)</samp></dt>
									<dd>Converts a numeric string in the local format (such as '1111.56', '1,111.56', or '1111,56') to a number. The number returned is of type integer or of type double, depending on the input string.</dd>
								</dl>
							</td>
						</tr>
					</tbody>
				</table>
				<h4 id="wq302">Converting numbers to and from the format of the current locale</h4>
				<p>A locale is a set of formatting conventions associated with a national language and geographic area. For example, depending on locale with which a client workstation is configured, a decimal such as 1111.22 can be represented with any of the following strings:</p>
				<pre class="xmp"><code>'1111.22' '1,111.22' '1111,22'</code></pre>
				<p class="indatacontent">As another example, a negative number such as -78 be represented as:</p>
				<pre class="xmp"><code>'-78' '78-'</code></pre>
				<p>The methods <samp class="xph">numberToString(</samp>) and <samp class="xph">stringToNumber()</samp> conversions between a number (that is, a variable or immediate of type integer or type double, such as 1111.22) and its in the current locale (a string, such as <samp class="xph">'1111.22'</samp>, <samp class="xph">'1,111.22'</samp>, or <samp class="xph">'1111,22'</samp>).</p>
				<h4 id="wq303">Method details</h4>
				<h5 id="mv1_numbertostring">numberToString()</h5>
				<pre class="xmp"><code>public String <strong>numberToString(Object obj)</strong></code></pre>
				<p>This method converts a number (integer or double) to a string according to the currently configured locale. The input can be of type integer or of type double.</p>
				<p>This method replaces the standalone method <samp class="xph">$FormatNumberToString()$</samp>, which is deprecated.</p>
				<p></p>
				<div class="figrules" id="mv1_fig_numbertostring"><span class="figcap">Figure 55. Examples for numberToString()</span>
					<pre class="xmp"><code>&lt;input value="$HMLFormatUtil.numberToString(1111.44)$"           row="20" col="16" movecursor="true"           xlatehostkeys="true" encrypted="false" /&gt;</code></pre>
				</div>
				<h5 id="mv1_stringtonumber">stringToNumber()</h5>
				<pre class="xmp"><code>public int <strong>stringToNumber(String str)</strong> public double <strong>stringToNumber(String str)</strong></code></pre>
				<p>This method converts a numeric string formatted according to currently configured locale to a number. The number returned is of type integer or of type double, depending on the input string.</p>
				<p>This method replaces the standalone method <samp class="xph">$FormatStringToNumber()$</samp>, which is deprecated.</p>
				<p></p>
				<div class="figrules" id="mv1_fig_stringtonumber"><span class="figcap">Figure 56. Examples for stringToNumber()</span>
					<pre class="xmp"><code>&lt;message title="’stringToNumber()’" value="’1111.33’" /&gt; &lt;extract name="'Extract'" planetype="TEXT_PLANE"          srow="1" scol="1"          erow="1" ecol="10" unwrap="false"          assigntovar="$value$" /&gt; &lt;if condition="$HMLFormatUtil.stringToNumber($value$)$ &lt; 0 "    ...&lt;/if&gt;</code></pre>
				</div>
				<h3 id="wq304">$HMLPSUtil$</h3>
				<p>The methods invoked with $HMLPSUtil$ affect the presentation of the session window or return information about the space of the session window. <button onclick="scrollHere('mv1_table_hmlpsutil')">Table 27</button> these methods:</p>
				<table id="mv1_table_hmlpsutil" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 27. Method summary for $HMLPSUtil$</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq305" colspan="2" align="left" valign="top">METHOD SUMMARY: $HMLPSUtil$</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td width="15%" headers="wq305"><samp class="xph">int</samp></td>
							<td width="84%" headers="wq305">
								<dl>
									<dt class="bold"><samp class="xph">convertPosToCol(int pos)</samp></dt>
									<dd>Returns the column number of the specified position in the space.</dd>
								</dl>
							</td>
						</tr>
						<tr>
							<td headers="wq305"><samp class="xph">int</samp></td>
							<td headers="wq305">
								<dl>
									<dt class="bold"><samp class="xph">convertPosToRow(int Pos)</samp></dt>
									<dd>Returns the row number of the specified position in the space.</dd>
								</dl>
							</td>
						</tr>
						<tr>
							<td headers="wq305"><samp class="xph">void</samp></td>
							<td headers="wq305">
								<dl>
									<dt class="bold"><samp class="xph">enableRoundTrip(boolean flag)</samp></dt>
									<dd>For bidirectional languages, determines whether numerals by bidirectional characters exchange places with the numerals.</dd>
								</dl>
							</td>
						</tr>
						<tr>
							<td headers="wq305"><samp class="xph">int</samp></td>
							<td headers="wq305">
								<dl>
									<dt class="bold"><samp class="xph">getCursorCol()</samp></dt>
									<dd>Returns the column number of the text cursor in the space.</dd>
								</dl>
							</td>
						</tr>
						<tr>
							<td headers="wq305"><samp class="xph">int</samp></td>
							<td headers="wq305">
								<dl>
									<dt class="bold"><samp class="xph">getCursorPos()</samp></dt>
									<dd>Returns the position of the text cursor in the space.</dd>
								</dl>
							</td>
						</tr>
						<tr>
							<td headers="wq305"><samp class="xph">int</samp></td>
							<td headers="wq305">
								<dl>
									<dt class="bold"><samp class="xph">getCursorRow()</samp></dt>
									<dd>Returns the row number of the text cursor in the space.</dd>
								</dl>
							</td>
						</tr>
						<tr>
							<td headers="wq305"><samp class="xph">int</samp></td>
							<td headers="wq305">
								<dl>
									<dt class="bold"><samp class="xph">getSize()</samp></dt>
									<dd>Returns the size of the presentation space (number of positions in the presentation space) .</dd>
								</dl>
							</td>
						</tr>
						<tr>
							<td headers="wq305"><samp class="xph">int</samp></td>
							<td headers="wq305">
								<dl>
									<dt class="bold"><samp class="xph">getSizeCols()</samp></dt>
									<dd>Returns the number of columns in the presentation space.</dd>
								</dl>
							</td>
						</tr>
						<tr>
							<td headers="wq305"><samp class="xph">int</samp></td>
							<td headers="wq305">
								<dl>
									<dt class="bold"><samp class="xph">getSizeRows()</samp></dt>
									<dd>Returns the number of rows in the presentation space.</dd>
								</dl>
							</td>
						</tr>
						<tr>
							<td headers="wq305"><samp class="xph">String</samp></td>
							<td headers="wq305">
								<dl>
									<dt class="bold"><samp class="xph">getString(int pos, int len)</samp></dt>
									<dd>Returns the text string beginning at the specified in the presentation space and running for the specified length.</dd>
								</dl>
							</td>
						</tr>
						<tr>
							<td headers="wq305"><samp class="xph">int</samp></td>
							<td headers="wq305">
								<dl>
									<dt class="bold"><samp class="xph">searchString(String str)</samp></dt>
									<dd>Returns the position in the presentation space of the string (0 if the specified string is not found in the space).</dd>
								</dl>
							</td>
						</tr>
					</tbody>
				</table>
				<h4 id="wq306">Presentation space</h4>
				<p>The presentation space is a data structure that contains an for each row and column position in the session window (but not the last row of the session window, which is used for the Information Area). The size of the presentation space depends on size of the session window. For example, if the session window 80 rows and 25 columns, then the size of the presentation space 80 * 24 = 1920.</p>
				<p>The position of the elements in the presentation space serially to the row and column positions in the session window, from left to right, top to bottom. For example, if the session has 80 rows and 25 columns, then:</p>
				<div class="figrules" id="mv1_fig_rowcolpos"><span class="figcap">Figure 57. Correspondence of row and column location in the session window to the position in the presentation space</span>
					<pre class="xmp"><code><strong>     Row of    Column of  Corresponds      Session   Session    element at      Window:   Window:    position in PS:</strong>
        		 1          1                      1          2                      1          3                   ...         1         80                     2          1                     2          2                     2          3                  ...        24         79                  24         80          1920</code></pre>
    			 </div>
				<p>Host On-Demand uses the presentation space to store the that are to be displayed in the session window. Each element in presentation space is used to store one character (and about that character, such as intensity). For example, if the string <samp class="xph">Message</samp> at row 1 and column 1 of the session window, then:</p>
				<div class="figrules" id="mv1_fig_message"><span class="figcap">Figure 58. Layout when 'Message' appears in row 1, column 1</span>
					<pre class="xmp"><code><strong>     Row of    Column of  Corresponds         Session   Session    to element     stored      Window:   Window:    at this pos-   this element:                           ition in PS:</strong>
        		 1          1          1                   1          2          2                   1          3          3                   1          4          4                   1          5          5                   1          6          6                   1          7          7          e</code></pre>
				</div>
				<p>Although you normally will not need to use them, <button onclick="scrollHere('mv1_fig_calculate')">Table 28</button> show the formulas for calculating values. The meanings of the symbols used in these formulas is as follows:</p>
				<ul>
					<li><samp class="xph">row</samp> - A row location in the session window</li>
					<li><samp class="xph">col</samp> - A column location in the session window</li>
					<li><samp class="xph">pos</samp> - A position in the presentation space</li>
					<li><samp class="xph">NUMROWS</samp> - The number of rows in the session window, <em>not</em> including the last row used for the Information Area (OIA).</li>
					<li><samp class="xph">NUMCOLS</samp> - The number of columns in the session window.</li>
				</ul>
				<table id="mv1_fig_calculate" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 28. Formulas for calculating values related to presentation space</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq307" width="27%" align="left" valign="top">Value:</th>
							<th id="wq308" width="72%" align="left" valign="top">Formula for calculating:</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td headers="wq307"><samp class="xph">Size of the PS</samp></td>
							<td headers="wq308">
							<pre class="xmp"><code> NUMROWS *     Example:     24 * 80 = 1920</code></pre></td>
						</tr>
						<tr>
							<td headers="wq307"><samp class="xph">row</samp></td>
							<td headers="wq308">
							<pre class="xmp"><code> (pos + NUMCOLS - 1) /     Example:     (81 + 80 - 1) / 80 = 2 </code></pre></td>
						</tr>
						<tr>
							<td headers="wq307"><samp class="xph">col</samp></td>
							<td headers="wq308">
							<pre class="xmp"><code> pos - ((row - 1) * NUMCOLS)      Example:     1920 - ((24 - 1) * 80) = 80</code></pre></td>
						</tr>
						<tr>
							<td headers="wq307"><samp class="xph">pos</samp></td>
							<td headers="wq308">
							<pre class="xmp"><code> ((row - 1) * NUMCOLS) +     Example:     ((24 - 1) * 80) + 1 = 1641</code></pre></td>
						</tr>
					</tbody>
				</table>
							<h4 id="wq309">Method details</h4>
				<h5 id="wq310">convertPosToCol()</h5>
				<pre class="xmp"><code>public int <strong>convertPosToCol(int pos)</strong></code></pre>
				<p>This method returns the column number associated with the position in the presentation space.</p>
				<p></p>
				<div class="figrules" id="mv1_fig_convertpostocol"><span class="figcap">Figure 59. Examples for convertPosToCol()</span>
					<pre class="xmp"><code>&lt;message title="’Example of convertPosToCol()’"           value="’Cursor is at column ’+
				          $HMLPSUtil.convertPosToCol($HMLPSUtil.getCursorPos()$)$" /&gt;</code></pre>
				</div>
				<h5 id="wq311">convertPosToRow()</h5>
				<pre class="xmp"><code>public int <strong>convertPosToRow(int pos)</strong></code></pre>
				<p>This method returns the row number associated with the position in the presentation space.</p>
				<p></p>
				<div class="figrules" id="mv1_fig_convertpostorow"><span class="figcap">Figure 60. Examples for convertPosToRow()</span>
					<pre class="xmp"><code>&lt;message title="'Example of convertPosToRow()'"           value="'Cursor is at row '+
				          $HMLPSUtil.convertPosToRow($HMLPSUtil.getCursorPos()$)$" /&gt;</code></pre>
				    </div>
				<h5 id="wq312">enableRoundTrip()</h5>
				<pre class="xmp"><code>public void <strong>enableRoundTrip(boolean flag)</strong></code></pre>
				<p>This method is for bidirectional languages only (Arabic and Hebrew).Assume that <samp class="xph">A</samp>, <samp class="xph">B</samp>, and <samp class="xph">C</samp> are characters. Normally, when a string contains a series of characters followed by a series of numerals (for example, <samp class="xph">123</samp>), and the entire string is stored, the Host On-Demand exchanges the positions of the bidirectional characters and the numerals.For example, normally, if you read the string <samp class="xph">ABC 123</samp> the presentation space and store the string into a variable, and subsequently write the value of the variable back into the space, the Host On-Demand client writes <samp class="xph">123 ABC</samp> back the presentation space.</p>
				<p>To turn off this technique of forced reversal, call <samp class="xph">enableRoundTrip()</samp> a value of true. To restore this technique of forced reversal, call <samp class="xph">enableRoundTrip()</samp> a value of false.</p>
				<p></p>
				<div class="figrules" id="mv1_fig_enableroundtirp"><span class="figcap">Figure 61. Examples for enableRoundTrip()</span>
					<pre class="xmp"><code>&lt;perform  value="$HMLPSUtil.enableRoundTrip(true)$" /&gt;</code></pre>
				</div>
				<h5 id="wq313">getCursorCol()</h5>
				<pre class="xmp"><code>public int <strong>getCursorCol()</strong></code></pre>
				<p>This method returns the column location of the text cursor in presentation space.</p>
				<p></p>
				<div class="figrules" id="mv1_fig_getcursorcol"><span class="figcap">Figure 62. Examples for getCursorCol()</span>
					<pre class="xmp"><code>&lt;input value="$HMLSessionUtil.getHost()$"           row="$HMLPSUtil.getCursorRow()$"           col="$HMLPSUtil.getCursorCol()$+2"           movecursor="true" xlatehostkeys="true"           encrypted="false" /&gt;</code></pre>
				</div>
				<h5 id="wq314">getCursorPos()</h5>
				<pre class="xmp"><code>public int <strong>getCursorPos()</strong></code></pre>
				<p>This method returns the position of the text cursor in the space.</p>
				<p></p>
				<div class="figrules" id="mv1_fig_getcursorpos"><span class="figcap">Figure 63. Examples for getCursorPos()</span>
					<pre class="xmp"><code>&lt;message title="’Example of getCursorPos()’"           value="’Cursor is at row ’+
				          $HMLPSUtil.convertPosToRow($HMLPSUtil.getCursorPos()$)$+
				          ’ and column ’+
				          $HMLPSUtil.convertPosToCol($HMLPSUtil.getCursorPos()$)$" /&gt;</code></pre>
				</div>
				<h5 id="wq315">getCursorRow()</h5>
				<pre class="xmp"><code>public int <strong>getCursorRow()</strong></code></pre>
				<p>This method returns the row location of the text cursor in presentation space.</p>
				<p></p>
				<div class="figrules" id="mv1_fig_getcursorrow"><span class="figcap">Figure 64. Examples for getCursorRow()</span>
					<pre class="xmp"><code>&lt;input value="$HMLSessionUtil.getHost()$"           row="$HMLPSUtil.getCursorRow()$"           col="$HMLPSUtil.getCursorCol()$+2"           movecursor="true" xlatehostkeys="true"           encrypted="false" /&gt;</code></pre>
				</div>
				<h5 id="wq316">getSize()</h5>
				<pre class="xmp"><code>public int <strong>getSize()</strong></code></pre>
				<p>This method returns the size of the presentation space, that is, the number of character positions in the presentation space. For example, if the session window has 25 rows and 80 columns, then the size the presentation space is 24 * 80 = 1920.</p>
				<p></p>
				<div class="figrules" id="mv1_fig_getsize"><span class="figcap">Figure 65. Examples for getSize()</span>
					<pre class="xmp"><code>&lt;message title="’Example of getSize()’"           value="’Size of PS is ’+$HMLPSUtil.getSize()$" /&gt;</code></pre>
				</div>
				<h5 id="wq317">getSizeCols()</h5>
				<pre class="xmp"><code>public int <strong>getSizeCols()</strong></code></pre>
				<p>This method returns the number of columns in the presentation space.The presentation space has the same number of columns as the window. For example, if the session window has 25 rows and 80 columns, then the number of columns in the presentation space is 80.</p>
				<p></p>
				<div class="figrules" id="mv1_fig_getsizecols"><span class="figcap">Figure 66. Examples for getSizeCols()</span>
					<pre class="xmp"><code>&lt;message title="’Example of getSizeRows and getSizeCols()’"           value="’The PS has ’+$HMLPSUtil.getSizeRows()$+
        		  ’ rows and ’+
        		  $HMLPSUtil.getSizeCols()$+’ columns’" /&gt;</code></pre>
    			</div>
				<h5 id="wq318">getSizeRows()</h5>
				<pre class="xmp"><code>public int <strong>getSizeRows()</strong></code></pre>
				<p>This method returns the number of rows in the presentation space.The presentation space has one row less than the session window (the last line of the session window, which contains the Operator Area, is not included in the presentation space). For example, the session window has 25 rows and 80 columns, then the number rows in the presentation space is 24.</p>
				<p></p>
				<div class="figrules" id="mv1_fig_getsizerows"><span class="figcap">Figure 67. Examples for getSizeRows()</span>
					<pre class="xmp"><code>&lt;message title="’Example of getSizeRows and getSizeCols()’"           value="’The PS has ’+$HMLPSUtil.getSizeRows()$+
					          ’ rows and ’+
					          $HMLPSUtil.getSizeCols()$+’ columns’" /&gt;</code></pre>
				</div>
				<h5 id="wq319">getString()</h5>
				<pre class="xmp"><code>public String <strong>getString(int pos, int len)</strong></code></pre>
				<p>This method returns the text string beginning at the position in the presentation space and continuing for the number of characters.</p>
				<p></p>
				<div class="figrules" id="mv1_fig_getstring"><span class="figcap">Figure 68. Examples for getString()</span>
					<pre class="xmp"><code>&lt;message title="’Text of row 18:’"           value="’Text:’+$HMLPSUtil.getString(
					                    $HMLPSUtil.getSizeCols()$*17+1,                     $HMLPSUtil.getSizeCols()$)$" /&gt;</code></pre>
				</div>
				<h5 id="wq320">searchString()</h5>
				<pre class="xmp"><code>public int <strong>searchString(int pos, int len)</strong></code></pre>
				<p>This method returns the position in the presentation space of specified string. This method returns 0 if the string is not in the presentation space.</p>
				<p></p>
				<div class="figrules" id="mv1_fig_searchstring"><span class="figcap">Figure 69. Examples for searchString()</span>
					<pre class="xmp"><code>&lt;varupdate name="$int$" value="$HMLPSUtil.searchString('IBM')$" /&gt; &lt;message title="'Searching for IBM'"           value="'IBM is found at position '+$int$+
					          ' that is row='+
					          $HMLPSUtil.convertPosToRow($int$)$+
					          ', column='+
					          $HMLPSUtil.convertPosToCol($int$)$" /&gt;</code></pre>
				</div>
				<h3 id="wq321">$HMLSessionUtil$</h3>
				<p>The methods invoked with $HMLSessionUtil$ return values with the session. <button onclick="scrollHere('mv1_table_hmlsessionutil')">Table 29</button> these methods:</p>
				<table id="mv1_table_hmlsessionutil" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 29. Method summary for $HMLSessionUtil()$</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq322" colspan="2" align="left" valign="top">METHOD SUMMARY: $HMLSessionUtil$</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td width="15%" headers="wq322"><samp class="xph">String</samp></td>
							<td width="84%" headers="wq322">
								<dl>
									<dt class="bold"><samp class="xph">getHost()</samp></dt>
									<dd>Returns the text string specified in the <samp class="xph">Destination Address</samp> of the session configuration.</dd>
								</dl>
							</td>
						</tr>
						<tr>
							<td headers="wq322"><samp class="xph">String</samp></td>
							<td headers="wq322">
								<dl>
									<dt class="bold"><samp class="xph">getLabel()</samp></dt>
									<dd>Returns the string specified in the <samp class="xph">Session Name</samp> of the session </dd>
								</dl>
							</td>
						</tr>
						<tr>
							<td headers="wq322"><samp class="xph">String</samp></td>
							<td headers="wq322">
								<dl>
									<dt class="bold"><samp class="xph">getName()</samp></dt>
									<dd>Returns the session instance identifier assigned to the by the host.</dd>
								</dl>
							</td>
						</tr>
					</tbody>
				</table>
				<h4 id="wq323">Method details</h4>
				<h5 id="wq324">getHost()</h5>
				<pre class="xmp"><code>public String <strong>getHost()</strong></code></pre>
				<p>This method returns the host name or the host address that typed into the <samp class="xph">Destination Address</samp> field of the section of the session configuration (such as <samp class="xph">myhost.myloc.mycompany.com</samp> or <samp class="xph">9.27.63.45</samp>).</p>
				<p></p>
				<div class="figrules" id="mv1_fig_gethost"><span class="figcap">Figure 70. Examples for getHost()</span>
					<pre class="xmp"><code>&lt;message title="’Host name or address’" value="$HMLSessionUtil.getHost()$" /&gt;</code></pre>
				</div>
				<h5 id="wq325">getLabel()</h5>
				<pre class="xmp"><code>public String <strong>getLabel()</strong></code></pre>
				<p>This method returns the session name that you typed into the <samp class="xph">Name</samp> field of the Connection section of the session (a name such as <samp class="xph">3270 Display</samp> or <samp class="xph">5250 Display</samp>).</p>
				<p></p>
				<div class="figrules" id="mv1_fig_getlabel"><span class="figcap">Figure 71. Examples for getLabel()</span>
					<pre class="xmp"><code>&lt;message title="’Session name’" value="$HMLSessionUtil.getLabel()$" /&gt;</code></pre>
				</div>
				<h5 id="wq326">getName()</h5>
				<pre class="xmp"><code>public String <strong>getName()</strong></code></pre>
				<p>This method returns the identifying name that the host to the session (such as <samp class="xph">A</samp> , <samp class="xph">B</samp>, or <samp class="xph">C</samp>).When you start a session, the host assigns a name to the session distinguish it from other instances of the same session that be started.</p>
				<p></p>
				<div class="figrules" id="mv1_fig_getname"><span class="figcap">Figure 72. Examples for getName()</span>
					<pre class="xmp"><code>&lt;message title="’Session instance identifier’" value="$HMLSessionUtil.getName()$" /&gt;</code></pre>
				</div>
				<h3 id="mv1_hmlsqlutil">$HMLSQLUtil$</h3>
				<p>The methods invoked on $HMLSQLUtil$ return information about results of the most recent SQLQuery action. <button onclick="scrollHere('mv1_table_hmlsqlutil')">Table 30</button> summarizes these methods:</p>
				<table id="mv1_table_hmlsqlutil" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 30. Method summary for $HMLSessionUtil()$</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq327" colspan="2" align="left" valign="top">METHOD SUMMARY: $HMLSessionUtil$</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td width="15%" headers="wq327"><samp class="xph">int</samp></td>
							<td width="84%" headers="wq327">
								<dl>
									<dt class="bold"><samp class="xph">getColumnSize()</samp></dt>
									<dd>Returns the number of columns of data.</dd>
								</dl>
							</td>
						</tr>
						<tr>
							<td headers="wq327"><samp class="xph">String</samp></td>
							<td headers="wq327">
								<dl>
									<dt class="bold"><samp class="xph">getDataByIndex()</samp></dt>
									<dd>Returns the entry located at the specified row index and index.</dd>
								</dl>
							</td>
						</tr>
						<tr>
							<td headers="wq327"><samp class="xph">String</samp></td>
							<td headers="wq327">
								<dl>
									<dt class="bold"><samp class="xph">getDataByName()</samp></dt>
									<dd>Returns the entry located at the specified row index and name (field name).</dd>
								</dl>
							</td>
						</tr>
						<tr>
							<td headers="wq327"><samp class="xph">int</samp></td>
							<td headers="wq327">
								<dl>
									<dt class="bold"><samp class="xph">getRowSize()</samp></dt>
									<dd>Returns the number of rows of data.</dd>
								</dl>
							</td>
						</tr>
					</tbody>
				</table>
				<h4 id="wq328">Format of the stored data</h4>
				<p>The results of the SQLQuery action are stored as a two-array that is one column wider and one row taller than the size the block of data returned. Row 0 is used to store the names of columns (the field names from the database), and Column 0 is to store a zero-based index (see <button onclick="scrollHere('mv1_table_2dim_array')">Table 31</button> below).The entry at Row 0, Column 0 contains an empty string. The of the array contains the actual data. All values are strings.</p>
				<p><button onclick="scrollHere('mv1_table_2dim_array')">Table 31</button> shows as an example the of a query, a 3 x 5 block of data, stored in a 4 x 6 array:</p>
				<table id="mv1_table_2dim_array" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 31. Example of two-dimensional array containing results</caption>
					<tbody valign="top">
						<tr>
							<td width="12%">(empty string)</td>
							<td width="18%">TOPICID</td>
							<td width="16%">EXMPLID</td>
							<td width="53%">DESCRIPT</td>
						</tr>
						<tr>
							<td>0</td>
							<td>4</td>
							<td>18</td>
							<td>Create a toolbar with custom buttons.</td>
						</tr>
						<tr>
							<td>1</td>
							<td>9</td>
							<td>54</td>
							<td>Attach tables at startup.</td>
						</tr>
						<tr>
							<td>2</td>
							<td>11</td>
							<td>74</td>
							<td>Edit Products.</td>
						</tr>
						<tr>
							<td>3</td>
							<td>11</td>
							<td>75</td>
							<td>Enter or Edit Products</td>
						</tr>
						<tr>
							<td>4</td>
							<td>11</td>
							<td>76</td>
							<td>Find Customers</td>
						</tr>
					</tbody>
				</table>
				<p class="indatacontent">In the table above, the entry at Row 0, Column 0 an empty string. The remainder of Row 0 contains the field names the database (TOPICID, EXMPLID, DESCRIPT). The remainder of 0 contains index numbers for the rows (0, 1, 2, 3, 4). The data is contained in the remainder of the array. All values are strings.</p>
				<h4 id="wq329">Method details</h4>
				<h5 id="wq330">getColumnSize()</h5>
				<pre class="xmp"><code>public int <strong>getColumnSize()</strong></code></pre>
				<p>This method returns the actual number of columns of data in array, including the added Column 0. For example, for the array in <button onclick="scrollHere('mv1_table_2dim_array')">Table 31</button> this method returns 4.</p>
				<p></p>
				<div class="figrules" id="mv1_fig_getcolumnsize"><span class="figcap">Figure 73. Examples for getColumnSize()</span>
					<pre class="xmp"><code>&lt;message title="’Column size’" value="$HMLSessionUtil.getColumnSize()$" /&gt;</code></pre>
				</div>
				<h5 id="wq331">getDataByIndex()</h5>
				<pre class="xmp"><code>public int <strong>getDataByIndex(int row, int column)</strong></code></pre>
				<p>This method returns the entry at the specified row and column index.The following list shows the values returned for the data shown in <button onclick="scrollHere('mv1_table_2dim_array')">Table 31</button>:</p>
				<ul>
					<li>getDataByIndex(0,0) returns an empty string.</li>
					<li>getDataByIndex(0,1) returns the string 'TOPICID'.</li>
					<li>getDataByIndex(0,2) returns the string 'EXMPLID'.</li>
					<li>getDataByIndex(1,1) returns the string '4'.</li>
					<li>getDataByIndex(2,2) returns the string '54'.</li>
					<li>getDataByIndex(3,3) returns the string 'Edit Products'.</li>
				</ul>
				<p></p>
				<div class="figrules" id="mv1_fig_getdatabyindex"><span class="figcap">Figure 74. Examples for getDataByIndex()</span>
					<pre class="xmp"><code>&lt;message title="’Row 3, Column 3’" value="$HMLSessionUtil.getDataByIndex(3,3)$" /&gt;</code></pre>
				</div>
				<h5 id="wq332">getDataByName()</h5>
				<pre class="xmp"><code>public int <strong>getDataByName(int row, String fieldName)</strong></code></pre>
				<p>This method returns the entry at the specified row and field name.The following list shows the values returned for the data shown in <button onclick="scrollHere('mv1_table_2dim_array')">Table 31</button>:</p>
				<ul>
					<li>getDataByIndex(1, TOPICID) returns the string '4'.</li>
					<li>getDataByIndex(2, EXMPLID) returns the string '54'.</li>
					<li>getDataByIndex(3, DESCRIPT) returns the string 'Edit Products'.</li>
				</ul>
				<p></p>
				<div class="figrules" id="mv1_fig_getdatabyname"><span class="figcap">Figure 75. Examples for getDataByName()</span>
					<pre class="xmp"><code>&lt;message title="’Row 3, Field DESCRIPT’"    value="$HMLSessionUtil.getDataByName(3,'DESCRIPT')$" /&gt;</code></pre>
				</div>
				<h5 id="wq333">getRowSize()</h5>
				<pre class="xmp"><code>public int <strong>getRowSize()</strong></code></pre>
				<p>This method returns the actual number of rows of data in the array, including the added Row 0. For example, for the array in <button onclick="scrollHere('mv1_table_2dim_array')">Table 31</button> this method returns 6.</p>
				<p></p>
				<div class="figrules" id="mv1_fig_getrowsize"><span class="figcap">Figure 76. Examples for getRowSize()</span>
					<pre class="xmp"><code>&lt;message title="’Column size’" value="$HMLSessionUtil.getRowSize()$" /&gt;</code></pre>
				</div>
				<h3 id="wq334">$HMLSystemUtil$</h3>
				<p>The methods invoked with $HMLSystemUtil$ allow you to obtain about applet, Java properties and OS environments.</p>
				<p><button onclick="scrollHere('mv1_table_hmlsystemutil')">Table 32</button> summarizes these methods:</p>
				<table id="mv1_table_hmlsystemutil" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 32. Method summary for $HMLSystemUtil()$</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq335" colspan="2" align="left" valign="top">METHOD SUMMARY: $HMLSystemUtil$</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td width="15%" headers="wq335"><samp class="xph">String</samp></td>
							<td width="84%" headers="wq335">
								<dl>
									<dt class="bold"><samp class="xph">getHTMLParameter(String name)</samp></dt>
									<dd>Accepts an HTML Parameter name and returns its value.</dd>
								</dl>
							</td>
						</tr>
						<tr>
							<td headers="wq335"><samp class="xph">String</samp></td>
							<td headers="wq335">
								<dl>
									<dt class="bold"><samp class="xph">getenv(String name)</samp></dt>
									<dd>Accepts the Operating System's environment variable name returns its value.</dd>
								</dl>
							</td>
						</tr>
						<tr>
							<td headers="wq335"><samp class="xph">String</samp></td>
							<td headers="wq335">
								<dl>
									<dt class="bold"><samp class="xph">getSystemProperty(String name)</samp></dt>
									<dd>Accepts the Java System Property name and returns its value.</dd>
								</dl>
							</td>
						</tr>
					</tbody>
				</table>
				<h4 id="wq336">Method details</h4>
				<h5 id="sys_gethtml">getHTMLParameter()</h5>
				<pre class="xmp"><code>public String <strong>getHTMLParameter(String name)</strong></code></pre>
				<p>This method accepts the HTML Parameter name and returns its value.</p>
				<p>If a non-existing parameter name is given, the method returns empty string.</p>
				<p></p>
				<div class="figrules" id="sys_fig_gethtml"><span class="figcap">Figure 77. Examples for getHTMLParameter()</span>
					<pre class="xmp"><code>$HMLSystemUtil.getHTMLParameter('some_param_name')$</code></pre>
				</div>
				<h5 id="sys_getenv">getenv()</h5>
				<pre class="xmp"><code>public String <strong>getenv(String name)</strong></code></pre>
				<p>This method accepts the Operating System environment variable and returns its value.</p>
				<p>If a non-existing variable name is given, the method returns empty string.</p>
				<p></p>
				<div class="figrules" id="sys_fig_getenv"><span class="figcap">Figure 78. Examples for getenv()</span>
					<pre class="xmp"><code>$HMLSystemUtil.getenv('Temp')$</code></pre>
				</div>
				<h6 id="wq337">Limitations</h6>
				<ol type="1">
					<li> If you are using Java versions below 1.5.0, if there is an variable defined which has its value same as variable name, it return an empty string assuming that variable doesn't exist and returned itself.</li>
					<li>If you are using Java versions below 1.5.0, for non-Windows platform, it will always return an empty string.</li>
				</ol>
				<h5 id="sys_getsys">getSystemProperty()</h5>
				<pre class="xmp"><code>public String <strong>getSystemProperty(String name)</strong></code></pre>
				<p>This method accepts the Java System Property name and returns value.</p>
				<p>If a non-existing variable name is given, the method returns empty string.</p>
				<p></p>
				<div class="figrules" id="sys_fig_getsys"><span class="figcap">Figure 79. Examples for getSystemProperty()</span>
					<pre class="xmp"><code>$HMLSystemUtil.getSystemProperty('java.home')$</code></pre>
				</div>
				<h5 id="wq339">General Limitations</h5>
				<p>If you are using case-sensitive operating systems, the names as a parameter for these methods will be case-sensitive.</p>
				<h3 id="wq340">FormatNumberToString() and FormatStringToNumber()</h3>
				<p><samp class="xph">$FormatNumberToString()$</samp> is deprecated in favor of <samp class="xph">$HMLFormatUtil.numberToString()$</samp>.The former has the same input parameters and return type as the (see <button onclick="scrollHere('mv1_numbertostring')">numberToString()</button>).</p>
				<p><samp class="xph">$FormatStringToNumber()$</samp> is deprecated in favor of <samp class="xph">$HMLFormatUtil.stringToNumber()$</samp>.The former has the same input parameters and return type as the (see <button onclick="scrollHere('mv1_stringtonumber')">stringToNumber()</button>).</p>
			</div>
		</div>

		<button id="msec_more_about_security" class="accordian">Other security options</button>
		<div class="panel" style="display:none">
			<p>This chapter describes other security options.</p>

			<button id="msec_recordpassword" class="accordian">Record password</button>
			<div class="panel" style="display:none">
				<p>By default the Record Password option is enabled. You can disable Password in one of the following ways:</p>
				<ul>
					<li>In the Deployment Wizard, in the Disable Functions window, in the section, for the Record Password option, click Disabled; or</li>
					<li>In the Administration Utility, in the Disable Function window, in the Macro section, for the Record Password option, click Disabled.</li>
				</ul>
				<p>The Record Password option controls how Host On-Demand records an key sequence that the end user types into a 3270 or 5250 non-display field during macro recording. A non-display input field is a 3270 or field that does not display characters when you type into it. Typically non-display input field is used for entering confidential information as a password.</p>
				<p>Notice that the Record Password option:</p>
				<ul>
					<li>Affects only 3270 Display sessions and 5250 Display sessions.</li>
					<li>Comes into play only during macro recording (although it has effects show up during macro playback).</li>
					<li>Affects only input key sequences typed into 3270 and 5250 non-fields during macro recording.</li>
				</ul>
				<h3 id="msec_recordpassword_enabled">When Record Password is enabled</h3>
				<p>When Record Password is enabled (this is the default setting) and the user types characters into a 3270 or 5250 non-display input field during recording, Host On-Demand records the input key sequence as an Input and encrypts the input key sequence in the Input action using the option of the Input action.</p>
				<p>For example, suppose that Record Password is enabled, that you are a macro, and that you type a logon password (such as "MyPassword") into 3270 or 5250 non-display input field. Host On-Demand creates an Input action, encrypts the logon password, stores the encrypted password into the action, and writes the Input action into the macro script being recorded.</p>
				<p>Encrypting the input key sequence in the Input action provides a of security, because a casual unauthorized person cannot discover the key sequence by editing or viewing the recorded macro script. Host On-does not decrypt an encrypted input key sequence in an Input action Host On-Demand processes the Input action during macro playback. However, a clever foe who gains access to the macro script can still discover the key sequence by editing the Input action to direct the input key into a normal displayable field during macro playback (see <button onclick="scrollHere('ma_input_password')">Password</button>).</p>
				<p>The advantage of having the input key sequence recorded in an Input is that during macro playback the macro runs automatically without the having to intervene. However, if a required input sequence changes (for example, if a password expires and a different password must be used) then the action must be updated with the new input key sequence.</p>
				<h3 id="msec_recordpassword_disabled">When Record Password is disabled</h3>
				<p>When Record Password is disabled, and the end user types an input key into a 3270 or 5250 non-display input field during macro recording, Host On-discards the input key sequence and creates a Prompt action in the macro script instead of an Input action.  The Prompt action contains about the length of the input key sequence and the row and column on the screen where the input key sequence is to be directed, but does contain the input key sequence itself. Consequently, an unauthorized viewing, editing, or even running the macro script cannot discover the key sequence.</p>
				<p>During macro playback, when Host On-Demand processes the Prompt action, it pops up a prompting window containing an input field and a message that the end user should type some input. (The default message is <samp class="xph">Password</samp>, but after macro recording is complete you can edit the Prompt to specify a different message.) When the end user types an input key into the input field of the prompting window and clicks OK, then Host On-closes the prompting window and types the same input key sequence into 3270 or 5250 non-display field in the session window at the specified and column location.</p>
				<p>Thus, disabling Record Password provides greater security than it, because when Record Password is disabled the input key sequence is stored in the macro script, not even in encrypted form. Instead, the end provides the input key sequence during macro playback, when Host On-processes the Prompt action.</p>
				<p>When Host On-Demand creates the Prompt action during macro recording, turns on the Password Response option in the Prompt action. This option Host On-Demand, during macro playback, to use asterisks (<samp class="xph">*</samp>) display the characters that appear in the input field of the prompting when the user types the input key sequence (see <button onclick="scrollHere('ma_prompt_password_response')">Password Response</button>).</p>
			</div>
		</div>
		
		<button id="ms_features" class="accordian">Other advanced features</button>
		<div class="panel" style="display:none">
			<p>This chapter describes other advanced features.</p>
			<button id="ms_multisession"></button>

			<button id="wq341" class="accordian">Interacting with more than one session</button>
			<div class="panel" style="display:none">
				<p>Starting with Host On-Demand Version 9.0, a macro can interact with emulation sessions other than the display emulation session that the macro.</p>
				<p>This feature makes it easier and quicker for you to pass data between host applications, or to pass data from two or more host applications to single workstation application. For example:</p>
				<ul>
					<li>A macro can collect data from an application in a 3270 Display session, use the data to interact with an application in a 5250 Display session, then return to working with the 3270 Display session.</li>
					<li>A macro can collect data from a VT Display session and a 3270 session and then launch a workstation application to process both sets data.</li>
				</ul>
				<p>Before this feature was available, you could do tasks similar to these, but not as easily nor with as much automation. You needed a separate for each host session, you had to manually launch each macro, and you to manually synchronize the macros, waiting for one macro to complete a product before you launched a macro that depended on that work product.</p>
				<h3 id="wq342">Basics</h3>
				<p>A macro that interacts with more than one session can be stored in of the locations that an ordinary macro can be stored.</p>
				<p>A macro that interacts with more than one session is launched by a session, just as an ordinary macro is launched. However, all the that the macro interacts with must be active (connected) before the is launched (see <button onclick="scrollHere('ms_runtime_requirements')">Run-time requirements</button>).</p>
				<p>The various sessions that the macro interacts with can be of types (3270 Display, 5250 Display, VT Display, or CICS Gateway) or all the same type, and can be connected to different hosts or to the same host.</p>
				<p>There is no limit to how many active sessions a single macro can with, so long as:</p>
				<ul>
					<li>Either all the sessions are launched from the desktop of a single On-Demand client, or else all the sessions are launched from the same JVM; and</li>
					<li>The memory of the Java Virtual Machine that is used to launch the On-Demand client is not exhausted.</li>
				</ul>
				<h3 id="ms_implementation">Implementation</h3>
				<p>A Host ID field has been added to the macro descriptors and macro that support this feature. The value in the Host ID field identifies the session to which the descriptor or action applies (see <button onclick="scrollHere('ms_hostid')">Specifying a Host ID</button>).</p>
				<p>During macro playback, when the macro runtime prepares to evaluate a or to perform an action, the macro runtime looks in the Host ID field of descriptor or the action. If the Host ID field is missing, or blank, the macro runtime applies the descriptor or the action to the original session, the session that launched the macro (for example, a 3270 Display session).But if the Host ID field is specified and non-blank, then the macro runtime:</p>
				<ol type="1">
					<li>Locates the active session to which the Host ID field refers (for example, a second 3270 Display session connected to a different host).</li>
					<li>Applies the descriptor or action to the session window of that session.</li>
				</ol>
				<p>The following descriptors support this feature:</p>
				<ul>
					<li>Wait for OIA to Become Uninhibited</li>
					<li>Number of Fields</li>
					<li>Number of Input Fields</li>
					<li>String</li>
					<li>Cursor</li>
					<li>Attribute</li>
				</ul>
				<p class="indatacontent">That is, you can use any of these descriptors to refer to an active emulation session other than the original session that launched the macro.The remaining descriptors (Condition, Custom) and the Variable update do not refer to a particular session window and therefore do not support feature. With the first three descriptors in the list above, there is a with how many descriptors are <em>displayed</em> in the Editor (see <button onclick="scrollHere('ms_diff_sn_same_macro_screen')">Referring to different sessions in the same macro screen</button>).</p>
				<p>The following macro actions support this feature:</p>
				<ul>
					<li>Box selection</li>
					<li>Comm wait</li>
					<li>Extract</li>
					<li>Input</li>
					<li>Mouse click</li>
					<li>Print Extract</li>
					<li>Prompt</li>
					<li>Xfer</li>
				</ul>
				<p class="indatacontent">You can apply any of these actions to an active display emulation other than the original session that launched the macro. The remaining (Conditional, File Upload, and so on) do not act upon a particular window and therefore do not support this feature.</p>
				<h3 id="ms_two_techniques">Two techniques for building macro screens</h3>
				<p>When you build a macro screen that refers to a session other than the session that launches the macro, there are at least two techniques that can use.</p>
				<p>The first technique is to make each macro screen refer to one and one active session. That is, all the descriptors and all the actions any one macro screen should refer to the same active session. This allows you great flexibility and makes it simple to write, debug, and your macro screens.</p>
				<p>For example, the first 10 macro screens of your macro could interact the original session, the next 8 macro screens could interact with a session, and the final 4 macro screens could interact with the original again.</p>
				<p>The Macro object uses this first technique in storing recorded when you record a macro that interacts with more than one active session.Whenever you switch from one active session to another, the Macro object and stores the current macro screen and then creates a new macro screen hold the descriptors and actions for the first application screen of the selected session (see <button onclick="scrollHere('ms_record_technique01')">One recorded macro screen refers to one session window</button>).</p>
				<p>Therefore, when you record a macro that refers to more than one session, the Macro object builds the macro using the first technique.</p>
				<p>The second technique is to allow a macro screen to refer to more than active session. Either the descriptors refer to two or more active sessions, or the actions do, or both. If the descriptors refer to two or more sessions, then the macro runtime evaluates each descriptor with to the session window of the specified session. If the actions refer to or more active sessions, then the macro runtime executes each action the session window of the specified session.</p>
				<p>The second technique requires users to edit the macro, with either Macro Editor or the Code Editor, to add references to more than one within one macro screen (see <button onclick="scrollHere('ms_diff_sn_same_macro_screen')">Referring to different sessions in the same macro screen</button>).</p>
				<p>This second technique is more flexible than the first technique and some situations can be necessary. However, this second technique usually it somewhat more complicated to write, debug, and maintain your macro screens.</p>
				<h3 id="wq344">Runtime processing</h3>
				<p>For clarity, this section describes in more detail the processing of and actions for multiple sessions during macro playback.</p>
				<h4 id="wq345">Descriptors</h4>
				<p>When the macro runtime plays back a macro that refers to more than session, the macro runtime processes descriptors exactly as it does with ordinary macro. However, if a descriptor applies to an active session than the original session that launched the macro, then the macro evaluates the descriptor as true or false with respect to the session of that active session. There are two main cases, which are described in two following subsections.</p>
				<h5 id="wq346">All descriptors apply to the same active session</h5>
				<p>Suppose that a macro was launched by a 3270 Display session, that the runtime has just finished processing a macro screen that refers to this Display session, and that the macro runtime is now trying to recognize next macro screen to be processed. Suppose also that the macro runtime examining as a candidate a macro screen named Screen26, and that contains the following descriptors, each of which applies to the same 5250 Display session:</p>
				<ul>
					<li>A Number of Fields descriptor;</li>
					<li>A Number of Input Fields descriptor;</li>
					<li>A Wait for OIA to Become Uninhibited descriptor.</li>
				</ul>
				<p>Assuming that all three descriptors are required descriptors and that is an inverse descriptor, then the macro runtime determines that is the next macro screen to be processed, if each descriptor evaluates true with respect to the session window of the 5250 Display session. For example, suppose that the values of the descriptors are 4, 53, and NOTINHIBITED. the session window of the 5250 Display session contains 4 input fields, 53 fields of all types, and has the input inhibited indicator cleared, the macro runtime determines that Screen26 is the next macro screen to processed.</p>
				<p>The above processing is exactly the same as the processing for an macro screen, except that all the descriptors apply to a session window than the session window of the session that launched the macro.</p>
				<h5 id="wq347">Some descriptors apply to a different active session</h5>
				<p>Again, suppose that a macro was launched by a 3270 Display session, the macro runtime has just finished processing a macro screen that to this 3270 Display session, and that the macro runtime is now trying recognize the next macro screen to be processed. Suppose also that the runtime is examining as a candidate a macro screen named Screen32, and Screen32 contains 6 descriptors:</p>
				<ul>
					<li>A Number of Fields descriptor, a Number of Input Fields descriptor, a Wait for OIA to Become Uninhibited descriptor, all of which apply to original 3270 Display session;</li>
					<li>A Number of Fields descriptor, a Number of Input Fields descriptor, a Wait for OIA to Become Uninhibited descriptor, all of which apply to 5250 Display session.</li>
				</ul>
				<p>Assuming that all the descriptors are required descriptors and that is an inverse descriptor, then the macro runtime determines that is the next macro screen to be processed if: </p>
				<ul>
					<li>The first three descriptors evaluate to true with respect to the Display session window; and</li>
					<li>The second three descriptors evaluate to true with respect to the Display session window.</li>
				</ul>
				<p>In this example the process of evaluating individual descriptors is the same as in an ordinary macro, except that the macro runtime the descriptors with respect to two different active session windows.</p>
				<p>After evaluating each descriptor as true or false with respect to a session window, the macro runtime then combines the boolean results of individual descriptors in the usual way (see <button onclick="scrollHere('md1_evaluation_of_descriptors')">Evaluation of descriptors</button>).</p>
				<h4 id="wq348">Actions</h4>
				<p>When the macro runtime plays back a macro that refers to more than session, the macro runtime processes actions exactly as it does with an macro. However, if an action contains a Host ID that refers to an active other than the original session that launched the macro, then the macro executes the action with respect to the session window of that active session.</p>
				<p>As with descriptors, a single macro screen can contain actions all of apply to the same session, or actions that apply to two or more sessions. For example, if a macro screen contains one Input action for original session that launched the macro (such as a 3270 Display session) and a second Input action for another session (such as a 5250 Display session), then the macro runtime:</p>
				<ol type="1">
					<li>Types the input key sequence from the first Input action into the row and column location of the original session window (the session of the 3270 Display session).</li>
					<li>Types the input key sequence from the second Input action into the row and column location of the second session window (the session window the 5250 Display session).</li>
				</ol>
				<h3 id="ms_runtime_requirements">Run-time requirements</h3>
				<p>When an end user runs a macro that interacts with more than one session, the macro runtime has two requirements:</p>
				<ul>
					<li>Each session that the macro interacts with has to be started and connected, before the end user launches the macro.</li>
					<li>Each session that the macro interacts with has to be positioned at first application screen expected by the macro.</li>
				</ul>
				<p>For the first requirement, whenever the end user launches a macro, macro runtime, as part of the preparations for running the macro, scans entire macro script for Host ID fields and compiles a list of sessions the macro accesses. The macro runtime then verifies that each session in list is started and connected. If one of the sessions is not started and connected, then the macro runtime displays an error message and terminates the playback.</p>
				<p>The second requirement is just an extension of the ordinary that the end user position the session that launches the macro at the screen expected by the first macro screen of the macro. Just as the macro screen of an ordinary macro expects to find the session window at a particular application screen, so the first macro screen that with a session other than the original session expects to find the window of that session positioned at a particular application screen.</p>
				<h3 id="ms_hostid">Specifying a Host ID</h3>
				<p>In the Macro Editor, a Host ID input field is displayed in the window of each descriptor or action that can refer to a session other the original session that launches the macro (see the lists of and actions in <button onclick="scrollHere('ms_implementation')">Implementation</button>). In the Code Editor, the <strong>hostid</strong> attribute is valid in the corresponding XML elements.</p>
				<p>A Host ID consists of:</p>
				<ol type="1">
					<li>A session ID (such as <samp class="xph">A</samp>), followed by</li>
					<li>A colon (<samp class="xph">:</samp>), followed by</li>
					<li>A session name (such as <samp class="xph">3270 Display)</samp>.</li>
				</ol>
				<p class="indatacontent">Examples: <samp class="xph">B:3270 Display</samp>, <samp class="xph">C:5250 Display</samp>.</p>
				<p>IBM recommends that you specify, in the session properties of each that a macro refers to other than the original session, a particular ID (a letter between <samp class="xph">A </samp>and <samp class="xph">Z</samp>) for the session, than letting the Host On-Demand client assign the session ID when the end user launches the session. To specify a particular session for a session:</p>
				<ol type="1">
					<li>Open the session properties window.</li>
					<li>In the left pane, click Start Options.</li>
					<li>In the right pane, in the Session ID listbox, change the value from <samp class="xph">Automatic</samp> to the value that you want to use (<samp class="xph">A-Z</samp>).</li>
				</ol>
				<p>If, instead, you let the Host On-Demand client assign the session ID automatically, then the session ID can be different (for example, <samp class="xph">C</samp>) than session ID that you use in the macro script (such as <samp class="xph">B</samp>), and so then the Host ID value is also different (<samp class="xph">C:3270 Display</samp> of <samp class="xph">B:3270 Display</samp>). Consequently, when the end user launches macro, the macro runtime can terminate the macro playback with an error the macro contains a reference (<samp class="xph">B:3270 Display</samp>) to a session is not active and connected.</p>
				<p>To change the session name component of the Host ID (for example, to change <samp class="xph">3270 Display </samp>to <samp class="xph">SessionApp1</samp>:</p>
				<ol type="1">
					<li>Open the session properties window.</li>
					<li>In the left pane, click Connection.</li>
					<li>In the right pane, in the Session Name field, type the session name you want to use.</li>
				</ol>
				<h4 id="ms_auto_edit">Using automatic editing features with other sessions</h4>
				<p>In the Macro Editor, after you have typed a session reference into Host ID field of the editing window of a descriptor, then if the session to by the Host ID is active, and if the descriptor has a Current button, you can use the Current button to gather data automatically from the window of the session that the Host ID refers to.</p>
				<p>However, you cannot use the marking rectangle in the same way. That is, you cannot use the marking window to gather editing information from any window except the session window belonging to the session from which you the Macro Editor.</p>
				<h3 id="ms_recording">Recording a macro that interacts with more than one session</h3>
				<p>This section describes issues involved in recording a macro that with more than one session. Each of the following subsections deals with issue.</p>
				<h4 id="wq353">Storing the macro script</h4>
				<p>As with an ordinary macro, the Macro object creates the macro script the recorded macro in the selected location.</p>
				<p>As you switch between different active sessions during the recording process, the Macro object continues to store the recorded information into the location that you originally selected.</p>
				<h4 id="ms_record_technique01">One recorded macro screen refers to one session window</h4>
				<p>Whenever you switch from one active session to another active session the recording process, the Macro object:</p>
				<ol type="1">
					<li>Completes and stores the current macro screen.</li>
					<li>Creates a new macro screen containing the default recorded (Wait for OIA to Become Uninhibited, Number of Fields, and Number of Fields).</li>
					<li>Waits to see what actions you add to the new macro screen from the selected session.</li>
				</ol>
				<p>Thus the Macro object uses the first of the two techniques described for building macro screens, the technique of making all the descriptors all the actions within any one macro screen refer to the same active (see <button onclick="scrollHere('ms_two_techniques')">Two techniques for building macro screens</button>).</p>
				<h4 id="wq355">Starting, stopping, and switching sessions</h4>
				<p>Start recording as usual, by clicking the Record macro icon on the Manager toolbar. You should start recording in the same session from you plan to launch the macro when it is completed.</p>
				<p>To switch to another session, click the Append recording icon on the Manager toolbar of the session from which you want to record. To switch to the original session, click the Append recording icon on the Macro toolbar of the original session.</p>
				<p>To stop recording at any time, click the Stop recording icon on the Manager toolbar of the same session from which you originally started recording. For example, if you start recording from a 3270 Display session, and you later continue recording from two other active 3270 Display sessions, then you must stop recording by clicking the Stop recording icon on the 3270 Display session.</p>
				<p><button onclick="scrollHere('ms_table_start_stop')">Table 33</button> summarizes this information about starting, switching sessions, and stopping.</p>
				<table id="ms_table_start_stop" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 33. Starting, switching sessions, and stopping</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq356" align="left" valign="top">Function:</th>
							<th id="wq357" align="left" valign="top">The icon to click:</th>
							<th id="wq358" align="left" valign="top">The session in which the icon is located:</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td headers="wq356">Start recording</td>
							<td headers="wq357">Start recording</td>
							<td headers="wq358">The session from which you plan to run the macro.</td>
						</tr>
						<tr>
							<td headers="wq356">Switch to any active session (including the session)</td>
							<td headers="wq357">Append recording</td>
							<td headers="wq358">The session that you want to switch to.</td>
						</tr>
						<tr>
							<td headers="wq356">Stop recording</td>
							<td headers="wq357">Stop recording</td>
							<td headers="wq358">The session from which you started recording.</td>
						</tr>
					</tbody>
				</table>
				<h4 id="wq359">The currently selected session</h4>
				<p>The currently selected session is either:</p>
				<ul>
					<li>The original session in which you started recording (if you have not clicked the Append recording icon in any session); or</li>
					<li>The session in which you last clicked the Append recording icon.</li>
				</ul>
				<p class="indatacontent">(In the second alternative, the currently selected session can be original session, if you have switched to another session and then have back to the original session).</p>
				<p>In the currently selected session, the Append recording icon is disabled, to indicate that the session is the current source of recorded material.</p>
				<p>In the currently selected session, the following Macro Manager icons active: Pause recording, Add a Prompt, Add a Smart Wait, and Add an Extraction.Use these icons as you would normally to pause recording or to add an element.</p>
				<p>If the currently selected session is the original session in which started recording:</p>
				<ul>
					<li>The Record macro icon is disabled, because you have started a macro from that session.</li>
					<li>The Stop recording icon is enabled, because it is always available the original session to stop the recording.</li>
				</ul>
				<p>In contrast, if the currently selected session is not the original from which you started the recording:</p>
				<ul>
					<li>The Record macro button is disabled, to prevent you from starting to a new macro from the currently selected session while the currently session is being used to record material for another macro.</li>
					<li>The Stop recording button is disabled, because only the Stop button in the original session can stop the recording that began in the session.</li>
				</ul>
				<p><button onclick="scrollHere('ms_table_currently_selected')">Table 34</button> summarizes this information:</p>
				<table id="ms_table_currently_selected" width="100%" summary="" border="1" frame="border" rules="all">
					<caption>Table 34. Macro Manager icons in the currently selected session</caption>
					<thead valign="bottom">
						<tr>
							<th id="wq360" align="left" valign="top">Macro Manager icon in the currently session:</th>
							<th id="wq361" align="left" valign="top">State:</th>
						</tr>
					</thead>
					<tbody valign="top">
						<tr>
							<td headers="wq360">Append recording</td>
							<td headers="wq361">Disabled</td>
						</tr>
						<tr>
							<td headers="wq360">
								<ul>
									<li>Pause</li>
									<li>Add a Prompt</li>
									<li>Add a Smart Wait</li>
									<li>Add an Extraction</li>
								</ul>
							</td>
							<td headers="wq361">Enabled</td>
						</tr>
						<tr>
							<td headers="wq360">Record</td>
							<td headers="wq361">
								<ul>
									<li>If the currently selected session is the original session: Disabled</li>
									<li>If the currently selected session is not the original session: Disabled</li>
								</ul>
							</td>
						</tr>
						<tr>
							<td headers="wq360">Stop</td>
							<td headers="wq361">
								<ul>
									<li>If the currently selected session is the original session: Enabled</li>
									<li>If the currently selected session is not the original session: Disabled</li>
								</ul>
							</td>
						</tr>
					</tbody>
				</table>
				<h4 id="wq362">Other active sessions</h4>
				<p>If a session is not the currently selected session, and if it is also the original session from which you started recording the macro, then the icons on the Macro Manager toolbar are in their normal state and can used normally.</p>
				<p>For example, you can start recording a new macro by clicking the macro icon, even though you are currently recording another macro that started in another session.</p>
				<h4 id="wq363">More than one active recording</h4>
				<p>Very occasionally, you may want or need to record more than one macro the same time. If so, then you must start each macro in a separate session. (The Macro Manager enforces this rule by making the "Record a macro" icon active and not selectable when you click it, until you click Stop recording.) Each macro is recorded separately and individually, and the recordings not interfere with one another.</p>
				<p>However, suppose that the following situation occurs:</p>
				<ul>
					<li>You are recording a macro that you started in SessionA.</li>
					<li>You are recording another macro that you started in SessionB.</li>
					<li>SessionC is active but is not involved in any recording activity.</li>
					<li>You want to record material from SessionC into the macro that you in SessionA.</li>
				</ul>
				<p class="indatacontent">To switch to SessionC as the source of recorded material, click the recording icon in SessionC.</p>
				<p>In this situation, the Macro object does not know whether you wish recorded material from SessionC to be added to the macro that you recording in SessionA or to the macro that you started recording in SessionB.Therefore, when you click the Append recording icon in SessionC, the object immediately displays a window listing the sessions in which you launched a recording (SessionA and SessionB) and asking you to select session to which you want to add the recorded material from SessionC.</p>
				<p>Also, while you are using SessionC to record information for SessionA, you cannot use SessionC to record information for SessionB.</p>
				<h3 id="ms_diff_sn_same_macro_screen">Referring to different sessions in the same macro screen</h3>
				<p>When you want to use the second technique described earlier for macro screens (see <button onclick="scrollHere('ms_two_techniques')">Two techniques for building macro screens</button>), the technique of to more than one session in the descriptors or in the actions of the macro screen, you must use the Macro Editor or the Code Editor to add the references to additional session or sessions.</p>
				<p>For example, if you have recorded a macro screen that interacts with 3270 Display session, and you want to add to that macro screen to a 5250 Display session, then you must open the macro script with the Editor or the Code Editor and then manually add the appropriate or actions to the 5250 Display session.</p>
				<p>With the following three descriptors, there is a limitation in how descriptors the Macro Editor can display in the editing window:</p>
				<ul>
					<li>Wait for OIA to Become Uninhibited</li>
					<li>Number of Fields</li>
					<li>Number of Input Fields</li>
				</ul>
				<p class="indatacontent">You might recall that these three descriptors are represented in Macro Editor by a single descriptor, the Field Counts and OIA descriptor, and that in an ordinary macro only one Field Counts and OIA descriptor allowed per macro screen (see <button onclick="scrollHere('md1_fieldcounts_and_oia')">Field Counts and OIA descriptor</button>). of this state of affairs in ordinary macros, the Macro Editor is of displaying multiple Field Counts and OIA descriptors, even if each refers to a different session. Therefore, if your macro screen contains than one Field Counts and OIA descriptor, the Macro Editor displays only first one. However, you can see all the descriptors by viewing the macro with the Code Editor.</p>
				<p>If you are using the Macro Editor, then use can use the Current in descriptors to gather data from sessions other than the session from the Macro Editor was launched (see <button onclick="scrollHere('ms_auto_edit')">Using automatic editing features with other sessions</button>).</p>
				<h3 id="wq364">Disabling macro recording</h3>
				<p>The Macro window of the Disable Functions does not have a separate for enabling or disabling the recording of a macro that interacts with than one session. Instead, this function is considered part of the Macro option.</p>
			</div>
		</div>

		<button id="mg_the_gui" class="accordian">The graphical user interface</button>
		<div class="panel" style="display:none">

			<button id="wq365" class="accordian">Updating fields in the Macro Editor</button>
			<div class="panel" style="display:none">
				<h3 id="mg_using_session_window">Using the session window</h3>
				<p>Even though the Macro Editor window appears on top of the session window, you can still use the session window.</p>
				<p>Drag the Macro Editor window to one side of the screen so that you see the area on the session window that you want to work with. Then on the session window to make it the current window. (The Macro Editor still overlap part of the session window.)</p>
				<h3 id="mg_bounding_rectangle">Using the marking rectangle</h3>
				<p>There are several situations in which you can use the marking to mark an area of the session window, including:</p>
				<ul>
					<li>Marking a rectangular block of text for a String descriptor.</li>
					<li>Marking the area to be captured by an Extract action.</li>
					<li>Marking the area to be marked by a Box selection action.</li>
					<li>Marking the area to be printed by a Print Extract action.</li>
				</ul>
				<p>To mark an area with the marking rectangle, follow these steps:</p>
				<ol type="1">
					<li>Drag the Macro Editor window to one side of the screen so that you see the area on the session window that you want to work with. Then on the session window.</li>
					<li>Click the mouse on one corner of the area of the session window that want to mark. You should see the text cursor jump to that row and column position.</li>
					<li>Hold down the left mouse button and move the mouse. You should see a marking rectangle that changes shape as you move the mouse.</li>
					<li>Adjust the marking rectangle to surround the area of text that you to capture, then release the left mouse button.</li>
					<li> The yellow marking rectangle snaps into place at the nearest row and column boundaries.</li>
					<li>The yellow marking rectangle remains visible until you click again the session window.</li>
					<li>If you want to mark a different area, start over with step 2 above.</li>
				</ol>
				<h3 id="mg_using_text_cursor">Using the session window's text cursor</h3>
				<p>Some actions and descriptors require you to enter a pair of row and coordinates. Some examples are:</p>
				<ul>
					<li>The Row and Column input fields of the Extract action.</li>
				</ul>
				<p>To determine a row and column location on the session window using text cursor:</p>
				<ol type="1">
					<li>Drag the Macro Editor window to one side of the screen so that you see the area on the session window that you want to work with. Then on the session window to make it the current window. (The Macro Editor still overlap part of the session window.)</li>
					<li>Use the arrow keys to move the text cursor to the row and column that you are interested in.</li>
					<li>The row and column numbers are displayed in the lower right hand of the session window, in the format row/column (for example, 04/17).</li>
					<li>Click the Macro Editor window to make it the current window.</li>
					<li>Enter the row value (such as 4) in the Row input field and the value (such as 17) in the Column input field.</li>
				</ol>
				<h3 id="mg_string_error">Error in specifying a string</h3>
				<p>In input fields that require a string, you must specify the string in manner required by the format that you have selected for the macro, the basic macro format or the advanced macro format (see <button onclick="scrollHere('me_representing_strings')">Representation of strings and special characters, treatment of characters</button>).</p>
				<p>For example, if you have selected the advanced macro format, but you a string that is not surrounded with single quotes (such as <samp class="xph">parameters</samp>), then the Macro Editiro will display an error message the following:</p>
				<pre class="xmp"><code>String -- Invalid expression -- Resetting to previous value.</code></pre>
				<p class="indatacontent">To avoid getting this error message, specify the string surrounded single quotes (such as <samp class="xph">'Terminal parameters'</samp>).</p>
				<p>In contrast, if you have selected the basic macro format, but you a string that is surrounded with single quotes, then you will not get an message, but the Macro Editor will treat the single quotes as part of string.</p>
			</div>

			<button id="mg_code_editor" class="accordian">Using the Code Editor</button>
			<div class="panel" style="display:none">
				<h3 id="mg_ce_copypaste">Copy and paste a script from this guide into the Code Editor</h3>
				<p>This section tells you how to copy a macro script from this document the Code Editor. This text assumes that you are copying an entire macro script, beginning with &lt;HAScript&gt; and ending with &lt;/HAScript&gt;. Follow steps.</p>
				<ol type="1">
					<li>Start a 3270 Display session and let it connect.</li>
					<li>Record a simple macro to use as a holder for the script: 
						<ol type="a">
							<li>Click Record Macro</li>
							<li>When the Record Macro window appears: 
								<ol type="i">
									<li>Copy and paste a script from this guide into the Code Editor.</li>
									<li>Click New</li>
									<li>Type a name in the Name field, such as <samp class="xph">sample1</samp>.</li>
									<li>Click OK</li>
								</ol>
							</li>
							<li>The status line on the 3270 Display session window should say, "macro".</li>
							<li>Click Stop playing or recording macro.</li>
						</ol>
					</li>
					<li>Edit the macro script that you just recorded.
						<ol type="a">
							<li>The name of the file for the macro that you just recorded should in the window on the left side of the Macro Manager toolbar, such as <samp class="xph">sample1.mac</samp>.</li>
							<li>Click Edit current macro properties to start the Macro Editor.</li>
							<li>When the Macro Editor appears then follow these steps: 
								<ol type="i">
									<li>Click Code Editor to start the Code Editor.</li>
									<li>Use the mouse to mark the lines of code that you want to delete.
										<ol type="1">
											<li>Which lines to mark for deletion delete depends on the contents of text that you want to paste into the Code Editor.</li>
											<li>However, this example assumes that you want to paste a complete script into the Code Editor.</li>
											<li>Therefore, in this example you should use the mouse to mark all the in the Code Editor for deletion.</li>
										</ol>
									</li>
									<li>Type the Delete key to delete the marked area.</li>
									<li>Copy the entire text of a macro script from this document to the clipboard, using whichever method you are accustomed to.</li>
									<li>Make the Code Editor the active window.</li>
									<li>Use Ctrl-v to paste the macro script into the Code Editor</li>
									<li>Click OK to close the Code Editor.</li>
								</ol>
							</li>
							<li>Click Save and Exit save the macro script and close the Macro Editor</li>
						</ol>
					</li>
					<li>The name of the file for the macro that you just edited should in the window on the left side of the Macro Manager toolbar, such as <samp class="xph">sample1.mac</samp>.</li>
					<li>Click Play Macro to run the macro.</li>
				</ol>
				<p>If you wish to edit this macro, then you can do so either with the Editor or the Code Editor.</p>
			</div>
		</div>
	
	
		<h1 id="part_langref">The macro language</h1>
			
		<button id="wq374" class="accordian">Features of the macro language</button>
		<div class="panel" style="display:none">

			<button id="wq375" class="accordian">Use of XML</button>
			<div class="panel" style="display:none">
				<h3 id="ml1_macro_syntax">XML syntax in the Host On-Demand macro language</h3>
				<p>A Host On-Demand macro is stored in an XML script using the XML of the Host On-Demand macro language. This section describes some of the of XML and gives examples from the Host On-Demand macro language:</p>
				<ul>
					<li>XML code is made up of elements. The Host On-Demand macro language about 35 XML elements.</li>
					<li>Element names in the macro language are not case-sensitive, except the sense that you must write an element in the same combination of and lower case in both the begin tag and the end tag. All of the are correct  (the ellipsis "..." is not part of the XML text but is to indicate that the element contains other elements): <pre class="xmp"><code>&lt;screen&gt;   ...      &lt;/screen&gt; &lt;Screen&gt;   ...      &lt;/Screen&gt; &lt;scrEen&gt;   ...      &lt;/scrEen&gt;</code></pre>However, customarily the master is spelled <samp class="xph">HAScript</samp> and the other elements are spelled with lower case.</li>
					<li>Each XML element has a begin tag and an end tag, as shown in the below from the Host On-Demand macro language.: <pre class="xmp"><code>&lt;HAScript&gt; ... &lt;/HAScript&gt; &lt;import&gt; ... &lt;/import&gt; &lt;vars&gt; ... &lt;/vars&gt; &lt;screen&gt; ... &lt;/screen&gt; </code></pre>
					</li>
					<li>Optionally you can combine the begin tag and end tag of an XML into one tag. This option is useful when the XML element includes but not other elements. For example, <pre class="xmp"><code>&lt;oia ... /&gt; &lt;numfields ...  /&gt;</code></pre>
					</li>
					<li>An element can contain attributes of the form <em>attribute_name="attribute_value"</em>. For example: <pre class="xmp"><code>&lt;oia status="NOTINHIBITED" optional="false" invertmatch="false"/&gt; &lt;numfields number="80" optional="false" invertmatch="false"/&gt; </code></pre>You can use a pair of empty double quote characters (that is, two quote characters with nothing in between) to specify that the attribute not set to a value.<pre class="xmp"><code>&lt;HAScript name="ispf_ex1" description="" timeout="60000" ... author="" ...&gt;    ...&lt;/HAScript&gt;</code></pre>
					</li>
					<li>An element can include other entire elements between its begin tag end tag, in much the same way that HTML does. In the example below a &lt;description&gt; element contains two elements: an &lt;oia&gt; element and a &lt;numfields&gt; element.<pre class="xmp"><code>&lt;description&gt;    &lt;oia status="NOTINHIBITED" optional="false" invertmatch="false"&gt;    &lt;numfields number="80" optional="false" invertmatch="false"/&gt; &lt;/description&gt;</code></pre>
					</li>
				</ul>
				<h3 id="wq376">Code Editor</h3>
				<p>You can edit the XML text of a macro script directly with the Code (see <button onclick="scrollHere('mc1_code_editor')">Code Editor</button>).</p>
				<p>You can cut and paste text between the Code Editor and the system clipboard.This is a very important feature, because it allows you to transfer text the Code Editor and other XML editors or text editors.</p>
			</div>

			<button id="wq377" class="accordian">Hierarchy of the elements</button>
			<div class="panel" style="display:none">
				<p><button onclick="scrollHere('ml_fig_hierarchy')">Figure 80</button> lists the begin tags of all the XML in the Host On-Demand macro language. This list is not valid in terms of syntax and does not indicate where more than one element of the same can occur. However, the indentation in this list does shows which XML occur inside other XML elements. For example, the first element in the list, the &lt;HAScript&gt; element, which is not indented at all, is the master and contains all the other elements. The second element, the &lt;import&gt; element, occurs inside an &lt;HAScript&gt; element and contains a &lt;type&gt; element. so on.</p>
				<div class="figrules" id="ml_fig_hierarchy"><span class="figcap">Figure 80. Hierarchy of elements in the Host On-Demand macro language</span>
					<pre class="xmp"><code>&lt;HAScript&gt;                 Encloses all the other elements in the script.   &lt;import&gt;                Container for &lt;type&gt; elements.      &lt;type&gt;               Declares an imported data type (Java class).   &lt;vars&gt;                  Container for &lt;create&gt; elements.      &lt;create&gt;             Creates and initializes a variable.   &lt;screen&gt;                Screen element, contains info about one macro screen.      &lt;description&gt;        Container for descriptors.         &lt;attrib&gt;          Describes a particular field attribute.         &lt;cursor&gt;          Describes the location of the cursor.         &lt;customreco&gt;      Refers to a custom recognition element.         &lt;numfields&gt;       Describes the number of fields in the screen.         &lt;numinputfields&gt;  Describes the number of input fields in the screen.         &lt;string&gt;          Describes a character string on the screen.         &lt;varupdate&gt;       Assigns a value to a variable.      &lt;actions&gt;            Container for actions.         &lt;boxselection&gt;    Draws a selection box on the host application screen.         &lt;commwait&gt;        Waits for the specified communication status to occur.         &lt;custom&gt;          Calls a custom action.         &lt;extract&gt;         Copies data from the host application screen.         &lt;else&gt;            Allows you to insert an else-condition.         &lt;filexfer&gt;        Uploads or downloads a file.         &lt;if&gt;              Allows you to insert an if-condition.         &lt;input&gt;           Sends keystrokes to the host application.         &lt;message&gt;         Displays a message to the user.         &lt;mouseclick&gt;      Simulates a mouse click.         &lt;pause&gt;           Waits for the specified amount of time.         &lt;perform&gt;         Calls a Java method that you provide.         &lt;playmacro&gt;       Calls another macro.         &lt;prompt&gt;          Prompts the user for information.         &lt;trace&gt;           Writes out a trace record.         &lt;varupdate&gt;       Assigns a value to a variable.      &lt;nextscreens&gt;           Container for &lt;nextscreen&gt; elements.         &lt;nextscreen&gt;         Contains the name of a valid next macro screen.      &lt;recolimit&gt;             Takes action if recognition limit is reached.</code></pre>
				</div>
				<p>The hierarchy of the elements and the corresponding structure of the script are discussed in numerous places in this document. In particular, the following sections:</p>
				<ul>
					<li>For the &lt;HAScript&gt; element see <button onclick="scrollHere('mc2_conceptual_view_macro_script')">Conceptual view of a macro script</button>.</li>
					<li>For the &lt;screen&gt; element see <button onclick="scrollHere('mc2_macro_screen_conceptual')">Conceptual view of a macro screen</button>.</li>
				</ul>
				<p>For descriptions of individual elements see <button onclick="scrollHere('mr_reference_to_elements')">Macro language elements</button>.</p>
			</div>

			<button id="cr_xml_comments" class="accordian">Inserting comments into a macro script</button>
			<div class="panel" style="display:none">
				<p>You can insert a comment anywhere inside an &lt;HAScript&gt; element by XML-style comment brackets <samp class="xph">&lt;!-- --&gt;</samp> around the text of comment.</p>
				<p>Comments are useful for:</p>
				<ul>
					<li>Organizing a macro script by providing descriptive text.</li>
					<li>Documenting a macro script by explaining complexities.</li>
					<li>Debugging a macro script by commenting out executable elements in to determine which remaining element is causing a problem.</li>
				</ul>
				<h3 id="wq378">Format of comments</h3>
				<p>When you save a macro script, the Code Editor re-formats your if necessary to make them conform to the following format:</p>
				<ul>
					<li>Each comment starts on a new line.</li>
					<li>Each comment is indented the same number of spaces as the element it.</li>
				</ul>
				<p class="indatacontent">No matter where you place a comment, the Code Editor will arrange according to this scheme ( see <button onclick="scrollHere('ml_examples_of_comments')">Examples of comments</button>).</p>
				<h3 id="wq379">Comment errors</h3>
				<p>The Code Editor will display an error message in the following situations:</p>
				<ul>
					<li>Nested comments</li>
					<li>A comment that comments out part of an executable element.</li>
				</ul>
				<p>Also, you cannot use comment brackets <samp class="xph">&lt;!-- --&gt;</samp> outside the &lt;HAScript&gt; element. If you do so then the Code Editor will discard those comment and the surrounded text when it saves the script.</p>
				<h3 id="ml_examples_of_comments">Examples of comments</h3>
				<p>Here are some examples of the use of comment brackets <samp class="xph">&lt;!-- --&gt;</samp> to insert comments:</p>
				<pre class="xmp"><code>&lt;!--
				A multi-line comment that comments the following &lt;screen&gt; --&gt; &lt;screen name="Screen1" entryscreen="true" exitscreen="false" transient="false"&gt;  &lt;!-- A comment on the following &lt;description&gt; element --&gt; &lt;description&gt;    &lt;oia status="NOTINHIBITED" optional="false" invertmatch="false" /&gt; &lt;/description&gt;  &lt;! A comment on the following &lt;actions&gt; element --&gt; &lt;actions&gt;    &lt;mouseclick row="4" col="16" /&gt;    &lt;input value="3[enter]" row="0" col="0" movecursor="true"              xlatehostkeys="true" /&gt; &lt;/actions&gt; &lt;!--
				An accidental comment that surrounds part a &lt;nextscreens&gt; element,  thereby the macro script.You will get an error when you try to this macro &lt;nextscreens timeout="0" &gt;    &lt;nextscreen name="Screen2" /&gt; END of accidental --&gt; &lt;/nextscreens&gt; &lt;/screen&gt; </code></pre>
			</div>

			<button id="ml_debug_trace" class="accordian">Debugging macro scripts with the &lt;trace&gt; element</button>
			<div class="panel" style="display:none">
				<p>When you are debugging, you can use the &lt;trace&gt; element to send and values to a trace output destination. In particular, if you include name of a variable in the output, then the macro runtime will display the name and the value of the variable in the output, enclosed in curly {}. Here is an example:  </p>
				<div class="figrules" id="ml_fig_trace_part1"><span class="figcap">Figure 81. Example of using the &lt;trace&gt; element</span>
					<pre class="xmp"><code>&lt;vars&gt; &lt;create name="$var1$" type="string" value="'original'" /&gt; &lt;/vars&gt; ..&lt;actions&gt; &lt;trace type="SYSOUT" value="'Before update: '+$var1$" /&gt; &lt;varupdate name="$var1$" value="'updated'" /&gt; &lt;trace type="SYSOUT" value="'After update: '+$var1$" /&gt; &lt;/actions&gt; </code></pre>
				</div>
				<p class="indatacontent">The code shown in the figure above prints the following text to Java console: </p>
				<div class="figrules" id="ml_fig_trace_part2"><span class="figcap">Figure 82. Output from example of using the &lt;trace&gt; element</span>
					<pre class="xmp"><code>Before update: +{$var1$ = original}
					After update: +{$var1$ = updated}</code></pre>
				</div>
				<p class="indatacontent">Notice that the &lt;trace&gt; action displays each variable in curly {} that contain both the variable name and the contents of the variable.</p>
			</div>

			<button id="wq380" class="accordian">Using the Host Access Toolkit product with macros</button>
			<div class="panel" style="display:none">
				<p>The separate Host Access Toolkit product includes classes that allow to dynamically create macro variables, perform macro actions, and run macros.This section contains an example of using the Host Access Toolkit product.</p>
				<p><button onclick="scrollHere('ml_fig_progmacro_part1')">Figure 83</button> shows the first version of a that prompts for the user's ID and password, logs on to a host, and says Welcome!
				This version of the macro does not use the Host Access Toolkit:</p>
				<div class="figrules" id="ml_fig_progmacro_part1"><span class="figcap">Figure 83. Sample macro that prompts for user's ID and password</span>
					<pre class="xmp"><code>&lt;HAScript name="Logon" description="" timeout="60000" pausetime="300"           promptall="true" author="" creationdate="" supressclearevents="false"           usevars="true" &gt;    &lt;screen name="Screen1" entryscreen="true" exitscreen="false" transient="false"&gt;      &lt;description&gt;       &lt;oia status="NOTINHIBITED" optional="false" invertmatch="false" /&gt;     &lt;/description&gt;      &lt;actions&gt;       &lt;prompt name="'UserID:'" description="" row="20" col="16" len="8"               default="" clearfield="false" encrypted="false" movecursor="true"               xlatehostkeys="true" assigntovar="" varupdateonly="false" /&gt;       &lt;input value="'[tab]'" row="0" col="0" movecursor="true"               xlatehostkeys="true" encrypted="false" /&gt;       &lt;prompt name="'Password:'" description="" row="21" col="16" len="8"               default="" clearfield="false" encrypted="true" movecursor="true"               xlatehostkeys="true" assigntovar="" varupdateonly="false" /&gt;       &lt;input value="'[enter]'" row="0" col="0" movecursor="true"               xlatehostkeys="true" encrypted="false" /&gt;     &lt;/actions&gt;     &lt;nextscreens timeout="0" &gt;       &lt;nextscreen name="Screen2" /&gt;     &lt;/nextscreens&gt;   &lt;/screen&gt;    &lt;screen name="Screen2" entryscreen="false" exitscreen="true" transient="false"&gt;     &lt;description&gt;       &lt;oia status="NOTINHIBITED" optional="false" invertmatch="false" /&gt;       &lt;numfields number="7" optional="false" invertmatch="false" /&gt;       &lt;numinputfields number="1" optional="false" invertmatch="false" /&gt;     &lt;/description&gt;     &lt;actions&gt;       &lt;message title="" value="'Welcome!'" /&gt;     &lt;/actions&gt;     &lt;nextscreens timeout="0" &gt;     &lt;/nextscreens&gt;   &lt;/screen&gt;  &lt;/HAScript&gt; </code></pre>
				</div>
				<p>Assume that you want to use this macro in a Host Access Beans program and you want to store the user ID into a variable and save it for later use (example, in the Welcome message). You can do this directly by modifying macro, but one reason for writing a program for this is to avoid having maintain many different macros for different situations. You could have a basic version of the macro and use a program to modify it on the situation. The following is an example of how you can do this in Java:  </p>
				<div class="figrules" id="ml_fig_progmacro_part2"><span class="figcap">Figure 84. Java code to modify a Variable update action and a Prompt action</span>
					<pre class="xmp"><code>// Assume macro is an instantiated Macro with the appropriate listeners set up.// (See the Javadoc for the Macro bean and the Macro variables demo program, // MacroVariablesDemo.java, in the Host Access Toolkit samples // for details.) // Assume macroString is a String containing the previous macro macro.setMacro(macroString); MacroScreens ms = macro.getParsedMacro(); ms.createVariableString("$userid$", null);   //creates a variable $userid$                                              //initial value of "" MacroScreen mscrn = ms.get(0);   //get the first MacroActions mas = mscrn.getActions();   //get the actions from the first MacroActionPrompt map = (MacroActionPrompt)mas.get(0);   //get the first prompt map.setAssignToVar("$userid$"); //assign the prompt response to the variable $userid$ MacroScreen mscrn2 = ms.get(1); //get the second MacroActions mas2 = mscrn2.getActions(); //get the actions from the second MacroActionMessage mam = (MacroActionMessage)mas2.get(0); //get the message mam.setMessage("'Welcome ' + $userid$ + '!'"); //change the message to now be                                                //personalized message using $userid$ macro.setParsedMacro(ms); //reset the macro with the updated macro.play(); //play the macro with the changes for variables </code></pre>
				</div>
				<p>Suppose that you now want to add a second message to the for Screen2. In this message, you want to display the time and date, you extract from the screen. You would add the following lines before<samp class="xph"> macro.setParsedMacro(ms)</samp>: </p>
				<div class="figrules" id="ml_fig_progmacro_part3"><span class="figcap">Figure 85. Adding a second message</span>
					<pre class="xmp"><code>//create a variable $datetimestamp$ with initial value "" ms.createVariableString("$datetimestamp$", null);  //create new extract to get date and time from second row of MacroActionExtract mae = new MacroActionExtract(2, 35, 2, 71, "'datetimeextract'");  //assign the date and time string to $datetimestamp$ mae.setAssignToVar("$datetimestamp$");  //add the extract after the first mas2.add(mae);  //create a new message to display the date and MacroActionMessage mam2 = new MacroActionMessage(
				 	  "'You have logged on at ' + $datetimestamp$", "'Date Time Stamp'");  //add the message after the mas2.add(mam2);  </code></pre>
				</div>
				<p>Note that at the point when the attribute containing the variable(s) associated with the MacroScreens, you must have already created the (through one of the createVariable() methods). For example, this code would also be valid:  </p>
				<div class="figrules" id="ml_fig_progmacro_part4"><span class="figcap">Figure 86. Alternate code sequence</span>
					<pre class="xmp"><code>MacroActionExtract mae = new MacroActionExtract(2, 35, 2, 71, "'datetimeextract'"); mae.setAssignToVar("$datetimestamp$"); ms.createVariableString("$datetimestamp$", null); mas2.add(mae); MacroActionMessage mam2 = new MacroActionMessage("'You have logged on at ' +
					   $datetimestamp$", "'Date Time Stamp'"); mas2.add(mam2); </code></pre>
				</div>
				<p>The above sequence is valid because $datetimestamp$ is created before MacroActionExtract is added to the MacroActions (which are already with the MacroScreens because they were pulled from the MacroScreens originally).If the createVariable() method was called at the end of the sequence above, you would have an invalid sequence because the variable $datetimestamp$ not have been available at the time that the MacroActionExtract and were added to the MacroActions and associated with the MacroScreens.</p>
				<p>The default value of the MacroScreens method isUseVars() is false. However, if you call one of the createVariable() methods on your MacroScreens, isUseVars() will return true automatically. If you don't create any variables, but to have your attributes scanned for variables and arithmetic anyway (e.g.you might be writing a chained child macro that has no variables of its but is anticipating some from the parent), you must call setUseVars(true) on your MacroScreens.</p>
				<p>Attributes that can now take variables or expressions as arguments setAttribute(String) and either getAttributeRaw() or isAttributeRaw() available. If you wanted to use an expression now to represent the row for a MacroActionInput, you could call setRow("$rowvar$ + 1"). calling getRow() would return the evaluated value of this expression (an integer), whereas calling getRowRaw() would return "$rowvar$ + 1." Note that if do the following you will get a NumberFormatException:  </p>
				<div class="figrules" id="ml_fig_progmacro_part5"><span class="figcap">Figure 87. Code that causes a NumberFormatException</span>
					<pre class="xmp"><code>MacroActionInput mai = new MacroActionInput(); mai.setRow("$rowvar$ + 1"); int row = mai.getRow(); </code></pre>
				</div>
				<p class="indatacontent">This is because <samp class="xph">mai</samp> has not yet been associated with MacroScreens with isUseVars() returning true. Therefore, "$rowvar$ + 1" being treated as a string rather than a variable plus one. Note also if you had call the setAttribute() methods to set up variables and after the object containing these attributes have been associated with MacroScreens, you will likely experience a savings in processing time as attributes would otherwise need to be reparsed for variables/expressions the point when they are added to the MacroScreens.</p>
				<p>The VariableException class is available for catching exceptions such illegal expressions (e.g., "45 *") or illegal arithmetic operands (e.g., "'3a' * 2").</p>
				<p>A sample program that uses programmed macros, MacroVariablesDemo.java, can be found in the Host Access Toolkit samples directory.</p>
			</div>
		</div>

		<button id="mr_reference_to_elements" class="accordian">Macro language elements</button>
		<div class="panel" style="display:none">

			<button id="wq381" class="accordian">Specifying the attributes</button>
			<div class="panel" style="display:none">
				<h3 id="wq382">XML requirements</h3>
				<p>In the macro language the value of every attribute must be in double quotes. For example, in the following &lt;mouseclick&gt; the values of the <strong>row</strong> and <strong>col</strong> are enclosed in double quotes:</p>
				<pre class="xmp"><code>&lt;mouseclick row="4" col="51" /&gt;</code></pre>
				<h3 id="wq383">Advanced format in attribute values</h3>
				<p>As you may remember, even if a macro is in the advanced format, not all input fields in the Macro Editor expect a string to be in single quotes ('') (see <button onclick="scrollHere('me_representing_strings')">Representation of strings and special characters, treatment of characters</button>).Specifically, the advanced format affects input fields only on following tabs of the Macro Editor:</p>
				<ul>
					<li>Description tab of the Screens tab</li>
					<li>Actions tab of the Screens tab</li>
					<li>Variables tab</li>
				</ul>
				<p>Similarly, in the macro language, when you provide a string for an attribute that corresponds to one of these input fields is affected by the advanced format, you must enter the string in advanced format. For example, in the &lt;message&gt; element the for both attributes must be written enclosed in single quotes, the macro is in the advanced format:</p>
				<pre class="xmp"><code>&lt;message title="'Instructions'"  value="'Check the java console'" /&gt;</code></pre>
				<p>However, if an attribute does not correspond to one of the fields affected by the advanced format, then you should not the value enclosed in single quotes, even if the macro is in the formt. For example, the <strong>name</strong> attribute of the &lt;screen&gt; element should never be enclosed in single quotes:</p>
				<pre class="xmp"><code>&lt;screen name="Screen1" entryscreen="true" exitscreen="true" transient="false" &gt;    ...&lt;/screen&gt;</code></pre>
				<p>In the descriptions in this chapter of macro language elements, this book indicates such attributes (attributes that are by the advanced format) by not specifying a data type. For example, the description of the <strong>name</strong> attribute of the &lt;screen&gt; element is "Required" rather than as "Required string".</p>
				<h3 id="wq384">Typed data</h3>
				<p>Most attributes require a particular type of data: boolean, integer, string, double, or imported. For these attributes, the same apply as in the Macro Editor:</p>
				<ul>
					<li>The consequences of selecting the basic macro format or macro format (see <button onclick="scrollHere('me_choosing_a_format')">Choosing a macro format</button>).</li>
					<li>The rules for representing strings and special characters, for treating operator characters (see <button onclick="scrollHere('me_representing_strings')">Representation of strings and special characters, treatment of characters</button>).</li>
					<li>The rules for equivalent entities (see <button onclick="scrollHere('me_equivalents')">Equivalents</button>).</li>
					<li>The rules for data type conversion (see <button onclick="scrollHere('me_data_type_conversion')">Automatic data type conversion</button>).</li>
					<li>The rules for arithmetic operators and expressions (see <button onclick="scrollHere('me_arithmetic')">Arithmetic operators and expressions</button>).</li>
					<li>The rules for the string concatenation operator (see <button onclick="scrollHere('me_string_concat_operator')">String concatenation operator (+)</button>).</li>
					<li>The rules for conditional and logical operators and (see <button onclick="scrollHere('me_conditional_expressions')">Conditional and logical operators and expressions</button>).</li>
					<li>The rules for representing variables (see <button onclick="scrollHere('mv1_intro_to_vars_tab')">Introduction to the Variables tab</button>).</li>
					<li>The rules for calling methods on imported variables (see <button onclick="scrollHere('mv_calling_a_method')">Calling Java methods</button>).</li>
				</ul>
			</div>

			<button id="mr_actions" class="accordian">&lt;actions&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq385">General</h3>
				<p>The &lt;actions&gt; element, the &lt;description&gt; element, and &lt;nextscreens&gt; element are the three primary structural elements that occur the &lt;screen&gt; element (see <button onclick="scrollHere('mc2_macro_screen_conceptual')">Conceptual view of a macro screen</button>).</p>
				<p>The &lt;actions&gt; element contains elements called actions (as simulating a keystroke, capturing data, and others) that the runtime performs during macro playback (see <button onclick="scrollHere('ma_actions_part1')">Macro actions</button>).</p>
				<h3 id="mr_actions_attributes">Attributes</h3>
				<dl>
					<dt class="bold">promptall</dt>
					<dd>Optional boolean (the default is false). If this attribute set to true then the macro runtime, before performing any of the inside the &lt;actions&gt; element, collects user input for any &lt;prompt&gt; elements inside the element. More specifically: 
						<ol type="1">
							<li>The macro runtime searches the &lt;actions&gt; element to find any &lt;prompt&gt; elements that occur within it.</li>
							<li>The macro runtime displays the prompts for all the &lt;prompt&gt; elements immediately (all the prompts are combined into one popup).</li>
							<li>The macro runtime collects the user input for all the popup windows.</li>
							<li>The macro runtime now performs all the elements in the &lt;actions&gt; element as usual, in sequence.</li>
							<li>When the macro runtime comes to a &lt;prompt&gt; action, it not display the popup window for user input, but instead the &lt;prompt&gt; action using the input from step 3 above.</li>
						</ol>
						<p>The promptall attribute of the &lt;HAScript&gt; element the same function for all the &lt;prompt&gt; elements in one macro (see <button onclick="scrollHere('mr_hascript')">&lt;HAScript&gt; element</button>).</p>
					</dd>
				</dl>
				<h3 id="wq387">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_actions"><span class="figcap">Figure 88. Examples for the &lt;actions&gt; element</span>
					<pre class="xmp"><code>&lt;actions promptall="true"&gt;    ...&lt;/actions&gt;</code></pre>
				</div>
				<pre class="xmp"><code> </code></pre>
			</div>

			<button id="mr_attribute" class="accordian">&lt;attrib&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq388">General</h3>
				<p>The &lt;attrib&gt; element is a descriptor that states the row column location and the value of a 3270 or 5250 attribute (see <button onclick="scrollHere('md1_attribute')">Attribute descriptor (&lt;attrib&gt; element)</button>).</p>
				<h3 id="wq389">Attributes</h3>
				<dl>
					<dt class="bold">plane</dt>
					<dd>Required. The data plane in which the attribute resides. valid values are: 
						<ul>
							<li>FIELD_PLANE</li>
							<li>COLOR_PLANE</li>
							<li>DBCS_PLANE</li>
							<li>GRID_PLANE</li>
							<li>EXFIELD_PLANE</li>
							<li>Any expression that evaluates to one of the above.</li>
						</ul>
					</dd>
					<dt class="bold">value</dt>
					<dd>Required. A hexadecimal value in the format 0x37. The of the attribute.</dd>
					<dt class="bold">row</dt>
					<dd>Required integer. The row location of the attribute in the plane.</dd>
					<dt class="bold">col</dt>
					<dd>Required integer. The column location of the attribute in data plane.</dd>
					<dt class="bold">optional</dt>
					<dd>Optional boolean (the default is false). See <button onclick="scrollHere('md1_optional')">Optional</button>.</dd>
					<dt class="bold">invertmatch</dt>
					<dd>Optional boolean. See <button onclick="scrollHere('md1_inverse_descriptor')">Inverse Descriptor</button>.</dd>
					<dt class="bold">hostid</dt>
					<dd>Optional string. See <button onclick="scrollHere('md1_attribute_hostid')">Specifying a session</button>.</dd>
				</dl>
				<h3 id="wq390">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_attribute"><span class="figcap">Figure 89. Examples for the &lt;attribute&gt; element</span>
					<pre class="xmp"><code>&lt;attrib value="0x3" row="4" col="14" plane="COLOR_PLANE"             optional="false" invertmatch="false" /&gt;</code></pre>
				</div>
				<pre class="xmp"><code> </code></pre>
			</div>

			<button id="mr_boxselection" class="accordian">&lt;boxselection&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq391">General</h3>
				<p>The &lt;boxselection&gt; element draws a marking rectangle on session window, simulating the action in which a user clicks on session window, holds down mouse button 1, and drags the mouse create a marking rectangle (see <button onclick="scrollHere('ma_boxselection')">Box selection action (&lt;boxselection&gt; element)</button>).</p>
				<h3 id="wq392">Attributes</h3>
				<dl>
					<dt class="bold">srow</dt>
					<dd>Required integer. The row coordinate of the starting of the marking rectangle.</dd>
					<dt class="bold">scol</dt>
					<dd>Required integer. The column coordinate of the starting of the marking rectangle.</dd>
					<dt class="bold">erow</dt>
					<dd>Required integer. The row coordinate of the ending corner the marking rectangle.</dd>
					<dt class="bold">ecol</dt>
					<dd>Required integer. The column coordinate of the ending of the marking rectangle.</dd>
					<dt class="bold">type</dt>
					<dd>Optional (default SELECT). Specify SELECT to draw a rectangle or DESELECT to remove a marking rectangle.</dd>
					<dt class="bold">hostid</dt>
					<dd>Optional string. See <button onclick="scrollHere('ma_boxselection_hostid')">Specifying a session</button>.</dd>
				</dl>
				<h3 id="wq393">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_box_selection"><span class="figcap">Figure 90. Examples for the &lt;boxselection&gt; element</span>
					<pre class="xmp"><code>&lt;boxselection srow="6" scol="16" erow="7" ecol="73" type="SELECT" /&gt;</code></pre>
				</div>
				<pre class="xmp"><code> </code></pre>
			</div>

			<button id="cr_comment" class="accordian">&lt;comment&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq394">General</h3>
				<p>The &lt;comment&gt; element inserts a text comment as a within a &lt;screen&gt; element. Limitations are:</p>
				<ul>
					<li>You cannot use a &lt;comment&gt; element outside a &lt;screen&gt; element.</li>
					<li>You cannot use more than one &lt;comment&gt; element inside the same &lt;screen&gt; element. If you do so then the Code Editor will discard all the &lt;comment&gt; elements inside that &lt;screen&gt; element except the last one.</li>
					<li>No matter where in the &lt;screen&gt; element you place the &lt;comment&gt; element, the Code Editor will move the comment up to be the element within the &lt;screen&gt; element.</li>
				</ul>
				<h4 id="wq395">A better method for inserting comments</h4>
				<p>A more flexible method for inserting a comment is to use the XML-comment brackets <samp class="xph">&lt;!-- --&gt;</samp>. See <button onclick="scrollHere('cr_xml_comments')">Inserting comments into a macro script</button>.</p>
				<h3 id="wq396">Attributes</h3>
				<p>None.</p>
				<h3 id="wq397">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_old_comment"><span class="figcap">Figure 91. Examples for the &lt;comment&gt; element</span>
					<pre class="xmp"><code>&lt;screen name="Screen2" entryscreen="false" exitscreen="true"                transient="false"&gt;    &lt;comment&gt;This comment provides information about this macro screen.   &lt;/comment&gt;    ...&lt;/screen&gt;</code></pre>
				</div>
			</div>

			<button id="mr_commwait" class="accordian">&lt;commwait&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq398">General</h3>
				<p>The &lt;commwait&gt; action waits for the communication status the session to change to some specified value (see <button onclick="scrollHere('ma_commwait')">Comm wait action (&lt;commwait&gt; element)</button>). You must specify a timeout value.</p>
				<h3 id="wq399">Attributes</h3>
				<dl>
					<dt class="bold">value</dt>
					<dd>Required. The communication status to wait for. The value be one of the following (see <button onclick="scrollHere('ma_cw_comm_states')">Communication states</button>): 
						<ul>
							<li>CONNECTION_INIT</li>
							<li>CONNECTION_PND_ACTIVE</li>
							<li>CONNECTION_ACTIVE</li>
							<li>CONNECTION_READY</li>
							<li>CONNECTION_DEVICE_NAME_READY</li>
							<li>CONNECTION_WORKSTATION_ID_READY</li>
							<li>CONNECTION_PND_INACTIVE</li>
							<li>CONNECTION_INACTIVE</li>
						</ul>
					</dd>
				</dl>
				<dl>
					<dt class="bold">timeout</dt>
					<dd>Required integer. A timeout value in milliseconds. The runtime terminates the action if the timeout expires before the communication status occurs.</dd>
					<dt class="bold">hostid</dt>
					<dd>Optional string. See <button onclick="scrollHere('ma_commwait_hostid')">Specifying a session</button>.</dd>
				</dl>
				<h3 id="wq400">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_commwait"><span class="figcap">Figure 92. Examples for the &lt;commwait&gt; element</span>
					<pre class="xmp"><code>&lt;commwait value="CONNECTION_READY" timeout="10000" /&gt;</code></pre>
				</div>
			</div>

			<button id="cr_condition" class="accordian">&lt;condition&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq401">General</h3>
				<p>The &lt;condition&gt; element specifies a conditional expression the macro runtime evaluates during screen recognition. If the evaluates to true then the macro runtime evaluates the as true. If the expression evaluates to false then the macro evaluates the descriptor as false (see <button onclick="scrollHere('md_condition')">Condition descriptor (&lt;condition&gt;) element</button>).</p>
				<p>For more information on conditional expressions see <button onclick="scrollHere('me_conditional_expressions')">Conditional and logical operators and expressions</button>.</p>
				<h3 id="wq402">Attributes</h3>
				<dl>
					<dt class="bold">value</dt>
					<dd>Required expression. The conditional expression that the runtime is to evaluate. This conditional expression can contain expressions, variables, return values from Java method calls, other conditional expressions.</dd>
					<dt class="bold">optional</dt>
					<dd>Optional boolean (the default is false). See <button onclick="scrollHere('md1_optional')">Optional</button>.</dd>
					<dt class="bold">invertmatch</dt>
					<dd>Optional boolean. See <button onclick="scrollHere('md1_inverse_descriptor')">Inverse Descriptor</button>.</dd>
				</dl>
				<h3 id="wq403">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_condition"><span class="figcap">Figure 93. Examples for the &lt;condition&gt; element</span>
					<pre class="xmp"><code>&lt;description&gt;    &lt;! Check the value of a variable --&gt;    &lt;condition value="$intPartsComplete$ == 4"             optional="false" invertmatch="false" /&gt;     &lt;!-- Check the return value of a Java method --&gt;    &lt;condition value="$htHashTable.size()$ != 0"$             optional="false" invertmatch="false" /&gt; &lt;/description&gt;</code></pre>
				</div>
			</div>
			
			<button id="mr_create" class="accordian">&lt;create&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq404">General</h3>
				<p>The &lt;create&gt; element creates and initializes a variable (see <button onclick="scrollHere('mv_creating_new_variable')">Creating a new variable</button>).</p>
				<p>The &lt;create&gt; element must occur inside a &lt;vars&gt; element.</p>
				<h3 id="wq405">Attributes</h3>
				<dl>
					<dt class="bold">name</dt>
					<dd> Required. The name that you assign to the variable. There a few restrictions on the spelling of variable names (see <button onclick="scrollHere('mv_var_and_type_names')">Variable names and type names</button>).</dd>
					<dt class="bold">type</dt>
					<dd>Required. The type of the variable. The standard types are string, integer, double, boolean, field. You an also define an imported representing a Java class (see <button onclick="scrollHere('mv_creating_new_variable')">Creating a new variable</button>).</dd>
					<dt class="bold">value</dt>
					<dd>Optional. The initial value for the variable. If you do specify an initial value then the default initial value depends the variable type (see <button onclick="scrollHere('mv_table_default_initial_values')">Table 22</button>).</dd>
				</dl>
				<h3 id="wq406">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_create"><span class="figcap">Figure 94. Examples for the &lt;create&gt; element</span>
					<pre class="xmp"><code>&lt;HAScript ... usevars="true" ... &gt;    &lt;import&gt;       &lt;type class="java.util.Properties" name="Properties" /&gt;    &lt;/import&gt;     &lt;vars&gt;       &lt;create name="$prp$" type="Properties" value="$new Properties()$" /&gt;       &lt;create name="$strAccountName$" type="string" value="" /&gt;       &lt;create name="$intAmount$" type="integer" value="0" /&gt;       &lt;create name="$dblDistance$" type="double" value="0.0" /&gt;       &lt;create name="$boolSignedUp$" type="boolean" value="false" /&gt;       &lt;create name="$fldFunction$" type="field" /&gt;    &lt;/vars&gt;    ...&lt;/HAScript&gt;</code></pre>
				</div>
				<pre class="xmp"><code> </code></pre>
			</div>


			<button id="mr_cursor" class="accordian">&lt;cursor&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq407">General</h3>
				<p>The &lt;cursor&gt; element is a descriptor that states the row column location of the text cursor on the session window (see <button onclick="scrollHere('md1_cursor')">Cursor descriptor (&lt;cursor&gt; element)</button>).</p>
				<h3 id="wq408">Attributes</h3>
				<dl>
					<dt class="bold">row</dt>
					<dd>Required integer. The row location of the text cursor.</dd>
					<dt class="bold">col</dt>
					<dd>Required integer. The column location of the text cursor.</dd>
					<dt class="bold">optional</dt>
					<dd>Optional boolean (the default is false). See <button onclick="scrollHere('md1_optional')">Optional</button>.</dd>
					<dt class="bold">invertmatch</dt>
					<dd>Optional boolean. See <button onclick="scrollHere('md1_inverse_descriptor')">Inverse Descriptor</button>.</dd>
					<dt class="bold">hostid</dt>
					<dd>Optional string. See <button onclick="scrollHere('md1_cursor_hostid')">Specifying a session</button>.</dd>
				</dl>
				<h3 id="wq409">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_cursor"><span class="figcap">Figure 95. Examples for the &lt;cursor&gt; element</span>
					<pre class="xmp"><code>&lt;cursor row="4" col="14" optional="false" invertmatch="false" /&gt;</code></pre>
				</div>
			</div>


			<button id="mr_custom" class="accordian">&lt;custom&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq410">General</h3>
				<p>The &lt;custom&gt; element allows you to invoke a custom Java from inside the &lt;actions&gt; element of a macro screen. However, must use the separate Host Access Toolkit product.</p>
				<p>Here is an overview of the process:</p>
				<ol type="1">
					<li>Suppose that you have a Java program that you want to invoke an action during the processing of a macro screen's &lt;actions&gt; element.</li>
					<li>In the Code Editor, add the following line to the &lt;actions&gt; element at the location at which you want to invoke the custom program: <pre class="xmp"><code>&lt;custom id="'MyProgram1'" args="'arg1 arg2 arg3'"  /&gt;</code></pre></li>
					<li>Follow the instructions in the <strong>MacroActionCustom</strong> of the Host Access Toolkit product. You will create a class that implements <strong>MacroCustomActionListener</strong>. The execute() will be called with an event when the macro runtime performs the &lt;custom&gt; action in step 2.</li>
				</ol>
				<h3 id="wq412">Attributes</h3>
				<dl>
					<dt class="bold">id</dt>
					<dd>Required. An arbitrary string that identifies the custom program that you want to run.</dd>
					<dt class="bold">args</dt>
					<dd>Optional. The arguments that you want to pass to the Java program.</dd>
				</dl>
				<h3 id="wq413">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_custom"><span class="figcap">Figure 96. Examples for the &lt;custom&gt; element</span>
					<pre class="xmp"><code>&lt;custom id="'MyProgram1'" args="'arg1 arg2 arg3'" /&gt; &lt;custom id="'MyProgram2'" args="'arg1 arg2'" /&gt;</code></pre>
				</div>
			</div>


			<button id="mr_customreco" class="accordian">&lt;customreco&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq414">General</h3>
				<p>This &lt;customreco&gt; element allows you to call out to custom code. To use the &lt;customreco&gt; element you must have the Host Access Toolkit product.</p>
				<p>The steps for creating a custom descriptor are as follows:</p>
				<ol type="1">
					<li>Choose a string to identify the custom description, such as <samp class="xph">MyCustomDescriptor01</samp>.An identifier is required because you can have several types of descriptions.</li>
					<li>Implement the <strong>ECLCustomRecoListener</strong> interface.In the <strong>doReco()</strong> method: 
						<ol type="a">
							<li>Add code to check the identification string to verify that is yours.</li>
							<li>Add your custom description code.</li>
							<li>Return true if the custom description is satisfied or false it is not.</li>
						</ol>
					</li>
					<li>Use the Code Editor to add a &lt;customreco&gt; element to the &lt;description&gt; element of the macro screen. The &lt;customreco&gt; element must the identifier you chose in step 2.</li>
				</ol>
				<p>The macro runtime performs the &lt;customreco&gt; element after all the other descriptors.</p>
				<h3 id="wq417">Attributes</h3>
				<dl>
					<dt class="bold">id</dt>
					<dd>Required string. The identifier that you have assigned to custom description.</dd>
					<dt class="bold">optional</dt>
					<dd>Optional boolean (the default is false). See <button onclick="scrollHere('md1_optional')">Optional</button>.</dd>
					<dt class="bold">invertmatch</dt>
					<dd>Optional boolean. See <button onclick="scrollHere('md1_inverse_descriptor')">Inverse Descriptor</button>.</dd>
				</dl>
				<h3 id="wq418">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_customreco"><span class="figcap">Figure 97. Examples for the &lt;customreco&gt; element</span>
					<pre class="xmp"><code>&lt;customreco id="'MyCustomDescriptor01'" optional="false" invertmatch="false" /&gt;</code></pre>
				</div>
			</div>

			<button id="mr_description" class="accordian">&lt;description&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq419">General</h3>
				<p>The &lt;actions&gt; element, the &lt;description&gt; element, and the &lt;nextscreens&gt; element are the three primary structural elements that can occur the &lt;screen&gt; element (see <button onclick="scrollHere('mc2_macro_screen_conceptual')">Conceptual view of a macro screen</button>).</p>
				<p>The &lt;description&gt; element contains elements called descriptors, each of which states an identifying characteristic of an screen (see <button onclick="scrollHere('md1_screen_description')">Screen description and recognition</button>). The macro uses the descriptors to match the macro screen to an application screen.</p>
				<h3 id="wq420">Attributes</h3>
				<dl>
					<dt class="bold">uselogic</dt>
					<dd>Optional boolean. Allows you to define more complex relations among multiple descriptors than are available with the combining method (see <button onclick="scrollHere('md1_uselogic_attribute')">The uselogic attribute</button>).</dd>
				</dl>
				<h3 id="wq421">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_description"><span class="figcap">Figure 98. Examples for the &lt;description&gt; element</span>
					<pre class="xmp"><code>&lt;description uselogic="true"&gt;    ...&lt;/actions&gt;</code></pre>
				</div>
				<pre class="xmp"><code> </code></pre>
			</div>

			<button id="mr_else" class="accordian">&lt;else&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq422">General</h3>
				<p>The &lt;else&gt; element contains a sequence of macro actions must occur immediately after an &lt;if&gt; element. The macro evaluates the conditional expression in the &lt;if&gt; element. Then:</p>
				<ul>
					<li>If the conditional expression is true: 
						<ul>
							<li>The macro runtime performs the sequence of macro actions in the &lt;if&gt; element; and</li>
							<li>The macro runtime skips the following &lt;else&gt; element if is one.</li>
						</ul>
					</li>
					<li>If the conditional expression is false: 
						<ul>
							<li>The macro runtime skips the sequence of macro actions in the &lt;if&gt; element; and</li>
							<li>The macro runtime performs the macro actions in the following &lt;else&gt; element if there is one.</li>
						</ul>
					</li>
				</ul>
				<p>The Macro object uses the &lt;if&gt; element, and if necessary the &lt;else&gt; element, to store a Conditional action (see <button onclick="scrollHere('ma_condition')">Conditional action (&lt;if&gt; element and &lt;else&gt; element)</button>).</p>
				<h3 id="wq423">Attributes</h3>
				<p>None.</p>
				<h3 id="wq424">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_else"><span class="figcap">Figure 99. Examples for the &lt;else&gt; element</span>
					<pre class="xmp"><code>&lt;if condition="($var_int$ &gt; 10)"&gt;    ...&lt;/if&gt; &lt;else&gt;    ...&lt;/else&gt;</code></pre>
				</div>
			</div>

			<button id="mr_extract" class="accordian">&lt;extract&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq425">General</h3>
				<p>This &lt;extract&gt; action captures data from the session (see <button onclick="scrollHere('ma_extract')">Extract action (&lt;extract&gt; element)</button>).</p>
				<h3 id="wq426">Attributes</h3>
				<p>For more information on the use of all these attributes see <button onclick="scrollHere('ma_extract')">Extract action (&lt;extract&gt; element)</button>.</p>
				<dl>
					<dt class="bold">name</dt>
					<dd>Required string. A name to be assigned to the extracted data.This name is useful only if you are using the IBM Host Access product.</dd>
					<dt class="bold">planetype</dt>
					<dd>Required. The plane from which the data is to be extracted.To access a data plane other than the TEXT_PLANE you need the Host Access Toolkit product (see <button onclick="scrollHere('ma_using_toolkit_for_extract')">Using the Toolkit to capture data from any data plane</button>). Valid values are: 
						<ul>
							<li>TEXT_PLANE</li>
							<li>FIELD_PLANE</li>
							<li>COLOR_PLANE</li>
							<li>EXFIELD_PLANE</li>
							<li>DBCS_PLANE</li>
							<li>GRID_PLANE</li>
						</ul>
					</dd>
					<dt class="bold">srow</dt>
					<dd>Required integer. The row of the first pair of row and coordinates.</dd>
					<dt class="bold">scol</dt>
					<dd>Required integer. The column of the first pair of row and coordinates.</dd>
					<dt class="bold">erow</dt>
					<dd>Required integer. The row of the second pair of row and coordinates.</dd>
					<dt class="bold">scol</dt>
					<dd>Required integer. The column of the second pair of row and coordinates.</dd>
					<dt class="bold">unwrap</dt>
					<dd>Optional boolean. Setting this attribute to true causes macro runtime to capture the entire contents of any field that inside the specified rectangle. See <button onclick="scrollHere('ma_unwraptext')">Unwrap Text option</button>.</dd>
					<dt class="bold">continuous</dt>
					<dd>Optional boolean. Setting this attribute to true causes macro runtime to interpret the row-column coordinates as the and ending locations of a continuous sequence of data that wraps line to line if necessary. If this attribute is set to false the macro runtime interprets the row-column coordinates as the left and lower right corners of a rectangular area of text. See <button onclick="scrollHere('ma_continuous_extract')">Capturing a sequence of text from the session window</button>.</dd>
					<dt class="bold">assigntovar</dt>
					<dd>Optional variable name. Setting this attribute to a name causes the macro runtime to store the text plane data as a value into the variable. If the variable is of some standard other than string (that is, boolean, integer, or double) then data is converted to that standard type, if possible. If the cannot be converted then the macro terminates with a run-time (see <button onclick="scrollHere('ma_ex_variable')">Specify the variable in which you want the text to be stored</button>).</dd>
					<dt class="bold">hostid</dt>
					<dd>Optional string. See <button onclick="scrollHere('ma_extract_hostid')">Specifying a session</button>.</dd>
				</dl>
				<h3 id="wq427">XML samples</h3>
				<p></p>
				<div class="figrules" id="xx_fig_"><span class="figcap">Figure 100. Examples for the &lt;extract&gt; element</span>
					<pre class="xmp"><code>&lt;extract name="'Get Data'" srow="1" scol="1" erow="11" ecol="11"             assignto="$strText$" /&gt;</code></pre>
				</div>
			</div>

			<button id="mr_fileupload" class="accordian">&lt;fileupload&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq428">General</h3>
				<p>The &lt;fileupload&gt; element creates, replaces, appends data to, or updates a table in a host database (see <button onclick="scrollHere('ma_fileupload')">FileUpload action (&lt;fileupload&gt; element)</button>).</p>
				<h3 id="wq429">Attributes</h3>
				<dl>
					<dt class="bold">url</dt>
					<dd>Required string. The database URL for the database server which the file upload command is sent, such as <samp class="xph">jdbc:as400://myISeries</samp> (see <button onclick="scrollHere('ma_fu_database_url')">Database URL</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">driver</dt>
					<dd>Required string. The fully qualified package name of the used to connect with the database server, such as <samp class="xph">COM.ibm.db2.jdbc.app.DB2DRIVER</samp>.This package must be present on the client workstation (see <button onclick="scrollHere('ma_fu_driver_identifier')">Driver Identifier and Driver Class</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">userid</dt>
					<dd>Optional string. The user ID required to access the database, if one is required (see <button onclick="scrollHere('ma_fu_uid')">User ID and Password</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">password</dt>
					<dd>Optional string. The password required to access the database, if one is required (see <button onclick="scrollHere('ma_fu_uid')">User ID and Password</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">filename</dt>
					<dd>Required string. The complete path and name of the local containing the data to be added to the table in the host (see <button onclick="scrollHere('ma_fu_source_file')">File Name and File Type</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">filetype</dt>
					<dd>Required integer. The type of the local file containing data to be added to the table in the host database (see <button onclick="scrollHere('ma_fu_source_file')">File Name and File Type</button>). Valid values are: 
						<ul>
							<li>0 - ASCII text (*.txt)</li>
							<li>1 - Comma Separated Values (*.csv)</li>
							<li>2 - Lotus 1-2-3 (*.wk1)</li>
							<li>3 - Microsoft Excel BIFF3 (*.xls)</li>
							<li>4 - Microsoft Excel BIFF4 (*.xls)</li>
							<li>5 - XML (*.xml)</li>
						</ul>
					</dd>
				</dl>
				<dl>
					<dt class="bold">uploadtype</dt>
					<dd>Required string. The type of file upload operation to perform.Valid values are: 
						<ul>
							<li>append - Append rows to an existing table in the host (see <button onclick="scrollHere('ma_fu_append')">Append</button>).</li>
							<li>create - Create a new table in the host database (see <button onclick="scrollHere('ma_fu_create')">Create</button>). When you use this upload type, you must specify the following attribute: 
								<ul>
									<li><strong>fielddesctable</strong></li>
								</ul>
							</li>
							<li>replace - Replace the contents of an existing table in the database (see <button onclick="scrollHere('ma_fu_replace')">Replace</button>).</li>
							<li>update - Selectively update part of an existing table (see <button onclick="scrollHere('ma_fu_update')">Update</button>). When you use this upload type, you must specify the following attribute: 
								<ul>
									<li><strong>keycolumns</strong></li>
								</ul>
							</li>
						</ul>
					</dd>
				</dl>
				<dl>
					<dt class="bold">fielddesctable</dt>
					<dd>String (required when <strong>uploadtype</strong> is create).The name of the table in the host database from which the server is to read the column names and column widths for the new (see <button onclick="scrollHere('ma_fu_create')">Create</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">keycolumns</dt>
					<dd>String (required when <strong>uploadtype</strong> is update).The name or names of the column or columns that you want to (see <button onclick="scrollHere('ma_fu_update')">Update</button>).</dd>
				</dl>
				<h3 id="wq430">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_fileupload"><span class="figcap">Figure 101. Examples for the &lt;fileupload&gt; element</span>
					<pre class="xmp"><code>&lt;fileupload url="'jdbc:as400://elcrtp06'"     driver="'com.ibm.as400.access.AS400JDBCDriver'"    userid="'myuser'"    password="Ex0bRtrf73mPrwGrWMT+/g=="    filename="e:\\tm\\db02.txt"    filetype="4"    table="'hod.hodtest01'"    uploadtype="append" /&gt;                                       </code></pre>
				</div>
			</div>

			<button id="mr_filexfer" class="accordian">&lt;filexfer&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq431">General</h3>
				<p>The &lt;filexfer&gt; action transfers a file from the to the host or from the host to the workstation (see <button onclick="scrollHere('ma_extract')">Extract action (&lt;extract&gt; element)</button>).</p>
				<h3 id="mr_filexfer_attributes">Attributes</h3>
				<dl>
					<dt class="bold">direction</dt>
					<dd>Required. Use <samp class="xph">send</samp> to transfer a file from the to the host, or <samp class="xph">receive</samp> to transfer a file from the to the workstation.</dd>
				</dl>
				<dl>
					<dt class="bold">pcfile</dt>
					<dd>Required string. The name of the file on the workstation (see <button onclick="scrollHere('ma_xf_basic_parameters')">Basic parameters</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">hostfile</dt>
					<dd>Required string. The name of the file on the host (see <button onclick="scrollHere('ma_xf_basic_parameters')">Basic parameters</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">clear</dt>
					<dd>Required boolean. Set to true for a 3270 Display session false for a 5250 Display session (see <button onclick="scrollHere('ma_xf_advanced_parameters')">Advanced parameters</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">timeout</dt>
					<dd>Required integer. A timeout value in milliseconds (the value is 10000 milliseconds). The macro runtime terminates the if this timeout expires before the file is transferred.</dd>
				</dl>
				<dl>
					<dt class="bold">options</dt>
					<dd>Optional string. Any additional parameters required by host system.</dd>
				</dl>
				<dl>
					<dt class="bold">pccodepage</dt>
					<dd>Optional integer, such as 437. The local code page to use mapping characters from the workstation's character set to the host'character set and vice versa. The default value is the code page in the session configuration.</dd>
				</dl>
				<dl>
					<dt class="bold">hostorientation</dt>
					<dd>Optional. For BIDI sessions only (Arabic and Hebrew). whether text orientation for the host file is right-to-left or left-to-right.</dd>
				</dl>
				<dl>
					<dt class="bold">pcorientation</dt>
					<dd>Optional. For BIDI sessions only (Arabic and Hebrew). whether text orientation for the local file is right-to-left or left-to-right..</dd>
				</dl>
				<dl>
					<dt class="bold">pcfiletype</dt>
					<dd>Optional. For BIDI sessions only (Arabic and Hebrew). whether the local file type is visual or implicit.</dd>
				</dl>
				<dl>
					<dt class="bold">lamalefexpansion</dt>
					<dd>Optional boolean. For BIDI sessions only (Arabic only). whether Lam-Alef expansion is on.</dd>
				</dl>
				<dl>
					<dt class="bold">lamalefcompression</dt>
					<dd>Optional boolean. For BIDI sessions only (Arabic only). whether Lam-Alef compression is on.</dd>
					<dt class="bold">hostid</dt>
					<dd>Optional string. See <button onclick="scrollHere('ma_xfer_hostid')">Specifying a session</button>.</dd>
				</dl>
				<h3 id="wq432">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_filexfer"><span class="figcap">Figure 102. Examples for the &lt;filexfer&gt; element</span>
					<pre class="xmp"><code>&lt;filexfer direction="send" pcfile="'c:\\myfile.txt'"             hostfile="'myfile text A0'"             clear="true" timeout="10000" pccodepage="437" /&gt; </code></pre>
				</div>
			</div>

			<button id="mr_hascript" class="accordian">&lt;HAScript&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq433">General</h3>
				<p>The &lt;HAScript&gt; element is the master element of a macro script.It contains the other elements and specifies global information the macro (see <button onclick="scrollHere('mc2_conceptual_view_macro_script')">Conceptual view of a macro script</button>).</p>
				<p></p>
				<h3 id="wq434">Attributes</h3>
				<dl>
					<dt class="bold">name</dt>
					<dd>Required. The name of the macro. Macro names are case-sensitive!</dd>
					<dt class="bold">description</dt>
					<dd>Optional. Descriptive text about this macro. You should here any information that you want to remember about this macro.</dd>
					<dt class="bold">timeout</dt>
					<dd>Optional integer. The number of milliseconds allowed for recognition. If this timeout value is specified and it is exceeded, then the macro runtime terminates the macro and displays a (see <button onclick="scrollHere('mt_timeout_between_screens')">Timeout Between Screens (Macro tab)</button>). By default the Editor sets this value to 60000 milliseconds (60 seconds).</dd>
					<dt class="bold">pausetime</dt>
					<dd>Optional integer. The delay for the "pause between actions" (see <button onclick="scrollHere('mt_pause_between_actions')">Pause Between Actions (Macro tab)</button>). By default the Editor sets this value to 300 milliseconds.</dd>
					<dt class="bold">promptall</dt>
					<dd>Required boolean. If this attribute is set to true then macro runtime, before performing any action in the first macro screen, collects user input for all the &lt;prompt&gt; elements inside the macro, combining the individual prompts into one large prompt. The <strong>promptall</strong> attribute of the &lt;actions&gt; performs a similar function for all the &lt;prompt&gt; elements in one &lt;actions&gt; element (see <button onclick="scrollHere('mr_actions')">&lt;actions&gt; element</button>).</dd>
					<dt class="bold">author</dt>
					<dd>Optional. The author or authors of this macro.</dd>
					<dt class="bold">creationdate</dt>
					<dd>Optional. Information about the dates and versions of this macro.</dd>
					<dt class="bold">suppressclearevents</dt>
					<dd>Optional boolean (default false). Advanced feature that whether the system should ignore screen events when a host sends a clear screen command immediately followed by an end of indicator in the data stream. You might want to set this value true if you have screens in your application flow that have all in them. If there is a valid blank screen in the macro and clear are not ignored, it is possible that a screen event with all will be generated by clear commands coming from an ill-behaved application. This will cause a screen recognition event to be and the valid blank screen will match when it shouldn't have matched.</dd>
					<dt class="bold">usevars</dt>
					<dd>Required boolean (default false). If this attribute is set true then the macro uses the advanced macro format (see <button onclick="scrollHere('me_choosing_a_format')">Choosing a macro format</button>).</dd>
					<dt class="bold">ignorepauseforenhancedtn</dt>
					<dd>Optional. 3270 Display sessions only. If this attribute is to true then the macro runtime skips all &lt;pause&gt; elements if session is a TN3270E session running in contention-resolution (see <button onclick="scrollHere('mt_attributes_screen_completion')">Attributes that deal with screen completion</button>). To re-a particular &lt;pause&gt; element see the<strong> ignorepauseoverride</strong> of the &lt;pause&gt; element.</dd>
					<dt class="bold">delayifnotenhancedtn</dt>
					<dd>Optional. 3270 Display Sessions only. This attribute a value in milliseconds and has an effect only when the session is<em> not </em> a TN3270E session running in contention-mode. In that situation, this attribute causes the macro runtime add a pause of the specified duration each time the macro receives a notification that the OIA indicator has changed (see <button onclick="scrollHere('mt_attributes_screen_completion')">Attributes that deal with screen completion</button>).</dd>
					<dt class="bold">blockTerminalInput</dt>
					<dd>Optional. When the value of this attribute is true, inputs and mouse clicks are ignored while the macro is playing. events are discarded. There is no indication to the user that is blocked unless you create a Message action to indicate this.</dd>
					<dt class="bold">ignorepausetimeforenhancedtn</dt>
					<dd>The ability to ignore the macro pausetime attribute when in a contention-resolution environment is now available. A new attribute, "ignorepausetimeforenhancedtn", has been added to the &lt;HAScript&gt; macro element. This allows you to ignore both the pausetime attribute in &lt;HAScript&gt; and the pause attribute in &lt;screen&gt;. Possible values for this include: <p><strong>True:</strong> Both the pausetime in &lt;HAScript&gt; and the pause attribute in &lt;screen&gt; are ignored.No pause occurs after input/prompt actions or between screens. is the default value.</p>
						<p><strong>False:</strong> The attribute in &lt;HAScript&gt; and the pause attribute in &lt;screen&gt; are not ignored.</p>
						<p>Note that ignorepausetimeforenhancedtn no effect when running in a non-contention-resolution environment.That is, even if ignorepausetimeforenhancedtn is true, the attribute in &lt;HAScript&gt; and the pause attribute in &lt;screen&gt; will not be ignored if running in a non-contention-resolution environment.</p>
						<p>the "Macro Programming Guide" for information on and delayifnotenhancedtn, two other attributes that affect the that macros are executed in a contention-resolution environment. view or modify the value for ignorepausetimeforenhancedtn, use Code Editor of the Macro Editor.</p>
					</dd>
				</dl>
				<h3 id="wq435">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_hascript"><span class="figcap">Figure 103. Examples for the &lt;HAScript&gt; element</span>
					<pre class="xmp"><code>&lt;HAScript name="ispf_ex2" description="ISPF Sample2" timeout="60000"             pausetime="300" promptall="true" author="Owner"             creationdate="Sun Jun 08 12:04:26 PDT 2003"             supressclearevents="false" usevars="true"             ignorepauseforenhancedtn="false"             delayifnotenhancedtn="0"&gt;    ...&lt;/HAScript&gt;</code></pre>
				</div>
			</div>

			<button id="mr_if" class="accordian">&lt;if&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq436">General</h3>
				<p>The &lt;if&gt; element contains a conditional expression and a of macro actions. The macro runtime evaluates the conditional in the &lt;if&gt; element. Then: </p>
				<ul>
					<li>If the conditional expression is true: 
						<ul>
							<li>The macro runtime performs the sequence of macro actions in the &lt;if&gt; element; and</li>
							<li>The macro runtime skips the following &lt;else&gt; element if is one.</li>
						</ul>
					</li>
					<li>If the conditional expression is false: 
						<ul>
							<li>The macro runtime skips the sequence of macro actions in the &lt;if&gt; element; and</li>
							<li>The macro runtime performs the macro actions in the following &lt;else&gt; element if there is one.</li>
						</ul>
					</li>
				</ul>
				<p>The Macro object uses the &lt;if&gt; element, and if necessary the &lt;else&gt; element, to store a Conditional action (see <button onclick="scrollHere('ma_condition')">Conditional action (&lt;if&gt; element and &lt;else&gt; element)</button>).</p>
				<h3 id="wq437">Attributes</h3>
				<dl>
					<dt class="bold">condition</dt>
					<dd>Required. A conditional expression. The conditional can contain logical operators and conditional operators and can terms that include arithmetic expressions, immediate values, variables, and calls to Java methods (see <button onclick="scrollHere('me_conditional_expressions')">Conditional and logical operators and expressions</button>).</dd>
				</dl>
				<h3 id="wq438">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_if"><span class="figcap">Figure 104. Examples for the &lt;if&gt; element</span>
					<pre class="xmp"><code>&lt;vars&gt;    &lt;create name="$condition1$" type="string"/&gt;    &lt;create name="$condition2$" type="boolean" value="false"/&gt;    &lt;create name="$condition3$" type="integer"/&gt; &lt;/vars&gt; &lt;screen&gt;    &lt;description&gt;         ...   &lt;/description&gt;    &lt;actions promptall="true"&gt;       &lt;extract name="Get condition 1" srow="2" scol="1" erow="2"                ecol="80" assigntovar="$condition1$"/&gt;       &lt;extract name="Get condition 2" srow="3" scol="1" erow="3"                ecol="80" assigntovar="$condition2$"/&gt;       &lt;extract name="Get condition 3" srow="4" scol="1" erow="4"                ecol="80" assigntovar="$condition3$"/&gt;        &lt;if condition=
   			         "(($condition1$ !='')&amp;&amp;                ($condition2$)||($condition3$ &lt; 100))"&gt;            ...      &lt;/if&gt;       &lt;else&gt;            ...      &lt;/else&gt;    &lt;/actions&gt; &lt;/screen&gt;</code></pre>
   			 	</div>
   			 </div>

			<button id="mr_import" class="accordian">&lt;import&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq439">General</h3>
				<p>The &lt;import&gt; element, the &lt;vars&gt; element, and the &lt;screen&gt; element are the three primary structural elements that occur the &lt;HAScript&gt; element (see <button onclick="scrollHere('mc2_conceptual_view_macro_script')">Conceptual view of a macro script</button>).</p>
				<p>The &lt;import&gt; element is optional. It contains &lt;type&gt; each of which declares an imported type based on a Java class (see <button onclick="scrollHere('mv_variables_imported')">Creating an imported type for a Java class</button>).</p>
				<p>The &lt;import&gt; element must occur after the &lt;HAScript&gt; tag and before the &lt;vars&gt; element.</p>
				<h3 id="wq440">Attributes</h3>
				<p>None.</p>
				<h3 id="wq441">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_import_sample"><span class="figcap">Figure 105. Examples for the &lt;import&gt; element</span>
					<pre class="xmp"><code>&lt;HAScript .... &gt;    &lt;import&gt;       &lt;type class="java.util.Properties" name="Properties" /&gt;    &lt;/import&gt;     &lt;vars&gt;       &lt;create name="$prp$" type="Properties" value="$new Properties()$" /&gt;    &lt;/vars&gt; ...&lt;/HAScript&gt;</code></pre>
				</div>
			</div>

			<button id="mr_input" class="accordian">&lt;input&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq442">General</h3>
				<p>The &lt;input&gt; element sends a sequence of keystrokes to the window. The sequence can include keys that display a character (as a, b, c, #, &amp;, and so on) and also action keys (such as [enterreset], [copy], [paste], and others) (see <button onclick="scrollHere('ma_input')">Input action (&lt;input&gt; element)</button>).</p>
				<h3 id="wq443">Attributes</h3>
				<dl>
					<dt class="bold">value</dt>
					<dd>Required string. The sequence of keys to be sent to the window (see <button onclick="scrollHere('ma_input_string')">Input string</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">row</dt>
					<dd>Optional integer (default is the current position of the cursor). Row at which typing begins (see <button onclick="scrollHere('ma_inp_location')">Location at which typing begins</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">col</dt>
					<dd>Optional integer (default is the current position of the cursor). Column at which typing begins (see <button onclick="scrollHere('ma_inp_location')">Location at which typing begins</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">movecursor</dt>
					<dd>Optional boolean (default is true). Setting this attribute true causes the macro runtime to move the text cursor to the end the input (see <button onclick="scrollHere('ma_move_cursor')">Move Cursor to End of Input</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">xlatehostkeys</dt>
					<dd>Optional boolean (default is true). Setting this attribute true causes the macro runtime to interpret the name of an action (such as <samp class="xph">[enter]</samp>) as an action key rather than as a sequence (see <button onclick="scrollHere('ma_input_translate_host_action_keys')">Translate Host Action Keys</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">encrypted</dt>
					<dd>Optional boolean (default is false). Setting this to true causes the Code Editor to encrypt the sequence of keys in the <strong>value</strong> attribute when the Code is closed (see <button onclick="scrollHere('ma_input_password')">Password</button>).</dd>
					<dt class="bold">hostid</dt>
					<dd>Optional string. See <button onclick="scrollHere('ma_input_hostid')">Specifying a session</button>.</dd>
				</dl>
				<h3 id="wq444">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_input"><span class="figcap">Figure 106. Examples for the &lt;input&gt; element</span>
					<pre class="xmp"><code>&lt;input value="'3[enter]'" row="4" column="14" movecursor="true"             xlatehostkeys="true" encrypted="false"/&gt;</code></pre>
				</div>
				<pre class="xmp"><code> </code></pre>
			</div>

			<button id="mr_message" class="accordian">&lt;message&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq445">General</h3>
				<p>The &lt;message&gt; element displays a popup window that a title, a message, and an OK button. The macro runtime waits the user clicks OK before going on to the next action (see <button onclick="scrollHere('ma_message')">Message action (&lt;message&gt; element)</button>).</p>
				<h3 id="wq446">Attributes</h3>
				<dl>
					<dt class="bold">title</dt>
					<dd>Optional string (the default is the macro name). A string be displayed in the caption bar of the popup window.</dd>
				</dl>
				<dl>
					<dt class="bold">value</dt>
					<dd>Required string. The message to be displayed in the popup window.</dd>
				</dl>
				<h3 id="wq447">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_message"><span class="figcap">Figure 107. Examples for the &lt;message&gt; element</span>
					<pre class="xmp"><code>&lt;message title="'Ready'" value="'Ready to process. Click OK to proceed.'" /&gt;</code></pre>
				</div>
			</div>
	
			<button id="mr_mouseclick" class="accordian">&lt;mouseclick&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq448">General</h3>
				<p>The &lt;mouseclick&gt; element simulates a mouse click on the window by the user. As with a real mouse click, the text cursor to the row and column position where the mouse icon was pointing the click occurred (see <button onclick="scrollHere('ma_mouseclick')">Mouse click action (&lt;mouseclick&gt; element)</button>).</p>
				<h3 id="wq449">Attributes</h3>
				<dl>
					<dt class="bold">row</dt>
					<dd>Required integer. The row of the row and column location the session window where the mouse click occurs.</dd>
					<dt class="bold">col</dt>
					<dd>Required integer. The column of the row and column on the session window where the mouse click occurs.</dd>
					<dt class="bold">hostid</dt>
					<dd>Optional string. See <button onclick="scrollHere('ma_mouseclick_hostid')">Specifying a session</button>.</dd>
				</dl>
				<h3 id="wq450">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_mouseclick"><span class="figcap">Figure 108. Examples for the &lt;mouseclick&gt; element</span>
					<pre class="xmp"><code>&lt;mouseclick row="20" col="16" /&gt;</code></pre>
				</div>
				<pre class="xmp"><code> </code></pre>
			</div>

			<button id="cr_nextscreen" class="accordian">&lt;nextscreen&gt; element</button>
				<div class="panel" style="display:none">
				<h3 id="wq451">General</h3>
				<p>The &lt;nextscreen&gt; element specifies the name of a &lt;screen&gt; element (macro screen) that the macro runtime should consider, others, as a candidate to be the next macro screen to be (see <button onclick="scrollHere('ms1_valid_next_screens')">Valid next screens</button>).</p>
				<p>The &lt;nextscreen&gt; element must occur within a &lt;nextscreens&gt; element.</p>
				<h3 id="wq452">Attributes</h3>
				<dl>
					<dt class="bold">name</dt>
					<dd>Required. The name of the &lt;screen&gt; element that is a to be the next macro screen to be processed.</dd>
				</dl>
				<h3 id="wq453">XML samples</h3>
				<p></p>
				<pre class="xmp"><code>   &lt;!--
				   The effect of the following &lt;nextscreens&gt; element and its    is that when the macro runtime finishes performing the actions    the current screen, it adds ScreenS and ScreenG to the runtime list    valid next screens.   --&gt;    &lt;nextscreens&gt;       &lt;nextscreen name="ScreenS"&gt;       &lt;nextscreen name="ScreenG"&gt;    &lt;/nextscreens&gt;    </code></pre>
			</div>

			<button id="cr_nextscreens" class="accordian">&lt;nextscreens&gt; element</button>
				<div class="panel" style="display:none">
				<h3 id="wq454">General</h3>
				<p>The &lt;actions&gt; element, the &lt;description&gt; element, and the &lt;nextscreens&gt; element are the three primary structural elements that occur the &lt;screen&gt; element (see <button onclick="scrollHere('mc2_macro_screen_conceptual')">Conceptual view of a macro screen</button>).</p>
				<p>The &lt;nextscreens&gt; element contains &lt;nextscreen&gt; elements, each of which states the name of a macro screen that can validly after the current macro screen (see <button onclick="scrollHere('mn_links')">Screen Recognition, Part 2</button>).</p>
				<h3 id="wq455">Attributes</h3>
				<dl>
					<dt class="bold">timeout</dt>
					<dd>Optional integer. The value in milliseconds of the screen timeout. The macro runtime terminates the macro if it cannot a macro screen whose name is on the runtime list of valid next to the application screen before this timeout expires (see <button onclick="scrollHere('mt_screen_recog_timeout')">Timeout settings for screen recognition</button>).</dd>
				</dl>
				<h3 id="wq456">XML samples</h3>
				<p></p>
				<pre class="xmp"><code>   &lt;!--
				   The effect of the following &lt;nextscreens&gt; element and its    is that when the macro runtime finishes performing the actions    the current screen, it will attempt to recognize ScreenS and ScreenG.   --&gt;    &lt;nextscreens&gt;       &lt;nextscreen name="ScreenS"&gt;       &lt;nextscreen name="ScreenG"&gt;    &lt;/nextscreens&gt;    </code></pre>
			</div>

			<button id="mr_numfields" class="accordian">&lt;numfields&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq457">General</h3>
				<p>The &lt;numfields&gt; element is a descriptor that states the of 3270 or 5250 fields of all types that exist in the session (see <button onclick="scrollHere('md1_numfields')">Number of Fields descriptor (&lt;numfields&gt; element)</button>).</p>
				<h3 id="wq458">Attributes</h3>
				<dl>
					<dt class="bold">number</dt>
					<dd>Required integer. The number of fields in the session window.</dd>
					<dt class="bold">optional</dt>
					<dd>Optional boolean (the default is false). See <button onclick="scrollHere('md1_optional')">Optional</button>.</dd>
					<dt class="bold">invertmatch</dt>
					<dd>Optional boolean (the default is false). See <button onclick="scrollHere('md1_inverse_descriptor')">Inverse Descriptor</button>.</dd>
					<dt class="bold">hostid</dt>
					<dd>Optional string. See <button onclick="scrollHere('md1_numfields_hostid')">Specifying a session</button>.</dd>
				</dl>
				<h3 id="wq459">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_numfields"><span class="figcap">Figure 109. Examples for the &lt;numfields&gt; element</span>
					<pre class="xmp"><code>&lt;numfields number="10" optional="false" invertmatch="false" /&gt;</code></pre>
				</div>
			</div>

			<button id="mr_numinputfields" class="accordian">&lt;numinputfields&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq460">General</h3>
				<p>The &lt;numinputfields&gt; element is a descriptor that states number of 3270 or 5250 input fields that exist in the session (see <button onclick="scrollHere('md1_numinputfields')">Number of Input Fields descriptor (&lt;numinputfields&gt; element)</button>).</p>
				<h3 id="wq461">Attributes</h3>
				<dl>
					<dt class="bold">number</dt>
					<dd>Required integer. The number of fields in the session window.</dd>
					<dt class="bold">optional</dt>
					<dd>Optional boolean (the default is false). See <button onclick="scrollHere('md1_optional')">Optional</button>.</dd>
					<dt class="bold">invertmatch</dt>
					<dd>Optional boolean (the default is false). See <button onclick="scrollHere('md1_inverse_descriptor')">Inverse Descriptor</button>.</dd>
					<dt class="bold">hostid</dt>
					<dd>Optional string. See <button onclick="scrollHere('md1_numinputfields_hostid')">Specifying a session</button>.</dd>
				</dl>
				<h3 id="wq462">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_numinputfields"><span class="figcap">Figure 110. Examples for the &lt;numinputfields&gt; element</span>
					<pre class="xmp"><code>&lt;numinputfields number="10" optional="false" invertmatch="false" /&gt;</code></pre>
				</div>
				<pre class="xmp"><code> </code></pre>
			</div>

			<button id="mr_oia" class="accordian">&lt;oia&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq463">General</h3>
				<p>The &lt;oia&gt; element is a descriptor that describes the state the input inhibited indicator in the session window (see <button onclick="scrollHere('md1_oia')">Wait for OIA to Become Uninhibited descriptor (&lt;oia&gt; element)</button>).</p>
				<h3 id="wq464">Attributes</h3>
				<dl>
					<dt class="bold">status</dt>
					<dd>Required. The value can be: 
						<ul>
							<li><p>The macro runtime evaluates the descriptor as if the input inhibited indicator is cleared, or false if the inhibited indicator is set.</p></li>
							<li><p>The macro runtime always evaluates the descriptor true.</p></li>
							<li>An expression that evaluates to either NOTINHIBITED or <p>macro runtime evaluates the expression and then, depending on result, evaluates the descriptor as usual.</p></li>
						</ul>
					</dd>
					<dt class="bold">optional</dt>
					<dd>Optional boolean (the default is false). See <button onclick="scrollHere('md1_optional')">Optional</button>.</dd>
					<dt class="bold">invertmatch</dt>
					<dd>Optional boolean. See <button onclick="scrollHere('md1_inverse_descriptor')">Inverse Descriptor</button>.</dd>
					<dt class="bold">hostid</dt>
					<dd>Optional string. See <button onclick="scrollHere('md1_oia_hostid')">Specifying a session</button>.</dd>
				</dl>
				<h3 id="wq465">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_oia"><span class="figcap">Figure 111. Examples for the &lt;oia&gt; element</span>
					<pre class="xmp"><code>&lt;oia status="NOTINHIBITED" optional="false" invertmatch="false" /&gt;</code></pre>
				</div>
			</div>

			<button id="cr_pause" class="accordian">&lt;pause&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq466">General</h3>
				<p>The &lt;pause&gt; element waits for the specified number of (see <button onclick="scrollHere('ma_pause')">Pause action (&lt;pause&gt; element)</button>).</p>
				<h3 id="wq467">Attributes</h3>
				<dl>
					<dt class="bold">value</dt>
					<dd>Optional integer. The number of milliseconds to wait. If do not specify this attribute then the Macro object will add the "value=10000" (10 seconds) to the element when it saves the script.</dd>
					<dt class="bold">ignorepauseoverride</dt>
					<dd>Optional boolean (the default is false). For 3270 Display only. Setting this attribute to true causes the macro runtime to the &lt;pause&gt; element even if the <strong>ignorepauseforenhancedtn</strong> of the &lt;HAScript&gt; element is set to true (see <button onclick="scrollHere('mt_attributes_screen_completion')">Attributes that deal with screen completion</button>).</dd>
				</dl>
				<h3 id="wq468">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_pause"><span class="figcap">Figure 112. Examples for the &lt;pause&gt; element</span>
					<pre class="xmp"><code>&lt;pause timeout="5000"&gt;   </code></pre>
				</div>
			</div>

			<button id="mr_perform" class="accordian">&lt;perform&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq469">General</h3>
				<p>The &lt;perform&gt; element invokes a method belonging to a Java that you have imported (see <button onclick="scrollHere('mv_variables_imported')">Creating an imported type for a Java class</button>).</p>
				<p>You can invoke a method in many other contexts besides the &lt;perform&gt; element. However, the &lt;perform&gt; element is useful when you to invoke a method that does not return a value (see <button onclick="scrollHere('ma_perform')">Perform action (&lt;perform&gt; element)</button>).</p>
				<h3 id="wq470">Attributes</h3>
				<dl>
					<dt class="bold">value</dt>
					<dd>Required. You must enclose a method call in dollar signs ($), just as you would a variable (see <button onclick="scrollHere('mv_syntax_of_method_calls')">Syntax of a method call</button>).You should specify the parameters, if any, of the method call in same format that you would use if you were creating a Perform in the Macro Editor.</dd>
				</dl>
				<h3 id="wq471">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_perform"><span class="figcap">Figure 113. Examples for the &lt;perform&gt; element</span>
					<pre class="xmp"><code>&lt;!-- Call the update() method associated with the class to      importedVar belongs (such as mypackage.MyClass).--&gt; &lt;perform value="$importedVar.update( 5, 'Application', $str$)$" /&gt;</code></pre>
				</div>
			</div>

			<button id="mr_playmacro" class="accordian">&lt;playmacro&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq472">General</h3>
				<p>The &lt;playmacro&gt; element terminates the current macro and another macro (see <button onclick="scrollHere('ma_playmacro')">PlayMacro action (&lt;playmacro&gt; element)</button>). This process is chaining macros.</p>
				<p>There are restrictions on where in the &lt;actions&gt; element can place a &lt;playmacro&gt; element (see <button onclick="scrollHere('ma_pm_adding_a_playmacro_action')">Adding a PlayMacro action</button>).</p>
				<p>If you are using the Host Access Toolkit then you need to the following actions:</p>
				<ul>
					<li>Use the <strong>MacroManager</strong> bean or implement own <strong>MacroIOProvider</strong> class. Only managed can be chained.</li>
					<li>Assign a name to the macro. Macros are chained by macro name.Macro names are case-sensitive!</li>
				</ul>
				<h3 id="wq473">Attributes</h3>
				<dl>
					<dt class="bold">name</dt>
					<dd>Required. The name of the target macro. The target macro reside in the same location as the calling macro (see <button onclick="scrollHere('ma_pm_name_and_starting_screen')">Target macro file name and starting screen</button>). Macro names are case-sensitive!</dd>
				</dl>
				<dl>
					<dt class="bold">startscreen</dt>
					<dd>Optional. The name of the macro screen (&lt;screen&gt; element) at which you want the macro runtime to start processing the macro. Use the value *DEFAULT* or omit this parameter to have macro runtime start at the usual starting screen of the target macro.</dd></dl>
				<dl>
					<dt class="bold">transfervars</dt>
					<dd>Required. Setting this attribute to <samp class="xph">Transfer</samp> the macro runtime to transfer the variables belonging to the macro to the target macro (see <button onclick="scrollHere('ma_transferring_variables')">Transferring variables</button>).The default is <samp class="xph">No Transfer</samp>.</dd>
				</dl>
				<h3 id="wq474">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_playmacro"><span class="figcap">Figure 114. Examples for the &lt;playmacro&gt; element</span>
					<pre class="xmp"><code>&lt;playmacro name="ispf_ex1.mac" startscreen="ScreenA"                  transfervars="Transfer" /&gt;</code></pre>
				</div>
			</div>

			<button id="cr_print" class="accordian">&lt;print&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq475">General</h3>
				<p>The &lt;print&gt; element provides printing functions. Three print actions (start, extract, and end) are specified through the <strong> action </strong> attribute (see <button onclick="scrollHere('ma_print')">Print actions (&lt;print&gt; element)</button>).</p>
				<h3 id="wq476">Attributes</h3>
				<dl>
					<dt class="bold">action</dt>
					<dd>Required. The print action to be performed. Must be one of following: <samp class="xph">start</samp>, <samp class="xph">extract</samp>, <samp class="xph">end</samp>. 
						<ul>
							<li><samp class="xph">start</samp>: <p>The macro runtime instantiates a print object for the current macro using the Printer Setup options and Setup options that you specify (see <button onclick="scrollHere('ma_pr_print_start')">Print Start</button>).</p> <p>of the great number of printer setup options and page setup options, and because changing one option might require several other to be adjusted, you should not use the macro language to specify setup options and page setup options. Instead, use the Macro to create a Print start action and use the Printer Setup and Setup windows to specify these options (see <button onclick="scrollHere('ma_pr_printer_setup_and_page_setup')">Printer Setup and Page Setup</button>).</p></li>
							<li><samp class="xph">extract</samp>: <p>The macro runtime copies the text from rectangular area of the session window that you specify and the text to the current print bean (see <button onclick="scrollHere('ma_pr_print_extract')">Print Extract</button>).</p></li>
							<li><samp class="xph">end</samp>: <p>The macro runtime terminates the print if one exists (see <button onclick="scrollHere('ma_pr_print_end')">Print End</button>).</p></li>
						</ul>
					</dd>
					<dt class="bold">srow</dt>
					<dd>Required integer when <strong>action</strong> is <samp class="xph">extract</samp>.The row of the first pair of row and column coordinates for the area of text to be printed.</dd>
					<dt class="bold">scol</dt>
					<dd>Required integer when <strong>action</strong> is <samp class="xph">extract</samp>.The column of the first pair of row and column coordinates for rectangular area of text to be printed.</dd>
					<dt class="bold">erow</dt>
					<dd>Required integer when <strong>action</strong> is <samp class="xph">extract</samp>.The row of the second pair of row and column coordinates for the area of text to be printed.</dd>
					<dt class="bold">ecol</dt>
					<dd> Required integer when <strong>action</strong> is <samp class="xph">extract</samp>.The column of the second pair of row and column coordinates for rectangular area of text to be printed.</dd>
					<dt class="bold">assigntovar</dt>
					<dd>Optional variable. Specifies the name of a variable to the return code from the print action.</dd>
					<dt class="bold">hostid</dt>
					<dd>Optional string. This attribute is available only when the <strong>action</strong> is <samp class="xph">extract</samp>. See <button onclick="scrollHere('ma_pr_print_extract_hostid')">Specifying a session</button>.</dd>
				</dl>
				<h3 id="wq477">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_print"><span class="figcap">Figure 115. Examples for the &lt;print&gt; element</span>
					<pre class="xmp"><code>&lt;print action="start" assigntovar="$intReturnCode$" /&gt; &lt;print action="extract" srow="1" scol="1" erow="-1" ecol="-1"  /&gt; &lt;print action="end" /&gt;</code></pre>
				</div>
			</div>

			<button id="mr_prompt" class="accordian">&lt;prompt&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq478">General</h3>
				<p>The &lt;prompt&gt; element displays a popup window prompting the for input, waits for the user to click OK, and then sends the to the session window (see <button onclick="scrollHere('ma_prompt')">Prompt action (&lt;prompt&gt; element)</button>).</p>
				<h3 id="wq479">Attributes</h3>
				<dl>
					<dt class="bold">name</dt>
					<dd>Optional string. The text that is to be displayed in the window, such as <samp class="xph">'Enter your response here:'</samp> (see <button onclick="scrollHere('ma_prompt_parts')">Parts of the prompt window</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">description</dt>
					<dd>Optional string. A description of this action. This is not displayed (see <button onclick="scrollHere('ma_prompt_parts')">Parts of the prompt window</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">row</dt>
					<dd>Required integer. The row on the session window at which want the macro runtime to start typing the input from the user.</dd>
				</dl>
				<dl>
					<dt class="bold">col</dt>
					<dd>Required integer. The column on the session window at you want the macro runtime to start typing the input from the (see <button onclick="scrollHere('ma_prompt_handling_input_sequence')">Handling the input sequence in the session window</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">len</dt>
					<dd>Required integer.  The number of characters that the user allowed to enter into the prompt input field (see <button onclick="scrollHere('ma_prompt_response_length')">Response Length</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">default</dt>
					<dd>Optional string. The text to be displayed in the input of the popup window. If the user does not type any input into input field but just clicks OK, the macro runtime will send this input to the session window (see <button onclick="scrollHere('ma_prompt_default_response')">Default Response</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">clearfield</dt>
					<dd>Optional boolean. Setting this attribute to true causes macro runtime, before sending the input sequence to the session window, to clear the input field of the session window in which the row column location occur (see <button onclick="scrollHere('ma_prompt_handling_input_sequence')">Handling the input sequence in the session window</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">encrypted</dt>
					<dd>Optional boolean. Setting this attribute to true causes macro runtime, when the user types a key into the input field of window, to display an asterisk (*) instead of the character with the key (see <button onclick="scrollHere('ma_prompt_password_response')">Password Response</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">movecursor</dt>
					<dd>Optional boolean. Setting this attribute to true causes macro runtime to move the cursor to the end of the input (see <button onclick="scrollHere('ma_prompt_handling_input_sequence')">Handling the input sequence in the session window</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">xlatehostkeys</dt>
					<dd>Optional boolean. Setting this attribute to true causes macro runtime to interpret the names of action keys (such as <samp class="xph">[enter]</samp>) as action keys rather than as sequences of characters (see <button onclick="scrollHere('ma_prompt_translate_action_keys')">Action keys and Translate Host Action Keys</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">assigntovar</dt>
					<dd>Optional variable name. Setting this attribute to a name causes the macro runtime to store the input into the whose name you specify here (see <button onclick="scrollHere('ma_prompt_assigning_seq_to_var')">Assigning the input sequence to a variable</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">varupdateonly</dt>
					<dd>Optional boolean. Setting this attribute to true causes macro runtime to store the input into a variable and not to send to the session window (see <button onclick="scrollHere('ma_prompt_handling_input_sequence')">Handling the input sequence in the session window</button>). This attribute effect only if the <strong>assigntovar</strong> attribute set to true.</dd>
				</dl>
				<dl>
					<dt class="bold">required</dt>
					<dd>Optional boolean. Setting this attribute to true causes macro runtime to disable the OK button in the prompt window the input field of the prompt window contains text. The input can contain text either because you have specified a Default or because the user has typed text into the input field (see <button onclick="scrollHere('ma_prompt_require_response')">Require Response</button>).</dd>
					<dt class="bold">hostid</dt>
					<dd>Optional string. See <button onclick="scrollHere('ma_prompt_hostid')">Specifying a session</button>.</dd>
				</dl>
				<h3 id="wq480">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_prompt"><span class="figcap">Figure 116. Example for the &lt;prompt&gt; element</span>
					<pre class="xmp"><code>&lt;prompt name="'ID'" row="1" col="1" len="8" description="'ID for Logon'"         default="'guest'" clearfield="true" encrypted="true"         assigntovar="$userID$" varupdateonly="true" required="true"/&gt; </code></pre>
				</div>
			</div>

			<button id="mr_recolimit" class="accordian">&lt;recolimit&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq481">General</h3>
				<p>The &lt;recolimit&gt; element is an optional element that occurs a &lt;screen&gt; element, at the same level as the &lt;description&gt;, &lt;actions&gt;, and &lt;nextscreens&gt; elements (see <button onclick="scrollHere('mn_recolimit')">Recognition limit (General tab of the Screens tab)</button>).</p>
				<p>The &lt;recolimit&gt; element allows you to take action if the runtime processes the macro screen in which this element occurs than some specified number of times.</p>
				<h3 id="wq482">Attributes</h3>
				<dl>
					<dt class="bold">value</dt>
					<dd>Required integer. The recognition limit. If the macro recognizes the macro screen this many times, then the macro does not process the actions of this macro screen but instead the specified action.</dd>
				</dl>
				<dl>
					<dt class="bold">goto</dt>
					<dd>Optional string (the default is for the macro runtime to an error message and terminate the macro). The name of a macro that you want the macro runtime to start processing when the limit is reached.</dd>
				</dl>
				<h3 id="wq483">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_recolimit"><span class="figcap">Figure 117. Examples for the &lt;recolimit</span>
					<pre class="xmp"><code>&lt;recolimit value="1" goto="RecoveryScreen1" /&gt;</code></pre>
				</div>
			</div>

			<button id="mr_runprogram" class="accordian">&lt;runprogram&gt; element</button>
			<div class="panel" style="display:none">
				d<h3 id="wq484">General</h3>
				d<p>The &lt;runprogram&gt; element launches a native application and waits for it to terminate. You can provide input parameters for application and store the return code into a variable (see <button onclick="scrollHere('ma_runprogram')">Run program action (&lt;runprogram&gt; element)</button>).</p>
				d<h3 id="wq485">Attributes</h3>
				d<dl>
				d	<dt class="bold">exe</dt>
				d	<dd>Required string. The path and name of the native (see <button onclick="scrollHere('ma_rp_launching')">Launching the native application</button>).</dd>
				d</dl>
				d<dl>
				d	<dt class="bold">param</dt>
				d	<dd>Optional string. Any arguments that should be specified the native application is launched.</dd>
				d</dl>
				d<dl>
				d	<dt class="bold">wait</dt>
				d	<dd>Optional boolean. Setting this attribute to true causes macro runtime to wait until the native application terminates.</dd>
				d</dl>
				d<dl>
				d	<dt class="bold">assignexitvalue</dt>
				d	<dd>Optional variable. The name of a variable into which the value from native application should be stored.</dd>
				d</dl>
				d<h3 id="wq486">XML samples</h3>
				d<p></p>
				d<div class="figrules" id="mr_fig_"><span class="figcap">Figure 118. Examples for the &lt;runprogram&gt; element</span>
				d	<pre class="xmp"><code>&lt;runprogram exe=
				d      "’%ProgramFiles%\Windows NT\Accessories\wordpad.exe’"       param="’c:\\tm\\new_file.doc’" wait="true"       assignexitvalue="$intReturn$" /&gt; &lt;message title="" value="’Return value is ’+
				d         $intReturn$" /&gt;</code></pre>
				d</div>
			</div>

			<button id="mr_screen" class="accordian">&lt;screen&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq487">General</h3>
				<p>The &lt;screen&gt; element, the &lt;import&gt; element, and the &lt;vars&gt; element are the three primary structural elements that occur the &lt;HAScript&gt; element (see <button onclick="scrollHere('mc2_conceptual_view_macro_script')">Conceptual view of a macro script</button>).</p>
				<p>Multiple screen elements can occur inside a macro. One &lt;screen&gt; element contains all the information for one macro screen (see <button onclick="scrollHere('mc2_macro_screen_group')">The macro screen and its subcomponents</button>).</p>
				<p>The &lt;screen&gt; element contains three primary structural elements: the &lt;actions&gt; element, the &lt;description&gt; element, and &lt;nextscreens&gt; (see <button onclick="scrollHere('mc2_macro_screen_conceptual')">Conceptual view of a macro screen</button>).</p>
				<h3 id="wq488">Attributes</h3>
				<dl>
					<dt class="bold">name</dt>
					<dd>Required. The name of this &lt;screen&gt; element (macro screen).The name must not be the same as the name of an already existing &lt;screen&gt; element.</dd>
					<dt class="bold">entryscreen</dt>
					<dd>Optional boolean (the default is false). Setting this to true causes the macro runtime to treat this &lt;screen&gt; as a valid beginning screen for the macro (see <button onclick="scrollHere('mn_entry_screen')">Entry screens</button>).</dd>
					<dt class="bold">exitscreen</dt>
					<dd>Optional boolean (the default is false).  Setting this to true causes the macro runtime to treat this &lt;screen&gt; as a valid ending screen for the macro (see <button onclick="scrollHere('mn_exit_screen')">Exit screens</button>).</dd>
					<dt class="bold">transient</dt>
					<dd>Optional boolean (the default is false). Setting this to true causes the macro runtime to treat this &lt;screen&gt; as a screen that can appear at any time and that always needs to cleared (see <button onclick="scrollHere('mn_transient_screen')">Transient screens</button>).</dd>
					<dt class="bold">pause</dt>
					<dd>Optional integer (the default is -1). Specifying a value milliseconds for this attribute causes the macro runtime, for this &lt;screen&gt; element, to ignore the default delay for the "pause between actions" (set using the <strong>pausetime</strong> attribute of the &lt;HAScript&gt; element) and to use this value instead (see <button onclick="scrollHere('mt_set_pause_time')">Set Pause Time (General tab of the Screens tab)</button>).</dd>
				</dl>
				<h3 id="wq489">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_screen"><span class="figcap">Figure 119. Examples for the &lt;screen&gt; element</span>
					<pre class="xmp"><code>&lt;screen name="ScreenB" entryscreen="false" exitscreen="false"             transient="false"&gt;    &lt;description&gt;       ...   &lt;/description&gt;    &lt;actions&gt;       ...   &lt;/actions&gt;    &lt;nextscreens&gt;       ...   &lt;/nextscreens&gt; &lt;/screen&gt;   </code></pre>
				</div>
				<pre class="xmp"><code> </code></pre>
			</div>

			<button id="mr_sqlquery" class="accordian">&lt;sqlquery&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq490">General</h3>
				<p>The &lt;sqlquery&gt; element sends an SQL statement to a database, retrieves the data resulting from the SQL statement, if any, and either stores the data into a global variable, writes the data a file, or displays the data (see <button onclick="scrollHere('ma_sqlquery')">SQLQuery action (&lt;sqlquery&gt; element)</button>).</p>
				<h3 id="wq491">Attributes</h3>
				<dl>
					<dt class="bold">url</dt>
					<dd>Required string. The database URL for the database server which the SQL statement is sent, such as <samp class="xph">jdbc:as400://myISeries</samp> (see <button onclick="scrollHere('ma_sql_database_url')">Database URL</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">driver</dt>
					<dd>Required string. The fully qualified package name of the used to connect with the database server, such as <samp class="xph">COM.ibm.db2.jdbc.app.DB2DRIVER</samp>.This package must be present on the client workstation (see <button onclick="scrollHere('ma_sql_driver_identifier')">Driver Identifier and Driver Class</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">userid</dt>
					<dd>Optional string. The user ID required to access the database, if one is required (see <button onclick="scrollHere('ma_sql_uid')">User ID and Password</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">password</dt>
					<dd>Optional string. The password required to access the database, if one is required (see <button onclick="scrollHere('ma_sql_uid')">User ID and Password</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">statement</dt>
					<dd>Required string. The SQL statement (see <button onclick="scrollHere('ma_sql_statement')">Statement</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">outputtype</dt>
					<dd>Required integer. The destination where the data resulting the SQL statement is to be directed. Valid values are: 
						<ul>
							<li>0 - The data is stored in the global variable $HMLSQLUtil$. can retrieve the data by calling methods on the variable (see <button onclick="scrollHere('ma_sql_dest_globalvar')">Storing the data into a global ($HMLSQLUtil$)</button>).</li>
							<li>1 - The data is written into a file (see<button onclick="scrollHere('ma_sql_dest_file')">Writing the data into a file</button> ). When you use this output type, you also specify the following attributes: 
								<ul>
									<li><strong>outfilename</strong></li>
									<li><strong>outfiletype</strong></li>
									<li><strong>overwrite</strong></li>
									<li><strong>inbrowser</strong></li>
								</ul>
							</li>
							<li>2 - The data is displayed on the workstation monitor (see <button onclick="scrollHere('ma_sql_dest_display')">Displaying the data</button>). When you use this output type, must also specify the following attribute: 
								<ul>
									<li><strong>holdondisplay</strong></li>
								</ul>
							</li>
						</ul>
					</dd>
				</dl>
				<dl>
					<dt class="bold">outfilename</dt>
					<dd>String (required when <strong>outputtype</strong> is 1).The complete path and name of the output file (see <button onclick="scrollHere('ma_sql_dest_file')">Writing the data into a file</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">outfiletype</dt>
					<dd>Integer (required when <strong>outputtype</strong> is 1).The type of the output file (see <button onclick="scrollHere('ma_sql_dest_file')">Writing the data into a file</button>).Valid values are: 
						<ul>
							<li>0 - ASCII text (*.txt)</li>
							<li>1 - Comma Separated Values (*.csv)</li>
							<li>2 - Lotus 1-2-3 (*.wk1)</li>
							<li>3 - Microsoft Excel BIFF3 (*.xls)</li>
							<li>4 - Microsoft Excel BIFF4 (*.xls)</li>
							<li>5 - XML (*.xml)</li>
							<li>6 - HTML (*.html)</li>
						</ul>
					</dd>
				</dl>
				<dl>
					<dt class="bold">overwrite</dt>
					<dd>Boolean (required when <strong>outputtype</strong> is 1).Whether to overwrite the file or append to it (see <button onclick="scrollHere('ma_sql_dest_file')">Writing the data into a file</button>).
						<ul>
							<li>Setting this attribute to true causes the specified file, if exists, to be overwritten with the data. If the file does not then it is created.</li>
							<li>Setting this attribute to false causes data to be appended the specified file, if it exists. If the file does not exist it is created.</li>
						</ul>
					</dd>
				</dl>
				<dl>
					<dt class="bold">inbrowser</dt>
					<dd>Boolean (required when <strong>outputtype</strong> is 1).Setting this attribute to true causes the macro runtime, after the data into the specified file, to display the file's contents the default browser (see <button onclick="scrollHere('ma_sql_dest_file')">Writing the data into a file</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">holdondisplay</dt>
					<dd>Boolean (required when <strong>outputtype</strong> is 2).Setting this attribute to true causes the macro runtime, after the data, to wait for a response from the end user before to process the next macro action (see <button onclick="scrollHere('ma_sql_dest_display')">Displaying the data</button>).</dd>
				</dl>
				<dl>
					<dt class="bold">mlprops</dt>
					<dd>Optional string. This attribute contains the file settings when <strong>outfiletype</strong> is 5 (XML) or 6 (HTML). The format this attribute is: <pre class="xmp"><code>mlprops="<em>key1</em>@@<em>value1</em>@@<em>key2</em>@@<em>value2</em>@@<em>key3</em>@@<em>value3</em>"</code></pre>where <em>key1</em>, <em>key2</em>, <em>key3</em>, and so on are the names of HTML or XML settings, and where <em>value1</em>, <em>value2</em>, <em>value3</em>, and so on are the values of the HTML XML settings. Although you can use the Code Editor to modify the of this attribute manually, IBM recommends that you modify these by changing the corresponding settings in the SQL Wizard and the values to the Macro Editor (see <button onclick="scrollHere('ma_sqlquery_using_sql_wizard')">Using the SQL Wizard</button>).</dd>
				</dl>
				<h3 id="wq492">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_sqlquery"><span class="figcap">Figure 120. Examples for the &lt;sqlquery&gt; element</span>
					<pre class="xmp"><code>&lt;sqlquery url="'jdbc:as400://elcrtp06'"     driver="'com.ibm.as400.access.AS400JDBCDriver'"    userid="'myuser'"    password="Ex0bRtrf73mPrwGrWMT+/g=="    statement="'SELECT * FROM HODTEST WHERE ((HODTEST.DESCRIPT is not null))'"    outputtype="1"    outfilename="'MyFile'"    outfiletype="4"    overwrite="true"     inbrowser="false" /&gt;                                       </code></pre>
				</div>
			</div>

			<button id="mr_string" class="accordian">&lt;string&gt; element</button>
			<div class="panel" style="display:none">
				d<h3 id="wq493">General</h3>
				d<p>The &lt;string&gt; element is a descriptor that specifies a of characters and a rectangular area of the session window in the sequence occurs (see <button onclick="scrollHere('md1_string')">String descriptor (&lt;string&gt; element)</button>).</p>
				d<p>The sequence of characters can occur anywhere in the block.</p>
				d<h3 id="wq494">Attributes</h3>
				d<dl>
				d	<dt class="bold">value</dt>
				d	<dd>Required string. The sequence of characters.</dd>
				d	<dt class="bold">row</dt>
				d	<dd>Optional integer (the default is to search the entire screen).The row location of one corner of a rectangular block of text.</dd>
				d	<dt class="bold">col</dt>
				d	<dd>Optional integer. The column location of one corner of a block of text.</dd>
				d	<dt class="bold">erow</dt>
				d	<dd>Optional integer. The row location of the opposite corner a rectangular block of text.</dd>
				d	<dt class="bold">ecol</dt>
				d	<dd>Optional integer. The column location of the opposite of a rectangular block of text.</dd>
				d	<dt class="bold">casesense</dt>
				d	<dd>Optional boolean (the default is false). Setting this to true causes the macro runtime to do a case-sensitive string compare.</dd>
				d	<dt class="bold">wrap</dt>
				d	<dd>Optional boolean (the default is false). 
				d		<ul>
				d			<li>Setting this attribute to false causes the macro runtime to for the sequence of characters in each separate row of the block of text. If the sequence of characters wraps from one row the next, the macro runtime will not find it.</li>
				d			<li>Setting this attribute to true causes the macro runtime to for the sequence of characters occurring in any row or wrapping one row to the next of the rectangular block of text (see <button onclick="scrollHere('md_wrap_option')">How the macro runtime searches the rectangular area (Wrap option)</button>).</li>
				d		</ul>
				d	</dd>
				d	<dt class="bold">optional</dt>
				d	<dd>Optional boolean (the default is false). See <button onclick="scrollHere('md1_optional')">Optional</button>.</dd>
				d	<dt class="bold">invertmatch</dt>
				d	<dd>Optional boolean. See <button onclick="scrollHere('md1_inverse_descriptor')">Inverse Descriptor</button>.</dd>
				d	<dt class="bold">hostid</dt>
				d	<dd>Optional string. See <button onclick="scrollHere('md1_string_hostid')">Specifying a session</button>.</dd>
				d</dl>
				d<h3 id="wq495">XML samples</h3>
				d<p></p>
				d<div class="figrules" id="mr_fig_string"><span class="figcap">Figure 121. Examples for the &lt;string&gt; element</span>
				d	<pre class="xmp"><code>   &lt;!-- The string must occur in one specific area of a single row  --&gt;    &lt;string value="'Utility Selection Panel'" row="3" col="28"                erow="3" ecol="51" casesense="false" wrap="false"                optional="false" invertmatch="false" /&gt;     &lt;!-- The string can occur in any single row of the session area --&gt;    &lt;string value="'Utility Selection Panel'" row="1" col="1"                erow="-1" ecol="-1" casesense="false" wrap="false"                optional="false" invertmatch="false" /&gt;</code></pre>
				d</div>
				d<pre class="xmp"><code> </code></pre>
			</div>

			<button id="mr_trace" class="accordian">&lt;trace&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq496">General</h3>
				<p>The &lt;trace&gt; element sends a trace message to a trace that you specify, such as the Java console (see <button onclick="scrollHere('ma_trace')">Trace action (&lt;trace&gt; element)</button>).</p>
				<h3 id="wq497">Attributes</h3>
				<dl>
					<dt class="bold">type</dt>
					<dd>Required. The destination for the trace data. The must be one of the following: 
						<ul>
							<li>HODTRACE: The Host On-Demand Trace Facility.</li>
							<li>USER: A user trace handler.</li>
							<li>SYSOUT: The Java console.</li>
						</ul>
					</dd>
					<dt class="bold">value</dt>
					<dd>Required string. The string that is to be sent to the destination.</dd>
				</dl>
				<h3 id="wq498">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_trace"><span class="figcap">Figure 122. Examples for the &lt;trace&gt; element</span>
					<pre class="xmp"><code>&lt;trace type="SYSOUT" value="’The value is ’+$strData$" /&gt;</code></pre>
				</div>
			</div>

			<button id="cr_type_cmd" class="accordian">&lt;type&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq499">General</h3>
				<p>The &lt;type&gt; element declares an imported type (such as <samp class="xph">Properties</samp>) that represents a Java class (such as <samp class="xph">java.util.Properties</samp>).After you have declared the type, you can create variables based the type, create an instance of the Java class, and call methods the instance (see <button onclick="scrollHere('mv_variables_imported')">Creating an imported type for a Java class</button>).</p>
				<p>A type can also be used for directly calling static methods (need to instantiate).</p>
				<p>The &lt;type&gt; element must occur inside a &lt;import&gt; element.</p>
				<h3 id="wq500">Attributes</h3>
				<dl>
					<dt class="bold">class</dt>
					<dd>Required. The fully qualified class name of the class imported, including the package name if any (such as <samp class="xph">java.util.Properties</samp>).</dd>
					<dt class="bold">name</dt>
					<dd>Optional. A short name (such as <samp class="xph">Properties</samp>) you can use elsewhere in the macro to refer to the imported type.If you do not specify a short name, then the short name is the as the fully qualified class name. There are a few restrictions the spelling of type names (see <button onclick="scrollHere('mv_var_and_type_names')">Variable names and type names</button>).</dd>
				</dl>
				<h3 id="wq501">XML samples</h3>
				<p></p>
				<pre class="xmp"><code>   &lt;import&gt;       &lt;type class="java.util.Date" name="Date"/&gt;       &lt;type class="java.io.FileInputStream"/&gt;       &lt;type class="com.ibm.eNetwork.beans.HOD.HODBean" name="HODBean"/&gt;       &lt;type class="myPackage.MyClass" name="MyClass"/&gt;    &lt;/import&gt;       </code></pre>
			</div>

			<button id="mr_vars" class="accordian">&lt;vars&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq502">General</h3>
				<p>The &lt;vars&gt; element, the &lt;import&gt; element, and the &lt;screen&gt; element are the three primary structural elements that occur the &lt;HAScript&gt; element (see <button onclick="scrollHere('mc2_conceptual_view_macro_script')">Conceptual view of a macro script</button>).</p>
				<p>The &lt;vars&gt; element is optional. It contains &lt;create&gt; elements, each of which declares and initializes a variable (see <button onclick="scrollHere('mv_creating_new_variable')">Creating a new variable</button>). The &lt;vars&gt; element must after the &lt;import&gt; element and before the first &lt;screen&gt; element.</p>
				<p>To use variables, you must set the <strong>usevars</strong> in &lt;HAScript&gt; to true.</p>
				<h3 id="wq503">Attributes</h3>
				<p>None.</p>
				<h3 id="wq504">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_vars"><span class="figcap">Figure 123. Examples for the &lt;vars&gt; element</span>
					<pre class="xmp"><code>&lt;HAScript ... usevars="true" .... &gt;    &lt;import&gt;       &lt;type class="java.util.Properties" name="Properties" /&gt;    &lt;/import&gt;     &lt;vars&gt;       &lt;create name="$prp$" type="Properties" value="$new Properties()$" /&gt;       &lt;create name="$strAccountName$" type="string" value="" /&gt;       &lt;create name="$intAmount$" type="integer" value="0" /&gt;       &lt;create name="$dblDistance$" type="double" value="0.0" /&gt;       &lt;create name="$boolSignedUp$" type="boolean" value="false" /&gt;       &lt;create name="$fldFunction$" type="field" /&gt;    &lt;/vars&gt;    ...&lt;/HAScript&gt;</code></pre>
				</div>
			</div>

			<button id="mr_varupdate" class="accordian">&lt;varupdate&gt; element</button>
			<div class="panel" style="display:none">
				<h3 id="wq505">General</h3>
				<p>The &lt;varupdate&gt; element causes the macro runtime to store specified value into a specified variable. The value can be an value, a variable, a call to a Java method, or an arithmetic that can contain any of these values. If the value is an expression, then during macro playback the macro runtime evaluates the and stores the resulting value into the specified variable (see <button onclick="scrollHere('ma_varupdate')">Variable update action (&lt;varupdate&gt; element)</button>).</p>
				<p>You can also use the &lt;varupdate&gt; action in a &lt;description&gt; element (see <button onclick="scrollHere('ma_varupdate')">Variable update action (&lt;varupdate&gt; element)</button>).</p>
				<p>For more information on variables see <button onclick="scrollHere('mv_variables')">Variables and imported Java classes</button>.</p>
				<h3 id="wq506">Attributes</h3>
				<dl>
					<dt class="bold">name</dt>
					<dd>Required. The name of the variable.</dd>
					<dt class="bold">value</dt>
					<dd>Required string. The value or expression to be assigned to variable.</dd>
				</dl>
				<h3 id="wq507">XML samples</h3>
				<p></p>
				<div class="figrules" id="mr_fig_varupdate"><span class="figcap">Figure 124. Examples for the &lt;varupdate&gt; element</span>
					<pre class="xmp"><code>&lt;type&gt;    &lt;type class="mypackage.MyClass" name="MyClass" /&gt;    &lt;type class="java.util.Hashtable" name="Hashtable" /&gt;    &lt;type class="java.lang.Object" name="Object" /&gt; &lt;/type&gt;  &lt;vars&gt;    ...&lt;/vars&gt;  &lt;screen&gt;    &lt;description&gt;    ...   &lt;/description&gt;    &lt;actions&gt;       &lt;varupdate name="$var_boolean1$"  value="false" /&gt;       &lt;varupdate name="$var_int1$"      value="5" /&gt;       &lt;varupdate name="$var_double1$"   value="5" /&gt;       &lt;varupdate name="$var_string1$"   value="'oak tree'" /&gt;       &lt;varupdate name="$var_field1$"    value="4,5" /&gt;        &lt;!-- null keyword --&gt;       &lt;varupdate name="$var_importedMC1$"  value="null" /&gt;       &lt;!--  Equivalent to null keyword for an imported type  --&gt;       &lt;varupdate name="$var_importedMC2$"  value="" /&gt;        &lt;varupdate name="$var_importedMC4$"                   value="$new MyClass( 'myparam1', 'myparam2' )$" /&gt;       &lt;varupdate name="$var_importedMC5$"                   value="$var_importedMC4$" /&gt;       &lt;varupdate name="$var_importedMC6$"                   value="$MyClass.createInstance( 'mystringparam1' )$" /&gt;       &lt;varupdate name="$var_boolean2$"                   value="$var_importedMC4.isEmpty()$" /&gt;       &lt;varupdate name="$var_int2$"                   value="$($var_importedMC4.getHashtable()$).size()$" /&gt;       &lt;varupdate name="$var_double2$"                   value="$var_importedMC4.getMeters()$" /&gt;       &lt;varupdate name="$var_string2$"                   value="$var_importedMC4.toString()" /&gt;    &lt;/actions&gt; &lt;/screen&gt;</code></pre>
				</div>
				<h1 id="ms1_sample">Sample macro code</h1>
				</div>
	
				<button id="ms1_spreadsheet" class="accordian">Copy CICS transaction records into Excel spreadsheet or database</button>
				<div class="panel" style="display:none">
				<h3 id="ms1_amnu_excel">Introduction</h3>
				<p>NOTE: This sample requires Microsoft Excel or IBM DB2.</p>
				<p>This sample macro reads transaction records from the CICS transaction <strong>amnu</strong>, which is a very small sample database, writes the records into an Excel spreadsheet or IBM DB2.</p>
				<p>The files for this sample are stored in the following directory, where &lt;install&gt; stands for the Host On-Demand installation directory, and where xx stands for your language id (such as en):</p>
				<pre class="xmp"><code>&lt;install&gt;\HOD\xx\doc\macro\samples\amnu</code></pre>
				<p>The files in this sample are the following:</p>
				<ul>
					<li>amnu.mac, amnudb2.<p>These are the macro files. The first is for use with the Excel spreadsheet. The second is for use DB2.</p></li>
					<li>amnu.xls <p>This is the Excel spreadsheet.</p></li>
					<li>EditDB.java, EditDB.<p>EditDB.java is a Java source file source code for the EditDB class. The macro uses the EditDB to write to the spreadsheet or database. EditDB.class is with Java 2 and stored in the EditDB.jar. EditDB.jar is a Java 2 file.</p></li>
				</ul>
				<h3 id="wq508">Steps for running Excel sample (Windows only)</h3>
				<ol type="1">
					<li>Configure Java security <p>You will need to grant permissions for the Host On-Demand applet in order to run this sample. You can alter the .java.policy file by using policytool or you create a new policy file and specify this file in the plug-in Runtime Parameters(<samp class="xph">-Djava.security.policy=PolicyFileName</samp>).</p>
						<p> new policy file should contain the following and should be in your local home directory. </p>
						<pre class="xmp"><code>grant {
				    		permission java.lang.        "accessClassInPackage.sun.jdbc.odbc";     permission java.util.PropertyPermission        "file.encoding", "read";   };  </code></pre>
						<p>   If you to change .java.policy (and not set the parameter above in your plug-in), launch the policytool executable in the bin directory of your plug-in install and set the permissions specified in the lines above.</p>
					</li>
					<li>Set up the Excel spreadsheet as an ODBC data 
						<ol type="a">
							<li>On your Windows machine, go to Settings-&gt;Control Panel-&gt;Tools-&gt;Data Sources(ODBC).</li>
							<li>Click Add...</li>
							<li> Select Microsoft Excel Driver (*.xls).</li>
							<li>Hit Finish.</li>
							<li>Give a data source name of amnu and give any description you (or leave it blank).</li>
							<li>Use the Select Workbook button to find the spreadsheet in this example.  Hit OK.</li>
							<li>Deselect the Read Only option for this source.  You may need hit an Options&gt;&gt; button to find this option.</li>
							<li>Hit OK.  You now have the amnu.xls spread sheet available as ODBC data source amnu.</li>
						</ol>.
					</li>
					<li> Create a new Deployment Wizard page that gives the Host On-client access to the EditDB class.
						<ol type="a">
							<li>Start Deployment Wizard.</li>
							<li>On the Additional Options page, click "Advanced Options..."</li>
							<li> On the Add HTML Parameters panel, add a parameter with Name "AdditionalArchives" and Value "amnu"</li>
						</ol>
					</li>
					<li>Place amnu.jar in your Host On-Demand publish directory</li>
					<li>Open your newly created page in a web browser and start your session.<p>USING AMNU:</p>
						<p>The transaction amnu is a small database that is provided with CICS. To start amnu, follow these steps:</p>
						<ol type="a">
							<li>Log onto CICS</li>
							<li>At the CICS prompt, type amnu and type enter.</li>
						</ol>
						<p class="indatacontent">The amnu menu comes up in the upper left quadrant of the window and displays operator instructions.</p>
						<p>To see if there any records in the database, follow these steps:</p>
						<ol type="a">
							<li>In the ENTER TRANSACTION: field, type <samp class="xph">abrw</samp></li>
							<li>Leave the NUMBER field blank.</li>
							<li>Type enter.</li>
						</ol>
						<p class="indatacontent">The amnu transaction displays the first 4 records. Follow instructions on the screen to browse the database.</p>
						<p>If the is empty, you need to add records to it before you run the macro.To add records to the database, follow these steps:</p>
						<ol type="a">
							<li>In the ENTER TRANSACTION: field, type <samp class="xph">aadd</samp></li>
							<li>In the NUMBER FIELD, enter a number for the record that you to add, such as <samp class="xph">40</samp>.</li>
							<li>Type enter.</li>
							<li>Follow the instructions on the screen to provide information the new record.</li>
						</ol>
					</li>
					<li>Load amnu.mac into your session.
						<ol type="a">
							<li>If it is not already visible, display the Macro Manager by selecting View-&gt;Macro Manager on the session toolbar.</li>
							<li>Click on the Edit current macro properties icon.</li>
							<li>Click on the Import... button on the Macro Editor.</li>
							<li>Browse to the location of amnu.mac and open it.</li>
							<li>Click Save and Exit to save the macro to your current and close the Macro Editor.</li>
						</ol>
					</li>
					<li>Navigate to the amnu menu screen and hit the Play macro icon. <p>will be prompted to enter a record number.  Enter a number of a that you have entered or that you saw when you browsed through database in step 5.  Hit OK.  The application screen will the contents of the record corresponding to the number that you entered. You will be prompted again to ask if you would like to save the on the screen to your database.  The default response is "Y."  OK.  You will again be prompted to Enter a transaction number.  could continue to enter as many record numbers as you like (and will be notified if you enter an invalid number), but this time Q to quit.  Hit OK to close the prompt, and OK again to dismiss message "Good Bye!"  The macro will end, and amnu.xls will open. You should see the contents of the record you just saved inside spreadsheet.</p>
						<p>Hopefully this sample will get you thinking the powerful ways in which you can put macros to use for your business. Note that this sample can easily be modified, for example to to a different kind of database (see below for directions on to DB2) or to read from the local database and write to the amnu database. Note that this sample was designed to be short and simple, not lesson in best practices of Java or macro coding.  For example, may have noticed that we are connecting to and disconnecting the local database every time we write a record out.  This could avoided by writing "connect" and "disconnect" macros that are to the amnu macro such that there is only one connect and one for each macro play.</p>
					</li>
				</ol>
				<p>If you look inside the Excel macro amnu.mac, you'll see that is using the driver sun.jdbc.odbc.JdbcOdbcDriver to connect to Excel spreadsheet.  If this class is not in your classpath, the will not run properly.  This class is included in the Sun Java 2 plug-but not in IBM plug-ins.</p>
				<h3 id="wq516">Steps for running DB2 sample</h3>
				<p>If you are using an IBM plug-in and do not have the sun.jdbc.package in your classpath, you can instead run this sample with DB2.</p>
				<ol type="1">
					<li>Create a DB2 database.  Call the database "AMNU" and create table "CUSTRECS" with columns "NAME", "ADDRESS", "PHONE", "DATE", "AMOUNT" and "COMMENT".</li>
					<li>Put appropriate DB2 drivers in your classpath.  Rather than sun.jdbc.odbc.JdbcOdbcDriver, we will now use COM.ibm.db2.jdbc.net.to connect to our local database.  This and other needed classes found in db2java.zip, which was likely placed in \SQLLIB\java you installed DB2. There are different ways of getting these files in your classpath, depending on your setup.</li>
					<li>Edit the macro for your DB2 database.
						<ol type="a">
							<li>In the line: <pre class="xmp"><code>&lt;create name="$database$" type="DB"      value="$new DB('jdbc:db2://hostname:6789/AMNU',     'COM.ibm.db2.jdbc.net.DB2Driver')$" /&gt;</code></pre> change hostname to the name of your machine running DB2.</li>
							<li>Find the following two perform actions: <pre class="xmp"><code>&lt;perform value="$database.setUserID('db2admin')$"  /&gt; &lt;perform value="$database.setPassword('db2admin')$"  /&gt;</code></pre>modify them with and ID and Password that will connect to your database.</li>
						</ol>
					</li>
					<li> Follow steps 3-7 above, this time importing AMNUDB2.mac.</li>
				</ol>
				<p>Note some differences in the two macros: </p>
				<ul>
					<li>The syntax of the table name in the SQL query is different. Excel: <pre class="xmp"><code>[CUSTRECS$]</code></pre>For DB2: <pre class="xmp"><code>CUSTRECS</code></pre></li>
					<li>As mentioned before, we are using a different driver to to the database.</li>
					<li>This time we needed to use EditDB's setUserID and methods to specify the appropriate ID and Password to connect to database.</li>
					<li>This macro does not launch the local database when you are making your additions.  You can verify that the records were added by performing a "Select * from CUSTRECS" query on the database.</li>
				</ul>
			</div>
		</div>


		<h1 id="wq519">Appendixes</h1>


		<h1 id="mo_eval_descriptors">Appendix A. Additional information</h1>
		<h2 id="mo_default_combining_rule">The default combining rule for multiple descriptors in one macro screen</h2>
		<h3 id="wq520">Statement of the rule</h3>
		<p>Here is the rule:</p>
		<ol type="1">
			<li>Evaluate all the required descriptors (that is, descriptors for the Optional field is set to false).
				<ol type="a">
					<li>If all are true, then the screen matches.</li>
					<li>Otherwise, go to step 2.</li>
				</ol>
			</li>
			<li>Start evaluating the optional descriptors (descriptors for which the field is set to true).
				<ol type="a">
					<li>If any optional descriptor is true, then the screen matches.</li>
					<li>Otherwise, keep evaluating optional descriptors.</li>
				</ol>
			</li>
			<li>If you reach here, then the macro screen does not match the screen.</li>
		</ol>
		<h2 id="mo_mnemonic_keywords">Mnemonic keywords for the Input action</h2>
		<p>This section contains the mnemonic keywords for the Input action and type of session or essions in which the mnemonic is supported. Session for a given mnemonic is denoted by an X, along with any special notes apply to the function.</p>
		<p></p>
		<table id="wq524" width="100%" summary="" border="1" frame="border" rules="all">
			<caption>Table 35. Keywords for the Input action</caption>
			<thead valign="bottom">
				<tr>
					<th id="wq525" align="left" valign="top">Function:</th>
					<th id="wq526" align="left" valign="top">Keyword:</th>
					<th id="wq527" align="left" valign="top">3270:</th>
					<th id="wq528" align="left" valign="top">5250:</th>
					<th id="wq529" align="left" valign="top">VT:</th>
					<th id="wq530" align="left" valign="top">CICS:</th>
				</tr>
			</thead>
			<tbody valign="top">
				<tr>
					<td headers="wq525">Attention</td>
					<td headers="wq526">[attn]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529"></td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">Alternate view</td>
					<td headers="wq526">[altview]</td>
					<td headers="wq527">x<sup>3</sup></td>
					<td headers="wq528">x<sup>3</sup></td>
					<td headers="wq529"></td>
					<td headers="wq530">x<sup>3</sup></td>
				</tr>
				<tr>
					<td headers="wq525">Backspace</td>
					<td headers="wq526">[backspace]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x<sup>1</sup></td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">Backtab</td>
					<td headers="wq526">[backtab]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529"></td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">Beginning of Field</td>
					<td headers="wq526">[bof]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529"></td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">Clear</td>
					<td headers="wq526">[clear]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x<sup>1</sup></td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">Cursor Down</td>
					<td headers="wq526">[down]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x<sup>1</sup></td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">Cursor Left</td>
					<td headers="wq526">[left]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x<sup>1</sup></td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">Cursor Right</td>
					<td headers="wq526">[right]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x<sup>1</sup></td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">Cursor Select</td>
					<td headers="wq526">[cursel]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x<sup>1</sup></td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">Cursor Up</td>
					<td headers="wq526">[up]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x<sup>1</sup></td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">Delete Character</td>
					<td headers="wq526">[delete]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x<sup>1, 2</sup></td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">Display SO/SI</td>
					<td headers="wq526">[dspsosi]</td>
					<td headers="wq527">x<sup>3</sup></td>
					<td headers="wq528">x<sup>3</sup></td>
					<td headers="wq529"></td>
					<td headers="wq530">x<sup>3</sup></td>
				</tr>
				<tr>
					<td headers="wq525">Dup Field</td>
					<td headers="wq526">[dup]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529"></td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">Enter</td>
					<td headers="wq526">[enter]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x</td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">End of Field</td>
					<td headers="wq526">[eof]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x<sup>1, 2</sup></td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">Erase EOF</td>
					<td headers="wq526">[eraseeof]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529"></td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">Erase Field</td>
					<td headers="wq526">[erasefld]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529"></td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">Erase Input</td>
					<td headers="wq526">[erinp]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529"></td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">Field Exit</td>
					<td headers="wq526">[fldext]</td>
					<td headers="wq527"></td>
					<td headers="wq528">x</td>
					<td headers="wq529"></td>
					<td headers="wq530"></td>
				</tr>
				<tr>
					<td headers="wq525">Field Mark</td>
					<td headers="wq526">[fieldmark]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529"></td>
					<td headers="wq530"></td>
				</tr>
				<tr>
					<td headers="wq525">Field Minus</td>
					<td headers="wq526">[field-]</td>
					<td headers="wq527"></td>
					<td headers="wq528">x</td>
					<td headers="wq529"></td>
					<td headers="wq530"></td>
				</tr>
				<tr>
					<td headers="wq525">Field Plus</td>
					<td headers="wq526">[field+]</td>
					<td headers="wq527"></td>
					<td headers="wq528">x</td>
					<td headers="wq529"></td>
					<td headers="wq530"></td>
				</tr>
				<tr>
					<td headers="wq525">F1</td>
					<td headers="wq526">[pf1]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x</td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">F2</td>
					<td headers="wq526">[pf2]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x</td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">F3</td>
					<td headers="wq526">[pf3]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x</td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">F4</td>
					<td headers="wq526">[pf4]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x</td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">F5</td>
					<td headers="wq526">[pf5]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x</td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">F6</td>
					<td headers="wq526">[pf6]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x</td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">F7</td>
					<td headers="wq526">[pf7]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x</td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">F8</td>
					<td headers="wq526">[pf8]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x</td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">F9</td>
					<td headers="wq526">[pf9]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x</td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">F10</td>
					<td headers="wq526">[pf10]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x</td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">F11</td>
					<td headers="wq526">[pf11]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x</td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">F12</td>
					<td headers="wq526">[pf12]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x</td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">F13</td>
					<td headers="wq526">[pf13]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x</td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">F14</td>
					<td headers="wq526">[pf14]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x</td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">F15</td>
					<td headers="wq526">[pf15]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x</td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">F16</td>
					<td headers="wq526">[pf16]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x</td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">F17</td>
					<td headers="wq526">[pf17]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x</td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">F18</td>
					<td headers="wq526">[pf18]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x</td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">F19</td>
					<td headers="wq526">[pf19]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x</td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">F20</td>
					<td headers="wq526">[pf20]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x</td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">F21</td>
					<td headers="wq526">[pf21]</td>
					<td headers="wq527">x</td>
					<td headers="wq528"></td>
					<td headers="wq529">x</td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">F22</td>
					<td headers="wq526">[pf22]</td>
					<td headers="wq527">x</td>
					<td headers="wq528"></td>
					<td headers="wq529">x</td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">F23</td>
					<td headers="wq526">[pf23]</td>
					<td headers="wq527">x</td>
					<td headers="wq528"></td>
					<td headers="wq529">x</td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">F24</td>
					<td headers="wq526">[pf24]</td>
					<td headers="wq527">x</td>
					<td headers="wq528"></td>
					<td headers="wq529">x</td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">Help</td>
					<td headers="wq526">[help]</td>
					<td headers="wq527"></td>
					<td headers="wq528">x</td>
					<td headers="wq529"></td>
					<td headers="wq530"></td>
				</tr>
				<tr>
					<td headers="wq525">Home</td>
					<td headers="wq526">[home]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x<sup>1, 2</sup></td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">Insert</td>
					<td headers="wq526">[insert]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x<sup>1, 2</sup></td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">Keypad 0</td>
					<td headers="wq526">[keypad0]</td>
					<td headers="wq527"></td>
					<td headers="wq528"></td>
					<td headers="wq529">x</td>
					<td headers="wq530"></td>
				</tr>
				<tr>
					<td headers="wq525">Keypad 1</td>
					<td headers="wq526">[keypad1]</td>
					<td headers="wq527"></td>
					<td headers="wq528"></td>
					<td headers="wq529">x</td>
					<td headers="wq530"></td>
				</tr>
				<tr>
					<td headers="wq525">Keypad 2</td>
					<td headers="wq526">[keypad2]</td>
					<td headers="wq527"></td>
					<td headers="wq528"></td>
					<td headers="wq529">x</td>
					<td headers="wq530"></td>
				</tr>
				<tr>
					<td headers="wq525">Keypad 3</td>
					<td headers="wq526">[keypad3]</td>
					<td headers="wq527"></td>
					<td headers="wq528"></td>
					<td headers="wq529">x</td>
					<td headers="wq530"></td>
				</tr>
				<tr>
					<td headers="wq525">Keypad 4</td>
					<td headers="wq526">[keypad4]</td>
					<td headers="wq527"></td>
					<td headers="wq528"></td>
					<td headers="wq529">x</td>
					<td headers="wq530"></td>
				</tr>
				<tr>
					<td headers="wq525">Keypad 5</td>
					<td headers="wq526">[keypad5]</td>
					<td headers="wq527"></td>
					<td headers="wq528"></td>
					<td headers="wq529">x</td>
					<td headers="wq530"></td>
				</tr>
				<tr>
					<td headers="wq525">Keypad 6</td>
					<td headers="wq526">[keypad6]</td>
					<td headers="wq527"></td>
					<td headers="wq528"></td>
					<td headers="wq529">x</td>
					<td headers="wq530"></td>
				</tr>
				<tr>
					<td headers="wq525">Keypad 7</td>
					<td headers="wq526">[keypad7]</td>
					<td headers="wq527"></td>
					<td headers="wq528"></td>
					<td headers="wq529">x</td>
					<td headers="wq530"></td>
				</tr>
				<tr>
					<td headers="wq525">Keypad 8</td>
					<td headers="wq526">[keypad8]</td>
					<td headers="wq527"></td>
					<td headers="wq528"></td>
					<td headers="wq529">x</td>
					<td headers="wq530"></td>
				</tr>
				<tr>
					<td headers="wq525">Keypad 9</td>
					<td headers="wq526">[keypad9]</td>
					<td headers="wq527"></td>
					<td headers="wq528"></td>
					<td headers="wq529">x</td>
					<td headers="wq530"></td>
				</tr>
				<tr>
					<td headers="wq525">Keypad Dot</td>
					<td headers="wq526">[keypad.]</td>
					<td headers="wq527"></td>
					<td headers="wq528"></td>
					<td headers="wq529">x</td>
					<td headers="wq530"></td>
				</tr>
				<tr>
					<td headers="wq525">Keypad Enter</td>
					<td headers="wq526">[keypadenter]</td>
					<td headers="wq527"></td>
					<td headers="wq528"></td>
					<td headers="wq529">x</td>
					<td headers="wq530"></td>
				</tr>
				<tr>
					<td headers="wq525">Keypad Comma</td>
					<td headers="wq526">[keypad,]</td>
					<td headers="wq527"></td>
					<td headers="wq528"></td>
					<td headers="wq529">x</td>
					<td headers="wq530"></td>
				</tr>
				<tr>
					<td headers="wq525">Keypad Minus</td>
					<td headers="wq526">[keypad-]</td>
					<td headers="wq527"></td>
					<td headers="wq528"></td>
					<td headers="wq529">x</td>
					<td headers="wq530"></td>
				</tr>
				<tr>
					<td headers="wq525">New Line</td>
					<td headers="wq526">[newline]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529"></td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">PA1</td>
					<td headers="wq526">[pa1]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529"></td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">PA2</td>
					<td headers="wq526">[pa2]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529"></td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">PA3</td>
					<td headers="wq526">[pa3]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529"></td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">Page Up</td>
					<td headers="wq526">[pageup]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x<sup>1, 2</sup></td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">Page Down</td>
					<td headers="wq526">[pagedn]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x<sup>1, 2</sup></td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">Reset</td>
					<td headers="wq526">[reset]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x</td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">System Request</td>
					<td headers="wq526">[sysreq]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529"></td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">Tab Field</td>
					<td headers="wq526">[tab]</td>
					<td headers="wq527">x</td>
					<td headers="wq528">x</td>
					<td headers="wq529">x<sup>1</sup></td>
					<td headers="wq530">x</td>
				</tr>
				<tr>
					<td headers="wq525">Test Request</td>
					<td headers="wq526">[test]</td>
					<td headers="wq527"></td>
					<td headers="wq528">x</td>
					<td headers="wq529"></td>
					<td headers="wq530"></td>
				</tr>
			</tbody>
		</table>
		<ol type="1">
			<li>VT supports this function but it is up to the host application to on it.</li>
			<li>Supported in VT200 mode only.</li>
			<li>The function is only available in a DBCS session.</li>
		</ol>
		<p>The following table shows the bidirectional keywords for the Input action.</p>
		<table id="wq532" width="100%" summary="" border="1" frame="border" rules="all">
			<caption>Table 36. Bidirectional keywords for the Input action</caption>
			<thead valign="bottom">
				<tr>
					<th id="wq533" align="left" valign="top">Function:</th>
					<th id="wq534" align="left" valign="top">Keyword:</th>
					<th id="wq535" align="left" valign="top">3270:</th>
					<th id="wq536" align="left" valign="top">5250:</th>
					<th id="wq537" align="left" valign="top">VT:</th>
					<th id="wq538" align="left" valign="top">CICS:</th>
				</tr>
			</thead>
			<tbody valign="top">
				<tr>
					<td headers="wq533">Auto Push</td>
					<td headers="wq534">[autopush]</td>
					<td headers="wq535">x</td>
					<td headers="wq536"></td>
					<td headers="wq537"></td>
					<td headers="wq538">x</td>
				</tr>
				<tr>
					<td headers="wq533">Auto Reverse</td>
					<td headers="wq534">[autorev]</td>
					<td headers="wq535">x</td>
					<td headers="wq536"></td>
					<td headers="wq537">x</td>
					<td headers="wq538"></td>
				</tr>
				<tr>
					<td headers="wq533">Base</td>
					<td headers="wq534">[base]</td>
					<td headers="wq535">x</td>
					<td headers="wq536">x</td>
					<td headers="wq537"></td>
					<td headers="wq538"></td>
				</tr>
				<tr>
					<td headers="wq533">BIDI Layer</td>
					<td headers="wq534">[bidilayer]</td>
					<td headers="wq535"></td>
					<td headers="wq536"></td>
					<td headers="wq537"></td>
					<td headers="wq538"></td>
				</tr>
				<tr>
					<td headers="wq533">Close</td>
					<td headers="wq534">[close]</td>
					<td headers="wq535"></td>
					<td headers="wq536">x</td>
					<td headers="wq537"></td>
					<td headers="wq538"></td>
				</tr>
				<tr>
					<td headers="wq533">CSD</td>
					<td headers="wq534">[csd]</td>
					<td headers="wq535">x</td>
					<td headers="wq536"></td>
					<td headers="wq537"></td>
					<td headers="wq538">x</td>
				</tr>
				<tr>
					<td headers="wq533">End Push</td>
					<td headers="wq534">[endpush]</td>
					<td headers="wq535">x</td>
					<td headers="wq536"></td>
					<td headers="wq537"></td>
					<td headers="wq538">x</td>
				</tr>
				<tr>
					<td headers="wq533">Field Reverse</td>
					<td headers="wq534">[fldrev]</td>
					<td headers="wq535">x</td>
					<td headers="wq536">x</td>
					<td headers="wq537"></td>
					<td headers="wq538">x</td>
				</tr>
				<tr>
					<td headers="wq533">Field Shape</td>
					<td headers="wq534">[fieldshape]</td>
					<td headers="wq535">x</td>
					<td headers="wq536"></td>
					<td headers="wq537"></td>
					<td headers="wq538">x</td>
				</tr>
				<tr>
					<td headers="wq533">Final</td>
					<td headers="wq534">[final]</td>
					<td headers="wq535">x</td>
					<td headers="wq536"></td>
					<td headers="wq537"></td>
					<td headers="wq538">x</td>
				</tr>
				<tr>
					<td headers="wq533">Initial</td>
					<td headers="wq534">[initial]</td>
					<td headers="wq535">x</td>
					<td headers="wq536"></td>
					<td headers="wq537"></td>
					<td headers="wq538">x</td>
				</tr>
				<tr>
					<td headers="wq533">Isolated</td>
					<td headers="wq534">[isolated]</td>
					<td headers="wq535">x</td>
					<td headers="wq536"></td>
					<td headers="wq537"></td>
					<td headers="wq538">x</td>
				</tr>
				<tr>
					<td headers="wq533">Latin Layer</td>
					<td headers="wq534">[latinlayer]</td>
					<td headers="wq535">x</td>
					<td headers="wq536">x</td>
					<td headers="wq537"></td>
					<td headers="wq538"></td>
				</tr>
				<tr>
					<td headers="wq533">Middle</td>
					<td headers="wq534">[middle]</td>
					<td headers="wq535">x</td>
					<td headers="wq536"></td>
					<td headers="wq537"></td>
					<td headers="wq538">x</td>
				</tr>
				<tr>
					<td headers="wq533">Push</td>
					<td headers="wq534">[push]</td>
					<td headers="wq535">x</td>
					<td headers="wq536"></td>
					<td headers="wq537"></td>
					<td headers="wq538">x</td>
				</tr>
				<tr>
					<td headers="wq533">Screen Reverse</td>
					<td headers="wq534">[screenrev]</td>
					<td headers="wq535">x</td>
					<td headers="wq536">x</td>
					<td headers="wq537"></td>
					<td headers="wq538">x</td>
				</tr>
			</tbody>
		</table>
		<h1 id="hdrnotice">Appendix B. Notices</h1>
		<p>This information was developed for products and services offered in U.S.A.</p>
		<p>IBM may not offer the products, services, or features discussed in document in other countries. Consult your local IBM representative for on the products and services currently available in your area. Any to an IBM product, program, or service is not intended to state or imply only that IBM product, program, or service may be used. Any functionally product, program, or service that does not infringe any IBM intellectual right may be used instead. However, it is the user's responsibility to and verify the operation of any non-IBM product, program, or service.</p>
		<p>IBM may have patents or pending patent applications covering subject described in this document. The furnishing of this document does not you any license to these patents. You can send license inquiries, in writing, to:</p>
		<pre class="xmp"><code>Site IBM 2455 South Poughkeepsie, NY 12601-U.S.A. </code></pre>
		<p>For license inquiries regarding double-byte (DBCS) information, the IBM Intellectual Property Department in your country or region or inquiries, in writing, to:</p>
		<pre class="xmp"><code>IBM World Trade Asia 2-31 Roppongi 3-chome, Minato-Tokyo 106, Japan</code></pre>
		<p><strong>The following paragraph does not apply to the United or any other country or region where such provisions are inconsistent local law:</strong> INTERNATIONAL BUSINESS MACHINES CORPORATION PROVIDES PUBLICATION "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT, MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. Some states do not disclaimer of express or implied warranties in certain transactions, therefore, this statement may not apply to you.</p>
		<p>This information could include technical inaccuracies or errors. Changes are periodically made to the information herein; these will be incorporated in new editions of the publication. IBM may make and/or changes in the product(s) and/or the program(s) described in this at any time without notice.</p>
		<p>Any references in this information to non-IBM Web sites are provided convenience only and do not in any manner serve as an endorsement of Web sites. The materials at those Web sites are not part of the for this IBM product and use of those Web sites is at your own risk.</p>
		<p>IBM may use or distribute any of the information you supply in any it believes appropriate without incurring any obligation to you.</p>
		<p>Licensees of this program who wish to have information about it for purpose of enabling: (i) the exchange of information between created programs and other programs (including this one) and (ii) the use of the information which has been exchanged, should contact:</p>
		<pre class="xmp"><code>IBM Department Building P.O. Box Research Triangle Park, NC 27709-U.S.A. </code></pre>
		<p>Such information may be available, subject to appropriate terms and conditions, including in some cases, payment of a fee.</p>
		<p>The licensed program described in this document and all licensed available for it are provided by IBM under terms of the IBM Customer Agreement, IBM International Program License Agreement or any equivalent agreement us.</p>
		<p>Such information may be available, subject to appropriate terms and conditions, including in some cases, payment of a fee. The licensed program in this document and all licensed material available for it are provided IBM under terms of the IBM Customer Agreement, IBM International Program Agreement or any equivalent agreement between us.</p>
		<p>Information concerning non-IBM products was obtained from the of those products, their published announcements or other publicly sources. IBM has not tested those products and cannot confirm the of performance, compatibility or any other claims related to non-IBM products.Questions on the capabilities of non-IBM products should be addressed to suppliers of those products.</p>
		<p>If you are viewing this information softcopy, the photographs and illustrations may not appear.</p>
		<button id="tmk"></button>
		<h1 id="wq539">Appendix C. Trademarks</h1>
		<p>The following terms are trademarks of International Business Corporation in the United States, other countries, or both: <strong>IBM</strong></p>
		<p>Java and all Java-based trademarks and logos are or registered trademarks of Oracle Corporation in the United and other countries.</p>
		<p>Microsoft, Windows, and the Windows logo are trademarks of Microsoft Corporation.</p>
		<p>Other company, product, and service names may be trademarks service marks of others.</p>
		<button id="Bot_Of_Page"></button>

		<script>
			var acc = document.getElementsByClassName("accordian");
			var i;

			for (i = 0; i < acc.length; i++) {
			  acc[i].addEventListener("click", function() {
			    this.classList.toggle("active");
			    var panel = this.nextElementSibling;
			    if (panel.style.display === "block") {
			      panel.style.display = "none";
			    } else {
			      panel.style.display = "block";
			    }
			  });
			}

			function scrollHere(x){
				let el = document.getElementById(x);

				if(el.tagName === "BUTTON" && el.parentNode.className !== "panel"){
					el.nextElementSibling.style.display = "block";
					el.scrollIntoView();
				} else if(el.tagName === "BUTTON" && el.parentNode.className === "panel"){
					el.parentNode.previousElementSibling.classList.add("active");
					el.parentNode.style.display = "block";
					el.scrollIntoView();
				} else if(el.tagName !== "BUTTON" && el.parentNode.className === "panel"){
					el.parentNode.previousElementSibling.parentNode.previousElementSibling.classList.add("active");
					el.parentNode.previousElementSibling.parentNode.style.display = "block";
					el.parentNode.previousElementSibling.classList.add("active");
					el.parentNode.style.display = "block";
					el.scrollIntoView();
				}else {
					el.scrollIntoView();
				}
			}
		</script>
	</body>
</html>